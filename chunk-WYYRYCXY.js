import{c as N}from"./chunk-XFESK2YB.js";import{k as s,l as m,m as i,n as S}from"./chunk-VOFKUGRY.js";import{a as I,b as d}from"./chunk-VTHXE323.js";function b(e,t){return d(I({},t),{filterMode:e.mode})}function g(e,t){return T(e,t).next().value??null}function O(e,t,n){let r=x(e);if(r&&(m(t,r[0])||i(n,r[1])))return"";let l=Array.from(T(e,t,n)),a=p(l,t,n)?"1=1":l.map(o=>o.where||"1=1").reduce((o,c)=>N(o,c),"");return a&&a!=="1=1"?a:""}function x(e){if(h(e)==="manual")return null;let t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(let{minScale:n,maxScale:r}of e.filters)t[0]=Math.max(t[0],u(n)),t[1]=Math.min(t[1],f(r));return t}function*T(e,t,n){if(h(e)==="manual"){let r=e.filters.find(l=>l.id===e.activeFilterId);r&&(yield r)}else{typeof t=="object"&&(t=t.scale);for(let r of e.filters)E(r.minScale,r.maxScale,t,n)&&(yield r)}}function p(e,t,n){if(e.length===0)return!0;let r=u(e.at(0)?.minScale),l=f(e.at(-1)?.maxScale);if(i(r,t)||m(l,n))return!0;for(let a=0;a<e.length-1;a++){let o=e[a],c=e[a+1];if(i(u(c.minScale),f(o.maxScale)))return!0}return!1}function E(e,t,n,r){return e=u(e),n=u(n),t=f(t),!(!s(n,e)&&(r??n)>e)&&!S(t,n)&&(r===void 0||!s(r,e))}function h(e){return"mode"in e?e.mode:e.filterMode}function u(e){return e||Number.POSITIVE_INFINITY}function f(e){return e||0}export{b as a,g as b,O as c};
