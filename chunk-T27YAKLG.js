import{c as p}from"./chunk-WMHJC7XF.js";import{a as c}from"./chunk-D2LVMNOU.js";import{a as m}from"./chunk-SNFOAZZQ.js";import{a as n}from"./chunk-47GHT6OF.js";var _={upload:{createFromFiles:.8,loadMesh:.2},uploadAssetBlobs:{prepareAssetItems:.9,uploadAssetItems:.1},uploadConvertibleSource:{uploadEditSource:.5,serviceAssetsToGlb:.5},uploadLocalMesh:{meshToAssetBlob:.5,uploadAssetBlobs:.5}};function I(o,s=t=>{},e){return new l(o,s,e)}var l=class{constructor(s,e=r=>{},t){if(this.onProgress=e,this.taskName=t,this._progressMap=new Map,this._startTime=void 0,this._timingsMap=new Map,typeof s=="number"){this._weights={};for(let r=0;r<s;r++){let a=r,i=1/s;this._weights[a]=i,this._progressMap.set(a,0)}}else this._weights=s;this.emitProgress()}emitProgress(){let s=0;for(let[e,t]of this._progressMap.entries())s+=t*this._weights[e];if(s===1&&n("enable-feature:esri-3dofl-upload-timings")){let e=Math.round(performance.now()-(this._startTime??0))/1e3;console.log(`${this.taskName} done in ${e} sec`);for(let[t,r]of this._timingsMap){let a=Math.round(r.end-r.start)/1e3,i=Math.round(a/e*100);console.log(this.taskName??"Task",{stepKey:t,stepTime:a,relativeTime:i})}}this.onProgress(s)}setProgress(s,e){if(this._progressMap.set(s,e),n("enable-feature:esri-3dofl-upload-timings")){let t=performance.now();this._startTime??=t;let r=p(this._timingsMap,s,()=>({start:t,end:0}));e===1&&(r.end=t)}this.emitProgress()}simulate(s,e){return g(t=>this.setProgress(s,t),e)}makeOnProgress(s){return e=>this.setProgress(s,e)}};function g(o=e=>{},s=M){let e=performance.now();o(0);let t=setInterval(()=>{let r=performance.now()-e,a=1-Math.exp(-r/s);o(a)},f);return c(()=>{clearInterval(t),o(1)})}function S(o,s=u){return m(o*h/s)}function x(o,s=d){return m(o*h/s)}var u=10,d=10,h=8e-6,f=50,M=1e3;export{_ as a,I as b,g as c,S as d,x as e};
