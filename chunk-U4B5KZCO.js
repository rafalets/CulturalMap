import{a as O}from"./chunk-VQILGBRB.js";import"./chunk-2B7RSXWI.js";import{y as g}from"./chunk-WQQ6B254.js";import"./chunk-RVXFHI3X.js";import"./chunk-JXEAVWUK.js";import"./chunk-Y6FO2W3O.js";import"./chunk-T3DGHEVR.js";import"./chunk-ZOOQQO74.js";import"./chunk-R2FEHFRM.js";import"./chunk-GK3RYCKG.js";import"./chunk-4E4FE2IX.js";import"./chunk-5SSISWTF.js";import{a as G}from"./chunk-CKG2WYMF.js";import"./chunk-BA3KT2MW.js";import"./chunk-SP2CO3KX.js";import{i as L}from"./chunk-EY7OVTAY.js";import{a as d}from"./chunk-YO56ZRXD.js";import"./chunk-4D3QHJI2.js";import"./chunk-E2J2V7JN.js";import"./chunk-X7BNFUFQ.js";import"./chunk-IPGHBSHO.js";import"./chunk-XPXAET6Q.js";import"./chunk-37H4LYIE.js";import"./chunk-ALCGI4NA.js";import"./chunk-QXXXCEV5.js";import"./chunk-JH4RD366.js";import{C as I}from"./chunk-7Y6S2GNA.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-PTZYZULI.js";import"./chunk-KZKWOEFD.js";import"./chunk-LNVVFNTC.js";import"./chunk-RCDSCJMH.js";import"./chunk-QJADLTFR.js";import"./chunk-X7QUUHRV.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-K27GONOJ.js";import"./chunk-6KRFVLII.js";import"./chunk-JR22Z7I2.js";import"./chunk-3QNSJ5HY.js";import"./chunk-UNVICPIE.js";import"./chunk-BGICKEJR.js";import"./chunk-TRZXSDYA.js";import"./chunk-OGS2SUK5.js";import"./chunk-TVHRLNTK.js";import"./chunk-JA3EMS2I.js";import"./chunk-HKHTIKVW.js";import"./chunk-XFESK2YB.js";import"./chunk-IJBTA53P.js";import"./chunk-ZHUXSQTN.js";import"./chunk-YLZWDFCJ.js";import"./chunk-TLMADEUL.js";import"./chunk-WNSGKHQ6.js";import"./chunk-J5MXC6AL.js";import{a as y,b as s}from"./chunk-OLOKUDVI.js";import"./chunk-RJWOVI3M.js";import"./chunk-AZS4Q4RE.js";import"./chunk-QEBUS3TL.js";import"./chunk-NHSDW26F.js";import"./chunk-CNQVGGE6.js";import"./chunk-JGD7UKVF.js";import"./chunk-J372WZPB.js";import"./chunk-6XFS4U2F.js";import"./chunk-XPRVY6JT.js";import"./chunk-7N3ZKWML.js";import"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import"./chunk-3SDSCSDJ.js";import"./chunk-I4M2OT5W.js";import"./chunk-NTVLK3P2.js";import"./chunk-WMQNRNIU.js";import"./chunk-HD52PWPC.js";import"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-UAKHZRKN.js";import"./chunk-HAHX77IL.js";import"./chunk-LB5YQINJ.js";import"./chunk-EKMHQEJY.js";import"./chunk-VACZNAP3.js";import"./chunk-JKNCWG7E.js";import"./chunk-KTE5HCNJ.js";import"./chunk-F7VRLFCB.js";import"./chunk-7IPIJKWU.js";import"./chunk-7R33MKVL.js";import"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import"./chunk-U4J5SECU.js";import"./chunk-7EG726PT.js";import"./chunk-C7INQGWT.js";import"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import"./chunk-QGVBCWUY.js";import"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{f as p}from"./chunk-VTHXE323.js";var b=new O(null),w=s(d.size),F=s(d.maxSize),x=s(d.lineWidth),E=1;function H(n,e,m){return p(this,null,function*(){let t=e?.size,i=t!=null&&typeof t=="object"&&"width"in t?t.width:t,a=t!=null&&typeof t=="object"&&"height"in t?t.height:t;if(i==null||a==null)if(m==="esriGeometryPolygon")i=a=e.maxSize?Math.min(e.maxSize,w):w;else{let r=yield U(n,e,m);r&&(i=r.width,a=r.height),m==="esriGeometryPolyline"&&(i=e.maxSize?Math.min(e.maxSize,x):x),i=i!=null&&isFinite(i)?Math.min(i,F):w,a=a!=null&&isFinite(a)?Math.max(Math.min(a,F),E):w}return e.style==="legend"&&m==="esriGeometryPolyline"&&(i=x),{width:i,height:a}})}function U(n,e,m){return p(this,null,function*(){let{feature:t,fieldMap:i,viewParams:a}=e.cimOptions||e,r=yield G.resolveSymbolOverrides(n.data,t,null,i,m,null,a);if(!r)return null;(n=n.clone()).data={type:"CIMSymbolReference",symbol:r},n.data.primitiveOverrides=void 0;let l=[];return g.fetchResources(r,b.resourceManager,l),g.fetchFonts(r,b.resourceManager,l),l.length>0&&(yield Promise.all(l)),g.getEnvelope(r,null,b.resourceManager)})}function K(m){return p(this,arguments,function*(n,e={}){let{node:t,opacity:i,symbolConfig:a}=e,r=a!=null&&typeof a=="object"&&"isSquareFill"in a&&a.isSquareFill,l=e.cimOptions||e,c=l.geometryType||I(n?.data?.symbol),o=yield H(n,e,c),{feature:j,fieldMap:R}=l,D=e?.geometry||r||c!=="esriGeometryPolygon"?"preview":"legend",z=o,C=o;if(e?.geometry&&(c==="esriGeometryPolygon"||c==="esriGeometryPolyline")&&(y(o.width)<200||y(o.height)<200)){let q=o.width>o.height?s(200)*o.height/o.width:s(200);z={width:o.width>o.height?s(200):s(200)*o.width/o.height,height:q}}let S=yield b.rasterizeCIMSymbolAsync(n,j,z,D,R,c,null,l.viewParams,l.allowScalingUp,e?.geometry?.toJSON());if(!S)return null;let{width:T,height:V}=S,f=document.createElement("canvas");f.width=T,f.height=V,f.getContext("2d").putImageData(S,0,0);let M=y(C.width),v=y(C.height),h=new Image(M,v);h.src=f.toDataURL(),h.ariaLabel=e.ariaLabel??null,h.alt=e.ariaLabel??"",i!=null&&(h.style.opacity=`${i}`);let u=h;if(e.effectView!=null){let P={shape:{type:"image",x:0,y:0,width:M,height:v,src:h.src},fill:null,stroke:null,offset:[0,0]};u=L([[P]],[M,v],{effectView:e.effectView,ariaLabel:e.ariaLabel})}return t&&u&&t.appendChild(u),u})}export{K as previewCIMSymbol};
