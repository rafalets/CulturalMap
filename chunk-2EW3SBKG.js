import{a as I,c as b}from"./chunk-FCB5DYUJ.js";var C="<Null>",k="equal-interval",M=1,B=5,w=10,q=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,E=new Set(["esriFieldTypeDate","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeOID","esriFieldTypeBigInteger"]),P=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),$=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function T(n){return n==null||typeof n=="string"&&!n?C:n}function O(n){let t=n.normalizationField!=null||n.normalizationType!=null,l=n.minValue!=null||n.maxValue!=null,e=!!n.sqlExpression&&n.supportsSQLExpression;return!t&&!l&&!e}function ln(n){let{outStatisticTypes:t}=n,l=n.returnDistinct?[...new Set(n.values)]:n.values,e=l.filter(o=>o!=null).sort(),i=e.length,a={count:i,min:e[0],max:e[i-1]};return n.supportsNullCount&&(a.nullcount=l.length-i),!n.percentileParams||t?.include?.length&&!t.include.includes("median")||t?.exclude?.length&&t.exclude.includes("median")||(a.median=S(l,n.percentileParams)),a}function U(n){let{values:t,useSampleStdDev:l,supportsNullCount:e,outStatisticTypes:i}=n,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=null,r=null,f=null,s=null,c=0,m=n.minValue==null?-1/0:n.minValue,v=n.maxValue==null?1/0:n.maxValue;for(let d of t)Number.isFinite(d)?d>=m&&d<=v&&(u=u===null?d:u+d,a=Math.min(a,d),o=Math.max(o,d),c++):typeof d=="string"&&c++;if(c&&u!=null){r=u/c;let d=0;for(let p of t)Number.isFinite(p)&&p>=m&&p<=v&&(d+=(p-r)**2);s=l?c>1?d/(c-1):0:c>0?d/c:0,f=Math.sqrt(s)}else a=null,o=null;let g={avg:r,count:c,max:o,min:a,stddev:f,sum:u,variance:s};return e&&(g.nullcount=t.length-c),!n.percentileParams||i?.include?.length&&!i.include.includes("median")||i?.exclude?.length&&i.exclude.includes("median")||(g.median=S(t,n.percentileParams)),g}function S(n,t){let{fieldType:l,value:e,orderBy:i,isDiscrete:a}=t,o=G(l,i==="desc");if((n=[...n].filter(v=>v!=null).sort((v,g)=>o(v,g))).length===0)return null;if(e<=0)return n[0];if(e>=1)return n[n.length-1];let u=(n.length-1)*e,r=Math.floor(u),f=r+1,s=u%1,c=n[r],m=n[f];return f>=n.length||a||typeof c=="string"||typeof m=="string"?c:c*(1-s)+m*s}function G(n,t){if(n){if(E.has(n))return z(t);if(P.has(n))return y(t,!1);if(n==="esriFieldTypeTimestampOffset")return A(t);let o=y(t,!0);if(n==="esriFieldTypeString")return o;if(n==="esriFieldTypeGUID"||n==="esriFieldTypeGlobalID")return(u,r)=>o(D(u),D(r))}let l=t?1:-1,e=z(t),i=y(t,!0),a=N(t);return(o,u)=>typeof o=="number"&&typeof u=="number"?e(o,u):typeof o=="string"&&typeof u=="string"?i(o,u):a(o,u)??l}var h=(n,t)=>n==null?t==null?0:1:t==null?-1:null,V=(n,t)=>n==null?t==null?0:-1:t==null?1:null;function N(n){return n?h:V}var L=(n,t)=>V(n,t)??(n===t?0:new Date(n).getTime()-new Date(t).getTime()),R=(n,t)=>h(n,t)??(n===t?0:new Date(t).getTime()-new Date(n).getTime());function A(n){return n?R:L}var Y=(n,t)=>V(n,t)??(n===t?0:n<t?-1:1),_=(n,t)=>h(n,t)??(n===t?0:n<t?1:-1);function y(n,t){if(!t)return n?_:Y;let l=N(n);return n?(e,i)=>{let a=l(e,i);return a??((e=e.toUpperCase())>(i=i.toUpperCase())?-1:e<i?1:0)}:(e,i)=>{let a=l(e,i);return a??((e=e.toUpperCase())<(i=i.toUpperCase())?-1:e>i?1:0)}}var j=(n,t)=>h(n,t)??t-n,H=(n,t)=>V(n,t)??n-t;function z(n){return n?j:H}function D(n){return n.slice(24,36)+n.slice(19,23)+n.slice(16,18)+n.slice(14,16)+n.slice(11,13)+n.slice(9,11)+n.slice(6,8)+n.slice(4,6)+n.slice(2,4)+n.slice(0,2)}function en(n,t,l){let e;for(e in n)t?.include?.length&&!t.include.includes(e)||t?.exclude?.length&&t.exclude.includes(e)?delete n[e]:$.includes(e)&&(Number.isFinite(n[e])||(n[e]=null));return l&&["avg","stddev","variance"].forEach(i=>{n[i]!=null&&(n[i]=Math.ceil(n[i]??0))}),n}function an(n){let t={};for(let l of n)(l==null||typeof l=="string"&&l.trim()==="")&&(l=null),t[l]==null?t[l]={count:1,data:l}:t[l].count++;return{count:t}}function x(n){return n?.type!=="coded-value"?[]:n.codedValues.map(t=>t.code)}function un(n,t,l,e){let i=n.count,a=[];if(l&&t){let o=[],u=x(t[0]);for(let r of u)if(t[1]){let f=x(t[1]);for(let s of f)if(t[2]){let c=x(t[2]);for(let m of c)o.push(`${T(r)}${e}${T(s)}${e}${T(m)}`)}else o.push(`${T(r)}${e}${T(s)}`)}else o.push(r);for(let r of o)i.hasOwnProperty(r)||(i[r]={data:r,count:0})}for(let o in i){let u=i[o];a.push({value:u.data,count:u.count,label:u.label})}return{uniqueValueInfos:a}}function on(n,t,l,e){let i=null;switch(t){case"log":n!==0&&(i=Math.log(n)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(e)&&e!==0&&(i=n/e*100);break;case"field":Number.isFinite(l)&&l!==0&&(i=n/l);break;case"natural-log":n>0&&(i=Math.log(n));break;case"square-root":n>0&&(i=n**.5)}return i}function Q(n,t,l){let e=K({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,definedInterval:t.definedInterval,breakCount:t.numClasses||B});return n=J(n,t.minValue,t.maxValue),b({definition:e,values:n,normalizationTotal:t.normalizationTotal},l)}function J(n,t,l){let e=t??-1/0,i=l??1/0;return n.filter(a=>Number.isFinite(a)&&a>=e&&a<=i)}function K(n){let{breakCount:t,field:l,normalizationField:e,normalizationType:i}=n,a=n.classificationMethod||k,o=a==="standard-deviation"?n.standardDeviationInterval||M:void 0,u=a==="defined-interval"?n.definedInterval:void 0;return new I({breakCount:t,classificationField:l,classificationMethod:a,normalizationField:i==="field"?e:void 0,normalizationType:i,standardDeviationInterval:o,definedInterval:u})}function rn(n,t){let l=n.classBreaks,e=l.length,i=l[0]?.minValue,a=l[e-1]?.maxValue,o=t==="standard-deviation",u=q;return l=l.map(r=>{let f=r.label,s={minValue:r.minValue,maxValue:r.maxValue,label:f};if(o&&f){let c=f.match(u),m=c?.map(v=>+v.trim())??[];m.length===2?(s.minStdDev=m[0],s.maxStdDev=m[1],m[0]<0&&m[1]>0&&(s.hasAvg=!0)):m.length===1&&(f.includes("<")?(s.minStdDev=null,s.maxStdDev=m[0]):f.includes(">")&&(s.minStdDev=m[0],s.maxStdDev=null))}return s}),{minValue:i,maxValue:a,classBreakInfos:l,normalizationTotal:n.normalizationTotal}}function sn(n,t){let l=W(n,t);if(l.min==null&&l.max==null)return{bins:[],minValue:l.min,maxValue:l.max,normalizationTotal:t.normalizationTotal};let e=l.intervals,i=l.min??0,a=l.max??0,o=e.map((u,r)=>({minValue:e[r][0],maxValue:e[r][1],count:0}));for(let u of n)if(u!=null&&u>=i&&u<=a){let r=X(e,u);r>-1&&o[r].count++}return{bins:o,minValue:i,maxValue:a,normalizationTotal:t.normalizationTotal}}function W(n,t,l=!1){let{field:e,classificationMethod:i,standardDeviationInterval:a,definedInterval:o,normalizationType:u,normalizationField:r,normalizationTotal:f,minValue:s,maxValue:c}=t,m=t.numBins||w,v=null,g=null,d=null;if((!i||i==="equal-interval")&&!u){if(s!=null&&c!=null)v=s,g=c;else{let p=U({values:n,minValue:s,maxValue:c,useSampleStdDev:!u,supportsNullCount:O({normalizationType:u,normalizationField:r,minValue:s,maxValue:c})});v=p.min??null,g=p.max??null}d=Z(v??0,g??0,m)}else{let{classBreaks:p}=Q(n,{field:e,normalizationType:u,normalizationField:r,normalizationTotal:f,classificationMethod:i,standardDeviationInterval:a,definedInterval:o,minValue:s,maxValue:c,numClasses:m},s!=null&&c!=null?[s,c]:void 0);v=p[0]?.minValue,g=p[p.length-1]?.maxValue,d=p.map(F=>[F.minValue,F.maxValue])}if(l){let p=d.at(-1)[1];d.push([p,p])}return{min:v,max:g,intervals:d}}function X(n,t){let l=-1;for(let e=n.length-1;e>=0;e--)if(t>=n[e][0]){l=e;break}return l}function Z(n,t,l){let e=(t-n)/l,i=[],a,o=n;for(let u=1;u<=l;u++)a=o+e,a=Number(a.toFixed(16)),i.push([o,u===l?t:a]),o=a;return i}export{$ as a,T as b,O as c,ln as d,U as e,S as f,G as g,en as h,an as i,un as j,on as k,Q as l,K as m,rn as n,sn as o,W as p,X as q,Z as r};
