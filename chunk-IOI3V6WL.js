import{a as It,b as M,c as S,d as Z,g as St,r as Fe,s as P}from"./chunk-IAM754TS.js";import{b as Dt}from"./chunk-DLMQHZTF.js";import{b as je}from"./chunk-2XQT24NO.js";import{d as bt,e as At,f as zt}from"./chunk-Y4OUS3AZ.js";import{d as Oe}from"./chunk-5K5ZHVX6.js";import{a as ze}from"./chunk-NIYDRLW4.js";import{h as Ie,j as Se,m as De,o as He}from"./chunk-3BZAI7HK.js";import{c as Ae}from"./chunk-6T37AWU6.js";import{B as Ve,D as Rt,F as tt,G as ve,l as Lt,m as _,q as X,r as xe,x as gt}from"./chunk-SKMO433W.js";import{a as z,c as $,e as we}from"./chunk-2FO7ARYZ.js";import{b as Pt,d as I,h as et,j as yt,k as Re,l as nt,o as Q,q as qe,v as qt,y as be}from"./chunk-QXXXCEV5.js";import{C as N,D as Me,F as E,J as mt,b as pt,c as b,e as B,n as g,o as Te,p as U,q as Ce,t as Ne,u as y,v as K}from"./chunk-5WKDXHVH.js";import{a as ke}from"./chunk-PTZYZULI.js";import{b as Ee,i as _e}from"./chunk-KZKWOEFD.js";import{f as Le}from"./chunk-JEIB6WNP.js";import{a as J}from"./chunk-RSDQHAJX.js";import{b as ge}from"./chunk-XFESK2YB.js";import{a as l,b as q,c as vt,l as Pe}from"./chunk-NHSDW26F.js";import{a as ye}from"./chunk-GWBRHLNH.js";import{j as de,k as he}from"./chunk-VOFKUGRY.js";import{a as pe,i as me}from"./chunk-LB5YQINJ.js";import{z as fe}from"./chunk-C7INQGWT.js";import{i as ue,t as le}from"./chunk-47GHT6OF.js";function _t({start:e,end:t,type:n},s,r){let i=[],o=I(st,t,e),a=I(Tt,e,s),c=nt(o),u=2*Q(o,a),h=u*u-4*c*(nt(a)-r*r);if(h===0){let f=-u/(2*c);(n===k.PLANE||f>=0)&&i.push(et(z(),e,o,f))}else if(h>0){let f=Math.sqrt(h),L=(-u+f)/(2*c);(n===k.PLANE||L>=0)&&i.push(et(z(),e,o,L));let p=(-u-f)/(2*c);(n===k.PLANE||p>=0)&&i.push(et(z(),e,o,p))}return i}function Ot(e,t){let n=e.start,s=e.end,r=I(st,s,n),i=b(Nt,-r[1],r[0],0),o=t.start,a=t.end,c=E(Kt,a,o),u=y(c,i),h=b(We,n[0],n[1],0),f=E(Je,h,o),L=y(f,i),p=J();if(Math.abs(u)<p)return Math.abs(L),[];let m=g(Ke,o,c,L/u);if(t.type===P.RAY){let A=E(Ht,m,o);if(y(A,c)<-p)return[]}if(e.type===k.HALF_PLANE){let A=be(Tt,m,n);if(Q(A,r)<-p)return[]}return[q(m)]}function Ge(e,t){return an(Et(Xt,t[2],e),t)}function jt(e,t){return Wt(Et(Xt,0,e),Et(un,0,t)).map(([s,r])=>$(s,r))}function Ft(e,t,n){return Yt(e,Et(Xt,e[2],t),n)}function Gt(e,t,n,s=l()){let r=I(st,e,t),i=Re(r);return et(s,t,r,i===0?1:n/i),s[2]=e[2],s}function Yt(e,{start:t,end:n,type:s},r=l()){let i=E(Ct,e,t),o=E(Nt,n,t),a=y(i,o)/y(o,o);return g(r,t,o,s===P.RAY?Math.max(a,0):a)}var Ye=(()=>{let e=l(),t=l(),n=l();return({start:s,end:r},{center:i,radius:o,normal:a,slicePlane:c})=>{let u=X(i,a,cn);if(d(tt(u,s),0)&&d(tt(u,r),0)){Lt(a,e,t);let f=(m,A)=>(B(n,A,i),Pt(m,y(n,e),y(n,t)),m),L=Fe({start:f(st,s),end:f(Tt,r),type:P.LINE},we,o),p=[];for(let[m,A]of L){let C=pt(l(),i);g(C,C,e,m),g(C,C,t,A),c&&!D(c,C)||p.push(C)}return p}let h=l();return gt(u,s,r,h)?!d(Te(h,i),o)||c&&!D(c,h)?[]:[h]:[]}})();function Zt({start:e,end:t,type:n},s,r){let i=[],o=B(Ct,t,e),a=I(Tt,e,s),c=nt(o),u=2*Q(o,a),h=u*u-4*c*(nt(a)-r*r);if(h===0){let f=-u/(2*c);(n===P.LINE||f>=0)&&i.push(g(l(),e,o,f))}else if(h>0){let f=Math.sqrt(h),L=(-u+f)/(2*c);(n===P.LINE||L>=0)&&i.push(g(l(),e,o,L));let p=(-u-f)/(2*c);(n===P.LINE||p>=0)&&i.push(g(l(),e,o,p))}return i}function Wt(e,t){let n=e.start,s=e.end,r=t.start,i=t.end,o=E(Ct,s,n),a=E(Nt,i,r),c=E(Kt,r,n),u=K(We,o,a);if(!d(y(c,u),0))return[];let h=mt(u);if(d(h,0))return[];let f=K(Je,c,a),L=y(f,u)/h,p=g(Ke,n,o,L);if(e.type===P.RAY){let m=E(Ht,p,n);if(y(o,m)<-J())return[]}if(t.type===P.RAY){let m=E(Ht,p,r);if(y(a,m)<-J())return[]}return[q(p)]}function an({start:e,end:t,type:n},s){let r=E(Ct,s,e),i=E(Nt,t,e),o=K(Kt,i,r),a=mt(o)/mt(i),c=J();if(a<c)switch(n){case P.LINE:return[q(s)];case P.RAY:return y(i,r)<-c?[]:[q(s)]}return[]}function kt(e,t,n,s){let[r,i]=e,[o,a]=n,c=o-r,u=a-i,h=c*c+u*u,f=Math.sqrt(h);if(f>t+s)return[];if(f<Math.abs(t-s))return[];if(d(f,0)&&d(t,s))return[];let L=(t*t-s*s+h)/(2*f),p=Math.sqrt(t*t-L*L),m=p*u/f,A=p*c/f,[C,Y]=qe(st,e,n,L/f);return d(m,A)?[$(C,Y)]:[$(C+m,Y-A),$(C-m,Y+A)]}function Et(e,t,{start:n,end:s,type:r}){return b(e.start,n[0],n[1],t),b(e.end,s[0],s[1],t),e.type=on[r],e}function Jt(e,t){return d(e[2],t[2])}function d(e,t){return he(Math.abs(e-t),0,J())}function Ze(e,t){return t.filter(n=>D(e,n))}function D(e,t){return Ve(e,t)}var k;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(k||(k={}));var on={[k.PLANE]:P.LINE,[k.HALF_PLANE]:P.RAY},st=z(),Tt=z(),Ct=l(),Nt=l(),Kt=l(),We=l(),Je=l(),Ke=l(),Ht=l(),cn=_(),Xt={start:l(),end:l(),type:P.LINE},un={start:l(),end:l(),type:P.LINE};var T=class{intersect(t){return H(this,t)}closestPoints(t){return[this.closestTo(t)]}},W=class extends T{constructor(t){super(),this.point=t}equals(t){return this===t||w(t)&&N(this.point,t.point)}closestTo(){return Z(this.point)}},it=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:s}}equals(t){return this===t||V(t)&&this.lineLike.type===t.lineLike.type&&N(this.start,t.start)&&N(this.end,t.end)}closestTo(t){let n=M();return Yt(t,this.lineLike,n),n}},Mt=class extends it{constructor(t,n){super(t,n,P.LINE)}},Ut=class extends it{constructor(t,n){super(t,n,P.RAY)}},wt=class extends T{constructor(t){super(),this.constraints=t}equals(t){return this===t||ie(t)&&ue(this.constraints,t.constraints,(n,s)=>n.equals(s))}closestTo(t){let n,s=1/0;for(let r of this.constraints){let i=r.closestTo(t),o=U(t,i);o<s&&(s=o,n=i)}return Z(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}},$t=class extends T{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||R(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){let n=M();return Gt(t,this.center,this.radius,n),n}},at=class extends T{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||j(t)&&N(this.center,t.center)&&this.radius===t.radius}closestTo(t){let n=M();return Gt(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new ot(Z(this.center),this.radius,S(0,0,1))}},ot=class extends T{constructor(t,n,s,r=void 0){super(),this.center=t,this.radius=n,this.normal=s,this.slicePlane=r}equals(t){return this===t||G(t)&&N(this.center,t.center)&&N(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){let{center:n,radius:s}=this;Rt(this.getPlane(ln),t,Qt);let r=E(Qt,Qt,n),i=Ce(r);if(d(i,0))return Z(t);let o=s/Math.sqrt(i),a=M();g(a,n,r,o);let{slicePlane:c}=this;return c&&!D(c,a)?ae(c,this)?.closestTo(t)??Z(t):a}getPlane(t=_()){return X(this.center,this.normal,t)}},Qt=l(),ln=_(),te=class extends T{constructor(t){super(),this.z=t}equals(t){return this===t||O(t)&&this.z===t.z}closestTo(t){return S(t[0],t[1],this.z)}getPlane(t=_()){return b(Xe,0,0,this.z),X(Xe,Pe,t)}},Xe=l(),ct=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:s}}equals(t){return this===t||v(t)&&this.planeLike.type===t.planeLike.type&&N(this.start,t.start)&&N(this.end,t.end)}closestTo(t){let n=M();return Ft(t,this.planeLike,n),n}closestEndTo(t){let{start:n,end:s}=this.planeLike;return Math.sign(Q(I(fn,s,n),I(dn,t,n)))>0?this.end:this.start}getPlane(t=_()){let n=pt(Qe,this.end);return n[2]+=1,xe(this.start,this.end,n,t)}getSlicePlane(t=_()){let{start:n,end:s,type:r}=this.planeLike;if(r===k.PLANE)return;let i=b(Qe,n[0],n[1],0),o=b(Be,s[0],s[1],0),a=B(Be,o,i);return X(i,a,t),t}},fn=z(),dn=z(),Qe=l(),Be=l(),Ue=class extends ct{constructor(t,n){super(t,n,k.HALF_PLANE)}},$e=class extends ct{constructor(t,n){super(t,n,k.PLANE)}},ee=class extends T{constructor(t,n){super(),this.sphere=Se(t,n)}equals(t){return this===t||F(t)&&Ie(this.sphere,t.sphere)}closestTo(t){let n=M();return He(this.sphere,t,n),n}get center(){return this.sphere}get radius(){return this.sphere[3]}},ne=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.getZ=s,this.planeLike={start:t,end:n,type:k.PLANE}}equals(t){return this===t||xt(t)&&N(this.start,t.start)&&N(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Ln(this,t)}addIfOnTheGround(t,n){for(let s of n){let r=this.getZ(s[0],s[1])??0;d(s[2],r)&&(s[2]=r,t.push(s))}}},se=class extends T{constructor(t,n,s){super(),this._x=t,this._y=n,this._z=s}equals(t){return this===t||Rn(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,s]){return It(this._x??t,this._y??n,this._z??s)}},re=class extends T{constructor(t,n,s,r,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=s,this._z=r,this._directionDegrees=i}equals(t){return this===t||vn(t)&&qt(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,n,s]){return Pt(rt,t,n),qt(rt,this._origin)||this._applyDirectionAndDistance(rt),It(rt[0],rt[1],this._z??s)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)At(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)pn(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){let{azimuth:n}=zt(hn,this._origin,t,this._spatialReference);At(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}},rt=[0,0],hn=new bt;function pn(e,t,n,s,r){let{azimuth:i,distance:o}=zt(mn,t,s,r);i??=0;let a=o*Math.cos((i-n)*ye);a=Math.max(0,a),At(e,t,n,a,r)}var mn=new bt;function Ln(e,t){let n=M();return Ft(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??nn,n}function H(e,t){if(ie(e)){let n=[];for(let s of e.constraints){let r=s.intersect(t);r&&n.push(r)}return oe(n)}if(ie(t))return H(t,e);if(xt(e))return tn(e,t);if(xt(t))return tn(t,e);if(w(e)){let{point:n}=e;if(w(t))return N(n,t.point)?e:void 0;let s=t.closestTo(n);return Me(s,n)?e:void 0}if(V(e)){if(w(t))return H(t,e);if(V(t))return x(Wt(e.lineLike,t.lineLike));if(O(t))return gn(e,t);if(v(t))return x(Ot(t.planeLike,e.lineLike));if(R(t))return x(Zt(e.lineLike,t.center,t.radius));if(G(t))return x(Ye(e.lineLike,t));if(j(t))return Pn(e,t);if(F(t))return yn(e,t)}else if(O(e)){if(w(t)||V(t))return H(t,e);if(O(t))return An(e,t);if(v(t))return En(e,t);if(R(t))return _n(e,t);if(G(t))return Tn(e,t);if(j(t))return kn(e,t);if(F(t))return Cn(e,t)}else if(v(e)){if(w(t)||V(t)||O(t))return H(t,e);if(v(t))return Bt(jt(e.planeLike,t.planeLike));if(R(t))return Bt(_t(e.planeLike,t.center,t.radius));if(G(t))return Mn(e,t);if(j(t))return Nn(e,t);if(F(t))return wn(e,t)}else if(R(e)){if(w(t)||V(t)||O(t)||v(t))return H(t,e);if(R(t))return Bt(kt(e.center,e.radius,t.center,t.radius));if(G(t))return void 0;if(j(t))return xn(e,t);if(F(t))return void 0}else if(G(e)){if(w(t)||V(t)||O(t)||v(t)||R(t))return H(t,e);if(G(t))return void 0;if(j(t))return t.asCircle(),void 0;if(F(t))return void 0}else if(j(e)){if(w(t)||V(t)||O(t)||v(t)||R(t)||G(t))return H(t,e);if(j(t))return Vn(t,e);if(F(t))return void 0}else if(F(e)){if(w(t)||V(t)||O(t)||v(t)||R(t)||j(t))return H(t,e);if(F(t))return void 0}}var gn=(()=>{let e=_();return(t,n)=>{let{start:s,end:r}=t;if(Jt(s,r)&&d(s[2],n.z))return t;let i=M();return gt(n.getPlane(e),s,r,i)?new W(i):void 0}})();function Pn({lineLike:e},{center:t,radius:n}){let s=t[2];return x(Zt(e,t,n).filter(r=>d(r[2],s)))}function yn({lineLike:e},{sphere:t}){return x(De(t,e.start,e.end))}var ae=(()=>{let e=ke(),t=l(),n=l();return(s,r,i)=>{let{normal:o,center:a,radius:c}=r;Lt(o,t,n);let u=s,h=c*y(u,t),f=c*y(u,n);Ee(e,a[0],a[1],a[2],1);let L=_e(s,e),p=Math.hypot(h,f),m=d(p,0);if(d(tt(s,a),0)){if(m)return r;if(d(c,0))return!i||D(i,a)?new W(Z(a)):void 0;K(t,u,o),Ne(t,t);let Vt=new Array,dt=q(a);g(dt,dt,t,c),i&&!D(i,dt)||Vt.push(dt);let ht=q(a);return g(ht,ht,t,-c),i&&!D(i,ht)||Vt.push(ht),x(Vt)}if(m)return;let A=-L/p;if(Math.abs(A)>1||d(A,1))return;let C=Math.atan(h/f),Y=de(A)-C,ce=Math.PI-Y,ut=new Array,lt=l();g(lt,a,t,c*Math.cos(Y)),g(lt,lt,n,c*Math.sin(Y)),ut.push(lt);let ft=l();return g(ft,a,t,c*Math.cos(ce)),g(ft,ft,n,c*Math.sin(ce)),ut.push(ft),x(i?Ze(i,ut):ut)}})();function An(e,t){return d(e.z,t.z)?e:void 0}function En({z:e},{planeLike:t}){let[n,s]=t.start,[r,i]=t.end,o=S(n,s,e),a=S(r,i,e);return t.type===k.PLANE?new Mt(o,a):new Ut(o,a)}function _n(e,t){let[n,s]=t.center;return new at(S(n,s,e.z),t.radius)}function kn(e,t){return d(t.center[2],e.z)?t:void 0}var Tn=(()=>{let e=_();return(t,n)=>ae(t.getPlane(e),n,n.slicePlane)})();function Cn(e,{center:t,radius:n}){let s=Math.abs(t[2]-e.z);if(s>n&&!d(s,n))return;let r=S(t[0],t[1],e.z),i=Math.sqrt(n**2-s**2);return d(i,0)?void 0:new at(r,i)}var Nn=(()=>{let e=_();return(t,{center:n,radius:s})=>{let r=_t(t.planeLike,n,s),i=n[2];t.getSlicePlane(e);let o=new Array;for(let[a,c]of r){let u=[a,c,i];D(e,u)&&o.push(u)}return x(o)}})(),Mn=(()=>{let e=_(),t=_();return(n,s)=>ae(n.getPlane(e),s,n.getSlicePlane(t))})(),wn=(()=>{let e=_();return(t,{center:n,radius:s})=>{let r=t.getPlane(e),i=ve(r,n),o=Math.abs(i);if(o>s&&!d(o,s))return;let a=Math.sqrt(s**2-i**2);if(d(a,0)){let h=M();return Rt(r,n,h),new W(h)}let c=M(),u=q(r);return g(c,n,u,i),new ot(c,a,u,t.getSlicePlane())}})();function xn(e,t){let n=yt(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?t:en(kt(e.center,e.radius,t.center,t.radius),t.center[2])}function Vn(e,t){if(!Jt(e.center,t.center))return;let n=yt(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?e:en(kt(e.center,e.radius,t.center,t.radius),e.center[2])}function tn(e,t){let{planeLike:n,getZ:s}=e,r=new Array;if(w(t))e.addIfOnTheGround(r,Ge(n,t.point));else if(V(t))e.addIfOnTheGround(r,Ot(n,t.lineLike));else if(R(t))for(let[i,o]of _t(n,t.center,t.radius)){let a=s(i,o);a!=null&&r.push(vt(i,o,a))}else if(v(t)||xt(t))for(let[i,o]of jt(n,t.planeLike)){let a=s(i,o)??nn;r.push(vt(i,o,a))}return x(r)}function Bt(e){return oe(e.map(([t,n])=>{let s=S(t,n,0),r=S(t,n,1);return new Mt(s,r)}))}function x(e){return oe(e.map(t=>t?new W(t):void 0))}function en(e,t){return x(e.map(([n,s])=>[n,s,t]))}function oe(e){if(e.length!==0)return e.length===1?e[0]??void 0:new wt(e.filter(le))}function ie(e){return e instanceof wt}function w(e){return e instanceof W}function V(e){return e instanceof it}function O(e){return e instanceof te}function v(e){return e instanceof ct}function R(e){return e instanceof $t}function j(e){return e instanceof at}function G(e){return e instanceof ot}function F(e){return e instanceof ee}function xt(e){return e instanceof ne}function vn(e){return e instanceof re}function Rn(e){return e instanceof se}var nn=0;var Cs=Symbol("grid-placement-graphic");function qn(e,t){let n=e.x-t.x,s=e.y-t.y;return n*n+s*s}function Ns(e,t){return Math.sqrt(qn(e,t))}function Ms(e,t){t.sort((n,s)=>U(n.targetPoint,e)-U(s.targetPoint,e))}var sn;function ws({point:e,distance:t,returnEdge:n,vertexMode:s,coordinateHelper:{spatialReference:r},filter:i},o,a){return a=a!=null?a.clone():new Ae({where:"1=1"}),i&&(a.geometry=i.geometry,a.distance=i.distance,a.spatialRelationship=i.spatialRelationship,a.where=ge(a.where,i.where),a.timeExtent=Le(a.timeExtent,i.timeExtent),a.objectIds=bn(a.objectIds,i.objectIds)),{point:ze(e[0],e[1],e[2],r.toJSON()),mode:o,distance:t,returnEdge:n,vertexMode:s,query:a.toJSON()}}function bn(e,t){return e||t?t?e?Array.from(fe(new Set(e),new Set(t))):t:e:null}function xs(e,t,n){return{left:St(e.leftVertex.pos,t,n),right:St(e.rightVertex.pos,t,n)}}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(sn||(sn={}));var rn=Symbol("snapping-toggle");function Vs(e,t=()=>{}){let n=pe(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:s,snappingOptions:r})=>{if(e.removeHandles(rn),!s||!r)return;let i=Oe.TOOL,o=[s.on("key-down",a=>{a.key!==Dt.toggle||a.repeat||(r.enabledToggled=!0,t())},i),s.on("key-up",a=>{a.key===Dt.toggle&&(r.enabledToggled=!1,t())},i),s.on("pointer-move",a=>{let c=a.native.ctrlKey;r.enabledToggled!==c&&(r.enabledToggled=c,t())},i)];e.addHandles(o,rn)},me);e.addHandles(n)}function vs(e){return je(e)&&"utilityNetworks"in e&&!!e.utilityNetworks?.length}export{Yt as a,W as b,Mt as c,$t as d,te as e,Ue as f,$e as g,ne as h,se as i,re as j,oe as k,w as l,Cs as m,qn as n,Ns as o,Ms as p,sn as q,ws as r,xs as s,Vs as t,vs as u};
