import{a as d,b,c,e as V}from"./chunk-XBWYS7K7.js";import"./chunk-EUD3KSLO.js";import"./chunk-DCKTHYU4.js";import"./chunk-525N4T6K.js";import"./chunk-EBK2L6ZQ.js";import"./chunk-ZMJUEIM7.js";import"./chunk-XC4BCVYU.js";import"./chunk-V7IMCFL4.js";import"./chunk-XD6QSICT.js";import"./chunk-FTOLVNUN.js";import"./chunk-EOLWCIYR.js";import"./chunk-YOMR2DCD.js";import"./chunk-KDF3RZ2K.js";import"./chunk-AFSNSPOG.js";import"./chunk-JOGV3DWE.js";import"./chunk-JEGXFID4.js";import"./chunk-SU5S5XU7.js";import"./chunk-F6A6XWW4.js";import"./chunk-AESEF3B2.js";import"./chunk-PWU2QHPV.js";import"./chunk-WUJRCGDY.js";import"./chunk-QPGCDGIN.js";import"./chunk-7Y6S2GNA.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-PTZYZULI.js";import"./chunk-KZKWOEFD.js";import"./chunk-LNVVFNTC.js";import{a as J}from"./chunk-QR6GP2OF.js";import{a as A}from"./chunk-MAVVUPFJ.js";import{a as W}from"./chunk-OOAI5LGC.js";import{c as T}from"./chunk-5TMYC5PF.js";import"./chunk-RCDSCJMH.js";import"./chunk-QJADLTFR.js";import{a as z}from"./chunk-IWPCZHB6.js";import{a as C}from"./chunk-2BIJFS64.js";import{e as P}from"./chunk-SCKV27CX.js";import"./chunk-FXCL7YYQ.js";import"./chunk-HX2BGUTP.js";import"./chunk-XSTBHERR.js";import{a as R}from"./chunk-S7QYPX7J.js";import{a as H}from"./chunk-KWZIB4M6.js";import"./chunk-YQPWWSMJ.js";import"./chunk-JEIB6WNP.js";import"./chunk-6JJCXUHW.js";import"./chunk-CVRJ6GOM.js";import"./chunk-X7QUUHRV.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-3HCMTURP.js";import"./chunk-VT67LWCR.js";import"./chunk-K27GONOJ.js";import"./chunk-6KRFVLII.js";import"./chunk-JR22Z7I2.js";import"./chunk-3QNSJ5HY.js";import"./chunk-UNVICPIE.js";import"./chunk-BGICKEJR.js";import"./chunk-TRZXSDYA.js";import"./chunk-OGS2SUK5.js";import"./chunk-TVHRLNTK.js";import"./chunk-JA3EMS2I.js";import"./chunk-HKHTIKVW.js";import"./chunk-XFESK2YB.js";import"./chunk-IJBTA53P.js";import"./chunk-ZHUXSQTN.js";import"./chunk-YLZWDFCJ.js";import"./chunk-TLMADEUL.js";import"./chunk-WNSGKHQ6.js";import"./chunk-J5MXC6AL.js";import"./chunk-OLOKUDVI.js";import"./chunk-RJWOVI3M.js";import"./chunk-MDL4XPLR.js";import"./chunk-ILKINAL7.js";import"./chunk-HVKMTRIC.js";import"./chunk-AZS4Q4RE.js";import{a as K}from"./chunk-QEBUS3TL.js";import"./chunk-IB2IUO7T.js";import"./chunk-MS3KE2OO.js";import"./chunk-NHSDW26F.js";import"./chunk-NMAGYK3Q.js";import"./chunk-GWBRHLNH.js";import"./chunk-CNQVGGE6.js";import"./chunk-JGD7UKVF.js";import"./chunk-J372WZPB.js";import"./chunk-6XFS4U2F.js";import"./chunk-XPRVY6JT.js";import"./chunk-7N3ZKWML.js";import"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import"./chunk-3SDSCSDJ.js";import{j as m}from"./chunk-I4M2OT5W.js";import"./chunk-NTVLK3P2.js";import{a as w}from"./chunk-WMQNRNIU.js";import{a as u}from"./chunk-HD52PWPC.js";import{a as j}from"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-5TW726OD.js";import"./chunk-VGD3XLDH.js";import{a as h,c as S,d as g,g as p}from"./chunk-LB5YQINJ.js";import{b as y}from"./chunk-EKMHQEJY.js";import{a as I}from"./chunk-VACZNAP3.js";import"./chunk-JKNCWG7E.js";import"./chunk-KTE5HCNJ.js";import"./chunk-F7VRLFCB.js";import"./chunk-7IPIJKWU.js";import"./chunk-7R33MKVL.js";import"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import{L as N}from"./chunk-U4J5SECU.js";import{f as _}from"./chunk-7EG726PT.js";import{d as i}from"./chunk-C7INQGWT.js";import{H as f,j as F}from"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import{x as M}from"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import{a as r}from"./chunk-QGVBCWUY.js";import{o as k}from"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{a as O,f as E}from"./chunk-VTHXE323.js";var v,a=v=class extends I.EventedMixin(_.JSONSupportMixin(K)){constructor(...e){super(...e),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([S(()=>this.sublayers,"after-add",({item:t})=>{t.parent=this,t.layer=this.layer},p),S(()=>this.sublayers,"after-remove",({item:t})=>{t.layer=t.parent=null},p),h(()=>this.sublayers,(t,s)=>{if(s)for(let o of s)o.layer=o.parent=null;if(t)for(let o of t)o.parent=this,o.layer=this.layer},p),h(()=>this.layer,t=>{if(this.sublayers)for(let s of this.sublayers)s.layer=t},p)])}initialize(){g(()=>this.networkLink).then(()=>g(()=>this.visible===!0)).then(()=>this.load())}load(e){if(!this.networkLink||this.networkLink.viewFormat)return;let t=e!=null?e.signal:null,s=this._fetchService(this._get("networkLink")?.href??"",t).then(o=>{let n=V(o.sublayers);this.fullExtent=m.fromJSON(n),this.sourceJSON=o;let x=F(y.ofType(v),c(v,o));this.sublayers?this.sublayers.addMany(x):this.sublayers=x,this.layer?.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(s),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,t){return!!t.visibility}_fetchService(e,t){return b(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then(s=>d(s.data))}};r([i()],a.prototype,"description",void 0),r([i({type:m})],a.prototype,"fullExtent",void 0),r([i()],a.prototype,"id",void 0),r([i({readOnly:!0,value:null})],a.prototype,"networkLink",void 0),r([i({json:{write:{allowNull:!0}}})],a.prototype,"parent",void 0),r([i({type:y.ofType(a),json:{write:{allowNull:!0}}})],a.prototype,"sublayers",void 0),r([i({value:null,json:{read:{source:"name",reader:e=>k(e)}}})],a.prototype,"title",void 0),r([i({value:!0})],a.prototype,"visible",null),r([u("visible",["visibility"])],a.prototype,"readVisible",null),r([i()],a.prototype,"sourceJSON",void 0),r([i()],a.prototype,"layer",void 0),a=v=r([f("esri.layers.support.KMLSublayer")],a);var L=a;var B=["kml","xml"],l=class extends T(W(z(C(A(R(H)))))){constructor(...e){super(...e),this._visibleFolders=[],this.allSublayers=new J({getCollections:()=>[this.sublayers],getChildrenFunction:t=>t.sublayers}),this.outSpatialReference=w.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([h(()=>this.sublayers,(e,t)=>{t&&t.forEach(s=>{s.parent=null,s.layer=null}),e&&e.forEach(s=>{s.parent=this,s.layer=this})},p),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))])}normalizeCtorArgs(e,t){return typeof e=="string"?O({url:e},t):e}readSublayersFromItemOrWebMap(e,t){this._visibleFolders=t.visibleFolders}readSublayers(e,t,s){return c(L,t,s,this._visibleFolders)}writeSublayers(e,t){let s=[],o=e.toArray();for(;o.length;){let n=o[0];n.networkLink||(n.visible&&s.push(n.id),n.sublayers&&o.push(...n.sublayers.toArray())),o.shift()}t.visibleFolders=s}get title(){let e=this._get("title");return e&&this.originOf("title")!=="defaults"?e:this.url?N(this.url,B)||"KML":e}set title(e){this._set("title",e)}get visibleSublayers(){let e=this.sublayers,t=[],s=o=>{o.visible&&(t.push(o),o.sublayers&&o.sublayers.forEach(s))};return e&&e.forEach(s),t}get fullExtent(){return this._recomputeFullExtent()}load(e){let t=e!=null?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},e).catch(M).then(()=>this._fetchService(t))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(e){return E(this,null,function*(){let t=yield Promise.resolve().then(()=>this.resourceInfo?{ssl:!1,data:this.resourceInfo}:b(this.url??"",this.outSpatialReference,this.refreshInterval,e)),s=d(t.data);this.read(s,{origin:"service"})})}_recomputeFullExtent(){let e=null;this.extent!=null&&(e=this.extent.clone());let t=s=>{if(s.sublayers)for(let o of s.sublayers.items)t(o),o.visible&&o.fullExtent&&(e!=null?e.union(o.fullExtent):e=o.fullExtent.clone())};return t(this),e}};r([i({readOnly:!0})],l.prototype,"allSublayers",void 0),r([i({type:w})],l.prototype,"outSpatialReference",void 0),r([i({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],l.prototype,"path",void 0),r([i({readOnly:!0,json:{read:!1,write:!1}})],l.prototype,"legendEnabled",void 0),r([i({type:["show","hide","hide-children"]})],l.prototype,"listMode",void 0),r([i({type:["KML"]})],l.prototype,"operationalLayerType",void 0),r([i({})],l.prototype,"resourceInfo",void 0),r([i({type:y.ofType(L),json:{write:{ignoreOrigin:!0}}})],l.prototype,"sublayers",void 0),r([u(["web-map","portal-item"],"sublayers",["visibleFolders"])],l.prototype,"readSublayersFromItemOrWebMap",null),r([u("service","sublayers",["sublayers"])],l.prototype,"readSublayers",null),r([j("sublayers")],l.prototype,"writeSublayers",null),r([i({readOnly:!0,json:{read:!1}})],l.prototype,"type",void 0),r([i({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],l.prototype,"title",null),r([i(P)],l.prototype,"url",void 0),r([i({readOnly:!0})],l.prototype,"visibleSublayers",null),r([i({type:m})],l.prototype,"extent",void 0),r([i()],l.prototype,"fullExtent",null),l=r([f("esri.layers.KMLLayer")],l);var Je=l;export{Je as default};
