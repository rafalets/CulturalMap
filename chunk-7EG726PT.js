import{L as C,a as P,b as h,c as y,o as u,q as x,s as j}from"./chunk-C7INQGWT.js";import{E as T,F as g,G as w,H as S}from"./chunk-WMHJC7XF.js";import{a as f,c as d}from"./chunk-FNXQZPHT.js";import{a as O}from"./chunk-QGVBCWUY.js";import{b as E,r as b,t as J}from"./chunk-HHDFN2GK.js";import{i as _}from"./chunk-47GHT6OF.js";import{a as N,b as D}from"./chunk-VTHXE323.js";function F(i,r,e,t,o){let n={};return r.write?.writer?.call(i,t,n,e,o),n}function z(i,r,e,t,o,n){if(!t?.write)return!1;let s=h(i,e);if(!o&&t.write.overridePolicy){let a=t.write.overridePolicy.call(i,s,e,n??void 0);a!==void 0&&(o=a)}if(o||(o=t.write),!o||o.enabled===!1||o.layerContainerTypes&&n?.layerContainerType&&!o.layerContainerTypes.includes(n.layerContainerType))return!1;if((s===null&&!o.allowNull&&!o.writerEnsuresNonNull||s===void 0)&&o.isRequired){let a=new J("web-document-write:property-required",`Missing value for required property '${e}' on '${i.declaredClass}'`,{propertyName:e,target:i});return a&&n?.messages?n.messages.push(a):a&&!n&&b.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(s===void 0||s===null&&!o.allowNull&&!o.writerEnsuresNonNull||!o.alwaysWriteDefaults&&(!r.store.multipleOriginsSupported||r.store.originOf(e)===u.DEFAULTS)&&R(i,e,n,t,s)||!o.ignoreOrigin&&n?.origin&&r.store.multipleOriginsSupported&&r.store.originOf(e)<x(n.origin))}function R(i,r,e,t,o){let n=t.default;if(n===void 0)return!1;if(t.defaultEquals!=null)return t.defaultEquals(o);if(typeof n=="function"){if(Array.isArray(o)){let s=n.call(i,r,e??void 0);return _(s,o)}return!1}return n===o}function Z(i,r,e,t){let o=f(i),n=o.metadata,s=w(n[r],t);return!!s&&z(i,o,r,s,e,t)}function A(i,r,e){if(i&&typeof i.toJSON=="function"&&(!i.toJSON.isDefaultToJSON||!i.write))return d(r,i.toJSON(e));let t=f(i),o=t.metadata;for(let n in o){let s=w(o[n],e);if(!z(i,t,n,s,void 0,e))continue;let a=h(i,n),l=F(i,s,s.write&&typeof s.write.target=="string"?s.write.target:n,a,e);Object.keys(l).length>0&&(r=d(r,l),e?.resources?.pendingOperations?.length&&e.resources.pendingOperations.push(Promise.all(e.resources.pendingOperations).then(()=>d(r,l,()=>"replace-arrays"))),e?.writtenProperties&&e.writtenProperties.push({target:i,propName:n,oldOrigin:j(t.store.originOf(n)),newOrigin:e.origin}))}return r}var m=class i{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(r){let e=new i;return this._values.forEach((t,o)=>{r&&r.has(o)||e.set(o,E(t.value),t.origin)}),e}get(r,e){e=this._normalizeOrigin(e);let t=this._values.get(r);return e==null||t?.origin===e?t?.value:void 0}originOf(r){return this._values.get(r)?.origin??u.USER}keys(r){r=this._normalizeOrigin(r);let e=[...this._values.keys()];return r==null?e:e.filter(t=>this._values.get(t)?.origin===r)}set(r,e,t){if((t=this._normalizeOrigin(t))===u.DEFAULTS){let o=this._values.get(r);if(o?.origin!=null&&o.origin>t)return}this._values.set(r,new v(e,t))}delete(r,e){(e=this._normalizeOrigin(e))!=null&&this._values.get(r)?.origin!==e||this._values.delete(r)}has(r,e){return(e=this._normalizeOrigin(e))!=null?this._values.get(r)?.origin===e:this._values.has(r)}forEach(r){this._values.forEach(({value:e},t)=>r(e,t))}_normalizeOrigin(r){if(r!=null)return r===u.DEFAULTS?r:u.USER}},v=class{constructor(r,e){this.value=r,this.origin=e}};function L(i,r,e){r.keys().forEach(o=>{e.set(o,r.get(o),u.DEFAULTS)});let t=i.metadata;Object.keys(t).forEach(o=>{i.internalGet(o)&&e.set(o,i.internalGet(o),u.DEFAULTS)})}function I(i,r,e){if(!i?.read||i.read.enabled===!1||!i.read.source)return!1;let t=i.read.source;if(typeof t=="string"){if(t===r||t.includes(".")&&t.indexOf(r)===0&&y(t,e))return!0}else for(let o of t)if(o===r||o.includes(".")&&o.indexOf(r)===0&&y(o,e))return!0;return!1}function W(i){return i&&(!i.read||i.read.enabled!==!1&&!i.read.source)}function M(i,r,e,t,o){let n=g(r[e],o);W(n)&&(i[e]=!0);for(let s of Object.getOwnPropertyNames(r))n=g(r[s],o),I(n,e,t)&&(i[s]=!0)}function G(i,r,e,t){let o=e.metadata,n=T(o[r],t),s=n?.default;if(s===void 0)return;let a=typeof s=="function"?s.call(i,r,t):s;a!==void 0&&e.set(r,a)}var U={origin:"service"};function q(i,r,e=U){if(!r||typeof r!="object")return;let t=f(i),o=t.metadata,n={};for(let s of Object.getOwnPropertyNames(r))M(n,o,s,r,e);t.setDefaultOrigin(e.origin);for(let s of Object.getOwnPropertyNames(n)){let a=g(o[s],e).read,l=a?.source,c;c=l&&typeof l=="string"?P(r,l):r[s],a?.reader&&(c=a.reader.call(i,c,r,e)),c!==void 0&&t.set(s,c)}if(!e||!e.ignoreDefaults){t.setDefaultOrigin("defaults");for(let s of Object.getOwnPropertyNames(o))n[s]||G(i,s,t,e)}t.setDefaultOrigin("user")}function le(i,r,e,t=U){let o=D(N({},t),{messages:[]});e(o),o.messages?.forEach(n=>{n.type!=="warning"||i.loaded?t?.messages&&t.messages.push(n):i.loadWarnings.push(n)})}var k=i=>{let r=class extends i{constructor(...e){super(...e);let t=f(this),o=t.store,n=new m;t.store=n,L(t,o,n)}read(e,t){q(this,e,t)}write(e,t){return A(this,e??{},t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return $.call(this,e,t)}};return r=O([S("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function $(i,r){if(!i)return null;if(i.declaredClass)throw new Error("JSON object is already hydrated");let e=new this;return e.read(i,r),e}var p=class extends k(C){};p=O([S("esri.core.JSONSupport")],p),function(i){function r(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}i.JSONSupportMixin=k,i.isSerializable=r}(p||(p={}));var Se=p;export{L as a,q as b,le as c,Z as d,A as e,Se as f};
