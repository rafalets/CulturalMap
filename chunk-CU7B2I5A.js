import{b as p}from"./chunk-2ZKDDIFZ.js";import{a as b}from"./chunk-WAGBL553.js";import{c as f,d as C,e as d}from"./chunk-7ZYPJJID.js";import{g as s}from"./chunk-UAKHZRKN.js";import{a as g}from"./chunk-IXCTZWTQ.js";import{b as h}from"./chunk-6PN3I333.js";import{a as y}from"./chunk-LB5YQINJ.js";import{d as n}from"./chunk-C7INQGWT.js";import{H as v}from"./chunk-WMHJC7XF.js";import{a as i}from"./chunk-QGVBCWUY.js";import{f as m}from"./chunk-VTHXE323.js";var c="esri-utility-network-association-list",u={featureObserver:`${c}__feature-observer`,filterContainer:`${c}__filter-container`,limitNoticeContainer:`${c}__limit-notice-container`,loadingContainer:`${c}__loading-container`},o=class extends C{constructor(t,e){super(t,e),this._isFeatureCountNoticeOpen=!0,this._observer=new IntersectionObserver(([r])=>{r?.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this._observerNode=null,this.featuresPerPage=50,this.filterText="",this.headingLevel=5,this.maxFeatureCount=1e3,this.messagesFeature=null,this.messagesCommon=null,this.selectedLayer=null,this.tooltipReferenceMap=new b,this.viewModel=new p}initialize(){this.setUpObserver()}loadDependencies(){return f({icon:()=>import("./chunk-QXDSJABL.js"),input:()=>import("./chunk-PTLKWOPS.js"),loader:()=>import("./chunk-JHM3YD5O.js"),notice:()=>import("./chunk-RIKTH4T2.js")})}destroy(){this.tooltipReferenceMap.clear()}get associatedFeatureCount(){let t=this.viewModel.associationViewModels,e=this.selectedLayer?t.get(this.selectedLayer):null;return e?e.length:0}set currentFeaturePage(t){let{featuresPerPage:e,associatedFeatureCount:r}=this,a=Math.ceil(r/e)||1,l=Math.max(Math.min(t,a),1);this._set("currentFeaturePage",l)}get currentFeaturePage(){return this._get("currentFeaturePage")??1}get endIndex(){let{currentFeaturePage:t,featuresPerPage:e,maxFeatureCount:r}=this;return Math.min(t*e,r)}renderConnectivityIcon(t,e){let{tooltipReferenceMap:r}=this,a;switch(t){case"junction-edge-from-connectivity":a="connection-end-left";break;case"junction-edge-to-connectivity":a="connection-end-right";break;case"junction-edge-midspan-connectivity":a="connection-middle";break;default:a="connection-to-connection"}return s("calcite-icon",{afterCreate:l=>r.set(e,l),afterRemoved:()=>r.delete(e),icon:a,scale:"s",slot:"content-start"})}renderFeatureCountWarning(){let{associatedFeatureCount:t,maxFeatureCount:e,messagesFeature:r}=this;return t>e?s("calcite-notice",{class:this._isFeatureCountNoticeOpen?u.limitNoticeContainer:void 0,closable:!0,icon:"information",kind:"info",open:!0,scale:"s",width:"full",onCalciteNoticeBeforeOpen:()=>this._isFeatureCountNoticeOpen=!0,onCalciteNoticeClose:()=>this._isFeatureCountNoticeOpen=!1},s("div",{slot:"title"},r.associationsLimitNoticeTitle),s("div",{slot:"message"},g(r.associationsLimitNoticeMessage,{number:e}))):null}renderFeatureObserver(){return s("div",{afterCreate:this._onObserverCreate,bind:this,class:u.featureObserver,key:"feature-observer"})}renderFilter(){return s("div",{class:u.filterContainer,key:"filter"},s("calcite-input",{icon:"search",placeholder:this.messagesFeature.associationFilterPlaceholder,type:"search",onCalciteInputInput:t=>{this.filterText=t.currentTarget.value.trim().toLowerCase(),this.currentFeaturePage=1}}))}renderLoading(){return s("div",{class:u.loadingContainer,key:"loading-container"},this.renderLoadingIcon())}renderLoadingIcon(){return s("calcite-loader",{inline:!0,label:this.messagesCommon.loading})}getConnectivityTooltip(t){let{messagesFeature:e}=this;switch(t){case"connectivity":case"junction-junction-connectivity":return e.associationsJunctionJunction;case"junction-edge-from-connectivity":return e.associationsJunctionEdgeFrom;case"junction-edge-midspan-connectivity":return e.associationsJunctionEdgeMidspan;case"junction-edge-to-connectivity":return e.associationsJunctionEdgeTo;default:return""}}setUpObserver(){this.addHandles(y(()=>this._observerNode,()=>this._onObserverChange()))}_increaseFeaturePage(){this.currentFeaturePage++}_onObserverChange(){return m(this,null,function*(){this._observerNode&&this._observer.unobserve(this._observerNode);let{state:t,showAllEnabled:e}=this.viewModel;this._observerNode&&t==="ready"&&e&&this._observer.observe(this._observerNode)})}_onObserverCreate(t){this._observerNode=t}};i([n()],o.prototype,"_observer",void 0),i([n()],o.prototype,"_observerNode",void 0),i([n()],o.prototype,"associatedFeatureCount",null),i([n()],o.prototype,"currentFeaturePage",null),i([n()],o.prototype,"endIndex",null),i([n()],o.prototype,"featuresPerPage",void 0),i([n()],o.prototype,"filterText",void 0),i([n()],o.prototype,"headingLevel",void 0),i([n()],o.prototype,"maxFeatureCount",void 0),i([n(),d("esri/widgets/Feature/t9n/Feature")],o.prototype,"messagesFeature",void 0),i([n(),d("esri/t9n/common")],o.prototype,"messagesCommon",void 0),i([n()],o.prototype,"selectedLayer",void 0),i([n()],o.prototype,"tooltipReferenceMap",void 0),i([n({type:p})],o.prototype,"viewModel",void 0),o=i([v("esri.widgets.support.UtilityNetworkAssociations.UtilityNetworkAssociationList")],o);var E=o;function H(t){let{percentAlong:e}=t;return e==null?"":h(e,{style:"percent",maximumFractionDigits:2})}function W(t){let{associationType:e}=t;return e==="connectivity"||e==="junction-junction-connectivity"||e==="junction-edge-from-connectivity"||e==="junction-edge-midspan-connectivity"||e==="junction-edge-to-connectivity"}function G(t){return t.associationType==="junction-edge-midspan-connectivity"}export{E as a,H as b,W as c,G as d};
