import{c as U,h as G}from"./chunk-FNXQZPHT.js";import{b as q,i as d,r as f,s as B,t as J}from"./chunk-HHDFN2GK.js";import{a as V}from"./chunk-VTHXE323.js";function We(e,t){for(let r of e.values())if(t(r))return!0;return!1}function Xe(e,t){for(let r of e.values())if(t(r))return r;return null}function K(e,t,r){let n=e.get(t);if(n!==void 0)return n;let o=r();return e.set(t,o),o}function Ye(e){let t=new Map;return r=>(t.has(r)||t.set(r,e(r)),t.get(r))}var m=()=>f.getLogger("esri.core.accessorSupport.ensureTypes");function de(e){return e==null?e:new Date(e)}function me(e){return e==null?e:!!e}function ge(e){return e==null?e:e.toString()}function be(e,t=0){return e==null?e:(e=parseFloat(e),isNaN(e)?t:e)}function he(e){return e==null?e:Math.round(parseFloat(e))}function we(e){return null}function tt(e,t){return r=>{let n=e(r);return t.step!=null&&(n=Math.round(n/t.step)*t.step),t.min!=null&&(n=Math.max(t.min,n)),t.max!=null&&(n=Math.min(t.max,n)),n}}function X(e){return e?.constructor&&e.constructor.__accessorMetadata__!==void 0}function _(e,t){return t!=null&&e&&!(t instanceof e)}function Y(e){return e&&"isCollection"in e}function W(e){return e?.Type?typeof e.Type=="function"?e.Type:e.Type.base:null}function ve(e,t){if(!t?.constructor||!Y(t.constructor))return N(e,t)?t:new e(t);let r=W(e.prototype.itemType),n=W(t.constructor.prototype.itemType);return r?n?r===n?t:r.prototype.isPrototypeOf(n.prototype)?new e(t):(N(e,t),t):new e(t):t}function N(e,t){return!!X(t)&&(m().error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+O(e)+"'"),!0)}function Ae(e,t){return t==null?t:Y(e)?ve(e,t):_(e,t)?N(e,t)?t:new e(t):t}function O(e){return e?.prototype?.declaredClass||"unknown"}var _e=new WeakMap;function je(e){switch(e){case Number:return t=>be(t);case h:return he;case Boolean:return me;case String:return ge;case Date:return de;case w:return we;default:return K(_e,e,()=>Ae.bind(null,e))}}function g(e,t){let r=je(e);return arguments.length===1?r:r(t)}function j(e,t,r){return arguments.length===1?j.bind(null,e):t&&(Array.isArray(t)?t.map(n=>e(n,r)):[e(t,r)])}function rt(e,t){return arguments.length===1?j(r=>g(e,r)):j(r=>g(e,r),t)}function Z(e,t,r){return t!==0&&Array.isArray(r)?r.map(n=>Z(e,t-1,n)):e(r)}function C(e,t,r){if(arguments.length===2)return s=>C(e,t,s);if(!r)return r;r=Z(e,t,r);let n=t,o=r;for(;n>0&&Array.isArray(o);)n--,o=o[0];if(o!==void 0)for(let s=0;s<n;s++)r=[r];return r}function nt(e,t,r){return arguments.length===2?C(n=>g(e,n),t):C(n=>g(e,n),t,r)}function H(e){return!!Array.isArray(e)&&!e.some(t=>{let r=typeof t;return!(r==="string"||r==="number"||r==="function"&&e.length>1)})}function Oe(e,t){if(arguments.length===2)return Oe(e).call(null,t);let r=new Set,n=e.filter(i=>typeof i!="function"),o=e.filter(i=>typeof i=="function");for(let i of e)typeof i!="string"&&typeof i!="number"||r.add(i);let s=null,u=null;return(i,a)=>{if(i==null)return i;let c=typeof i,p=c==="string"||c==="number";return p&&(r.has(i)||o.some(l=>c==="string"&&l===String||c==="number"&&l===Number))||c==="object"&&o.some(l=>!_(i,l))?i:(p&&n.length?(s||(s=n.map(l=>typeof l=="string"?`'${l}'`:`${l}`).join(", ")),m().error("Accessor#set",`'${i}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof i=="object"&&o.length?(u||(u=o.map(l=>O(l)).join(", ")),m().error("Accessor#set",`'${i}' is not a valid value for this property, value must be one of ${u}`)):m().error("Accessor#set",`'${i}' is not a valid value for this property`),a&&(a.valid=!1),null)}}function Se(e,t){if(arguments.length===2)return Se(e).call(null,t);let r={},n=[],o=[];for(let a in e.typeMap){let c=e.typeMap[a];r[a]=g(c),n.push(O(c)),o.push(a)}let s=()=>`'${n.join("', '")}'`,u=()=>`'${o.join("', '")}'`,i=typeof e.key=="string"?a=>a[e.key]:e.key;return a=>{if(e.base&&!_(e.base,a)||a==null)return a;let c=i(a)||e.defaultKeyValue,p=r[c];if(!p)return m().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${u()})`),null;if(!_(e.typeMap[c],a))return a;if(typeof e.key=="string"&&!X(a)){let l={};for(let y in a)y!==e.key&&(l[y]=a[y]);return p(l)}return p(a)}}var h=class{},w=class{},ot={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function st(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function Te(e){switch(e.type){case"native":return g(e.value);case"array":return j(Te(e.value));case"one-of":return Me(e);default:return null}}function Me(e){let t=null;return(r,n)=>x(r,e)?r:(t==null&&(t=P(e)),m().error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),n&&(n.valid=!1),null)}function P(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case h:return"integer";case Date:return"date";case w:return"null";default:return O(e.value)}case"array":return`array of ${P(e.value)}`;case"one-of":{let t=e.values.map(r=>P(r));return`one of ${t.slice(0,-1)} or ${t[t.length-1]}`}}return"unknown"}function x(e,t){if(e==null)return!0;switch(t.type){case"native":switch(t.value){case Number:case h:return typeof e=="number";case Boolean:return typeof e=="boolean";case String:return typeof e=="string";case w:return e===null}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some(r=>!x(r,t.value));case"one-of":return t.values.some(r=>x(e,r))}}var v=class extends B{constructor(t,r,n){super(t,r,n)}};v.prototype.type="warning";var Q=Symbol("Accessor-beforeDestroy");var S;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED",e[e.DESTROYED=3]="DESTROYED"})(S||(S={}));function b(e){let t=e.constructor.__accessorMetadata__,r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){t=Object.create(t);for(let n in t)t[n]=q(t[n]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function yt(e,t){let r=b(e),n=r[t];return n||(n=r[t]={}),n}function dt(e,t){return U(e,t,Ce)}var Ne=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Ce(e){return Ne.test(e)?"replace":"merge"}function ee(e){if(e.json&&e.json.origins){let t=e.json.origins,r={"web-document":["web-scene","web-map"]};for(let n in r)if(t[n]){let o=t[n];r[n].forEach(s=>{t[s]=o}),delete t[n]}}}function T(e){return!!e&&e.prototype?.declaredClass&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}var $=()=>f.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function k(e,t,r){e&&(!r&&!t.read||t.read?.reader||t.read?.enabled===!1||ke(e)&&d("read.reader",Pe(e),t))}function Pe(e){let t=e.ndimArray??0;if(t>1)return $e(e);if(t===1)return te(e);if("type"in e&&ne(e.type)){let r=e.type.prototype?.itemType?.Type,n=te(typeof r=="function"?{type:r}:{types:r});return(o,s,u)=>{let i=n(o,s,u);return i&&new e.type(i)}}return D(e)}function D(e){return"type"in e?xe(e.type):De(e.types)}function xe(e){return e.prototype.read?(t,r,n)=>{if(t==null)return t;let o=typeof t;if(o!=="object")return void $().error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${o}'`);let s=new e;return s.read(t,n),s}:e.fromJSON}function re(e,t,r,n){return n!==0&&Array.isArray(t)?t.map(o=>re(e,o,r,n-1)):e(t,void 0,r)}function $e(e){let t=D(e),r=re.bind(null,t),n=e.ndimArray??0;return(o,s,u)=>{if(o==null)return o;o=r(o,u,n);let i=n,a=o;for(;i>0&&Array.isArray(a);)i--,a=a[0];if(a!==void 0)for(let c=0;c<i;c++)o=[o];return o}}function te(e){let t=D(e);return(r,n,o)=>{if(r==null)return r;if(Array.isArray(r)){let u=[];for(let i of r){let a=t(i,void 0,o);a!==void 0&&u.push(a)}return u}let s=t(r,void 0,o);return s!==void 0?[s]:void 0}}function ne(e){if(!T(e))return!1;let t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?z(t.Type):oe(t.Type))}function ke(e){return"types"in e?oe(e.types):z(e.type)}function z(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||ne(e))}function oe(e){for(let t in e.typeMap)if(!z(e.typeMap[t]))return!1;return!0}function De(e){let t=null,r=e.errorContext??"type",n=e.validate;return(o,s,u)=>{if(o==null)return o;let i=typeof o;if(i!=="object")return void $().error(`Expected JSON value of type 'object' to deserialize, but got '${i}'`);t||(t=ze(e));let a=e.key;if(typeof a!="string")return;let c=o[a],p=c?t[c]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!p){let y=`Type '${c||"unknown"}' is not supported`;return u?.messages&&o&&u.messages.push(new v(`${r}:unsupported`,y,{definition:o,context:u})),void $().error(y)}let l=new p;return l.read(o,u),n?n(l):l}}function ze(e){let t={};for(let r in e.typeMap){let n=e.typeMap[r],o=b(n.prototype);if(typeof e.key=="function")continue;let s=o[e.key];if(!s)continue;if(s.json?.type&&Array.isArray(s.json.type)&&s.json.type.length===1&&typeof s.json.type[0]=="string"){t[s.json.type[0]]=n;continue}let u=s.json?.write;if(!u?.writer){t[r]=n;continue}let i=u.target,a=typeof i=="string"?i:e.key,c={};u.writer(r,c,a),c[a]&&(t[c[a]]=n)}return t}function ue(e){if(e.json||(e.json={}),ie(e.json),ae(e.json),se(e.json),e.json.origins)for(let t in e.json.origins)ie(e.json.origins[t]),ae(e.json.origins[t]),se(e.json.origins[t]);return!0}function se(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function ie(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function ae(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function L(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;let r=e?.ndimArray??0;e&&(r===1||"type"in e&&T(e.type))?t.write.writer=Fe:r>1?t.write.writer=Re(r):t.types?Array.isArray(t.types)?t.write.writer=Ee(t.types[0]):t.write.writer=Le(t.types):t.write.writer=A}function Le(e){return(t,r,n,o)=>t?ce(t,e,o)?A(t,r,n,o):void 0:A(t,r,n,o)}function ce(e,t,r){for(let n in t.typeMap)if(e instanceof t.typeMap[n])return!0;if(r?.messages){let n=t.errorContext??"type",o=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&e&&r.messages.push(new J(`${n}:unsupported`,o,{definition:e,context:r})),f.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(o)}return!1}function Ee(e){return(t,r,n,o)=>!t||!Array.isArray(t)?A(t,r,n,o):A(t.filter(s=>ce(s,e,o)),r,n,o)}function A(e,t,r,n){d(r,M(e,n),t)}function M(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?Ie(e):e}function Ie(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function Fe(e,t,r,n){let o;e===null?o=null:e&&typeof e.map=="function"?(o=e.map(s=>M(s,n)),typeof o.toArray=="function"&&(o=o.toArray())):o=[M(e,n)],d(r,o,t)}function le(e,t,r){return r!==0&&Array.isArray(e)?e.map(n=>le(n,t,r-1)):M(e,t)}function Re(e){return(t,r,n,o)=>{let s;if(t===null)s=null;else{s=le(t,o,e);let u=e,i=s;for(;u>0&&Array.isArray(i);)u--,i=i[0];if(i!==void 0)for(let a=0;a<u;a++)s=[s]}d(n,s,r)}}function zt(e,t){return I(e,"any",t?.origin)}function Lt(e,t){return I(e,"read",t?.origin)}function Et(e,t){return I(e,"write",t?.origin)}function I(e,t,r){let n=e?.json;if(n?.origins&&r){let o;o=r==="link-chart"?n.origins[r]&&(t==="any"||t in n.origins[r])?n.origins[r]:n.origins["web-map"]:n.origins[r],o&&(t==="any"||t in o)&&(n=o)}return n}function Ve(e){let t=qe(e);if(e.json.origins)for(let r in e.json.origins){let n=e.json.origins[r],o=n.types?Ue(n):t;k(o,n,!1),n.types&&!n.write&&e.json.write?.enabled&&(n.write=V({},e.json.write)),L(o,n)}k(t,e.json,!0),L(t,e.json)}function qe(e){return e.json.types?E(e.json):e.type?pe(e):E(e)}function Ue(e){return e.type?pe(e):E(e)}function pe(e){if(!e.type)return;let t=0,r=e.type;for(;Array.isArray(r)&&!H(r);)r=r[0],t++;return{type:r,ndimArray:t}}function E(e){if(!e.types)return;let t=0,r=e.types;for(;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}function fe(e){ue(e)&&(ee(e),Ve(e))}var F=new Set,R=new Set;function Kt(e){return t=>{e??="esri.core.Accessor",t.prototype.declaredClass=e,Je(t);let r=[],n=[],o=t.prototype;for(;o;)o.hasOwnProperty("initialize")&&!F.has(o.initialize)&&(F.add(o.initialize),r.push(o.initialize)),o.hasOwnProperty("destroy")&&!R.has(o.destroy)&&(R.add(o.destroy),n.push(o.destroy)),o=Object.getPrototypeOf(o);F.clear(),R.clear();let s=class extends t{constructor(...i){if(super(...i),this.constructor===s&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let a=r.length-1;a>=0;a--)r[a].call(this)}}),n.length){let a=!1,c=this[Q];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!a){a=!0,c.call(this);for(let p=0;p<n.length;p++)n[p].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};s.__accessorMetadata__=b(t.prototype),s.prototype.declaredClass=e;let u=(e||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:u,configurable:!0}),s}}function Be(e,t){return t.get==null?function(){let r=this.__accessor__,n=r.propertiesByName.get(e);if(n===void 0)return;r.mutable&&G(n);let o=r.store;return o.has(e)?o.get(e):n.metadata.value}:function(){let r=this.__accessor__,n=r.propertiesByName.get(e);if(n!==void 0)return n.getComputed(r)}}function Je(e){let t=e.prototype,r=b(t),n={};for(let o of Object.getOwnPropertyNames(r)){let s=r[o];fe(s),n[o]={enumerable:!0,configurable:!0,get:Be(o,s),set(u){let i=this.__accessor__;if(i!==void 0){if(i.mutable)return i.initialized&&s.readOnly?ye("read-only",o):i.lifecycle===S.CONSTRUCTED&&s.constructOnly?ye("construct-only",o):void i.set(o,u)}else Object.defineProperty(this,o,{enumerable:!0,configurable:!0,writable:!0,value:u})}}}Object.defineProperties(e.prototype,n)}var ye=(e,t)=>{f.getLogger("esri.core.Accessor").error(`cannot assign to ${e} property '${t}'`)};function Ge(e){return e?.release&&typeof e.release=="function"}function Ke(e){return e?.acquire&&typeof e.acquire=="function"}var Yt=(()=>{class e{constructor(r,n,o,s=1,u=0){this._ctor=r,this._acquireFunction=n,this._releaseFunction=o,this.allocationSize=s,this._pool=new Array(u),this._initialSize=u;for(let i=0;i<u;i++)this._pool[i]=new this._ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...r){let n;if(e.test.disabled)n=new this._ctor;else{if(this._pool.length===0){let o=this.allocationSize;for(let s=0;s<o;s++)this._pool[s]=new this._ctor}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...r):Ke(n)&&n.acquire(...r),n}release(r){r&&!e.test.disabled&&(this._releaseFunction?this._releaseFunction(r):Ge(r)&&r.release(),this._pool.push(r))}prune(r=this._initialSize){if(!(r>=this._pool.length)){for(let n=r;n<this._pool.length;++n){let o=this._pool[n];this._dispose(o)}this._pool.length=r}}_dispose(r){r.dispose&&typeof r.dispose=="function"&&r.dispose()}}return e.test={disabled:!1},e})();export{We as a,Xe as b,K as c,Ye as d,ge as e,be as f,he as g,tt as h,Ae as i,g as j,j as k,rt as l,C as m,nt as n,H as o,Oe as p,Se as q,h as r,w as s,ot as t,st as u,Te as v,b as w,yt as x,dt as y,Q as z,S as A,v as B,Pe as C,Ie as D,zt as E,Lt as F,Et as G,Kt as H,Yt as I};
