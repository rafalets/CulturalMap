import{F as y}from"./chunk-E57FTRWF.js";import{T as w,w as f}from"./chunk-U4J5SECU.js";import{t as g}from"./chunk-HHDFN2GK.js";import{f as m}from"./chunk-VTHXE323.js";function O(r){return m(this,arguments,function*(e,t={},s){yield e.load(s);let o=f(e.itemUrl,"resources"),{start:h=1,num:a=10,sortOrder:d="asc",sortField:i="resource"}=t,l={query:{start:h,num:a,sortOrder:d,sortField:i,token:e.apiKey},signal:s?.signal},u=yield e.portal.request(o,l);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map(({created:n,size:p,resource:c})=>({created:new Date(n),size:p,resource:e.resourceFromPath(c)}))}})}function j(e,t,s,r){return m(this,null,function*(){let o=new Map;for(let{resource:a,content:d,compress:i,access:l}of t){if(!a.hasPath())throw new g(`portal-item-resource-${s}:invalid-path`,"Resource does not have a valid path");let[u,n]=v(a.path),p=`${u}/${i??""}/${l??""}`;o.has(p)||o.set(p,{prefix:u,compress:i,access:l,files:[]}),o.get(p).files.push({fileName:n,content:d})}yield e.load(r);let h=f(e.userItemUrl,s==="add"?"addResources":"updateResources");for(let{prefix:a,compress:d,access:i,files:l}of o.values())for(let n=0;n<l.length;n+=25){let p=l.slice(n,n+25),c=new FormData;a&&a!=="."&&c.append("resourcesPrefix",a),d&&c.append("compress","true"),i&&c.append("access",i);let x=0;for(let{fileName:P,content:R}of p)c.append("file"+ ++x,R,P);c.append("f","json"),yield e.portal.request(h,{method:"post",body:c,signal:r?.signal})}})}function U(e,t,s){return m(this,null,function*(){if(!t.hasPath())throw new g("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield e.load(s);let r=f(e.userItemUrl,"removeResources");yield e.portal.request(r,{method:"post",query:{resource:t.path},signal:s?.signal}),t.portalItem=null})}function $(e,t){return m(this,null,function*(){yield e.load(t);let s=f(e.userItemUrl,"removeResources");return e.portal.request(s,{method:"post",query:{deleteAll:!0},signal:t?.signal})})}function v(e){let t=e.lastIndexOf("/");return t===-1?[".",e]:[e.slice(0,t),e.slice(t+1)]}function b(e){let[t,s]=I(e),[r,o]=v(t);return[r,o,s]}function I(e){let t=w(e);return t==null?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}function T(e){return m(this,null,function*(){return e.type==="blob"?e.blob:e.type==="json"?new Blob([e.jsonString],{type:"application/json"}):(yield y(e.url,{responseType:"blob"})).data})}function A(e,t){if(!e.hasPath())return null;let[s,,r]=b(e.path);return e.portalItem.resourceFromPath(f(s,t+r))}function N(e,t){if(!e.hasPath())return null;let[s,,r]=b(e.path);return e.portalItem.resourceFromPath(f(s,t+r))}export{O as a,j as b,U as c,$ as d,b as e,T as f,A as g,N as h};
