import"./chunk-SVIEBWY2.js";import"./chunk-SXLLP2EB.js";import"./chunk-VKQKBWR3.js";import"./chunk-7XHQITWF.js";import"./chunk-7ZPU2HVF.js";import"./chunk-KWSVCB3L.js";import{a as $}from"./chunk-754MWGK6.js";import"./chunk-2HLOAXOJ.js";import"./chunk-PHJ2BR5I.js";import{k as J}from"./chunk-H5BX7RHK.js";import"./chunk-WKIOZMV7.js";import"./chunk-T7VFCF5X.js";import{c as k,e as U,f as V,h as G}from"./chunk-I3G52OPK.js";import{c as W,d as j}from"./chunk-VMBBQVLC.js";import"./chunk-BIFR653L.js";import"./chunk-4N7OCQ2R.js";import"./chunk-NXYNQWQ5.js";import"./chunk-ELVOQBPG.js";import{a as H}from"./chunk-YVDLD2EM.js";import{a as N,b as q}from"./chunk-L4GZWTJN.js";import{d as A}from"./chunk-75EJGBQJ.js";import"./chunk-56KMXCVV.js";import"./chunk-CVFBLTSJ.js";import{b as _}from"./chunk-DBAXA5UM.js";import{a as R}from"./chunk-GRQYTZK7.js";import"./chunk-B6W2MRH5.js";import"./chunk-7FZF7T7C.js";import"./chunk-KFL5M7F3.js";import{F,d as E,e as v,i as y,t as f,u as L,v as S,z as M}from"./chunk-5RWLLGQU.js";import{f as p}from"./chunk-VTHXE323.js";var ee={offset:"offset"},te=60;function w(t){return t.replace(":15",".25").replace(":30",".5").replace(":45",".75").replace("\u2212","-")}function oe(t,o){let e=z(t,"en-US",o).replace("GMT","");return e===""?0:Number(w(e))*te}function ie(){return new Date().getTimezoneOffset()*-1}function se(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}function ae(t){return p(this,null,function*(){if(t==="offset")return e=>e;let{normalize:o}=yield import("./chunk-X7DDTJ6H.js");return o})}function ne(t,o,e,s,i){return p(this,null,function*(){if(e==="name"){let{groupByName:n}=yield import("./chunk-TRM3EHPO.js");return(yield n()).map(({label:l})=>({label:l,value:l,metadata:{filterValue:l}})).filter(l=>!!l).sort()}let r=i==="user"?t:i==="utc"?"fr":"en-GB",h=s.getTime();if(e==="region"){let[{groupByRegion:n},{getCountry:l,global:c}]=yield Promise.all([import("./chunk-JDITLKU7.js"),import("./chunk-GRMJYXXZ.js")]);return(yield n()).map(({label:a,tzs:d})=>(d.sort((m,u)=>{let Z=T(m,o),x=T(u,o),b="Etc/GMT";if(m.startsWith(b)&&u.startsWith(b)){let I=m.substring(b.length),D=u.substring(b.length),Y=I===""?0:parseInt(I);return(D===""?0:parseInt(D))-Y}return Z.localeCompare(x)}),{label:O(o,a),items:d.map(m=>{let u=w(z(m,r,h)),Z=T(m,o),x=a===c?`${T(c,o)} Etc`:K(m),b=l(m),I=O(o,b);return{label:Z,value:m,metadata:{country:I===Z?void 0:I,filterValue:x,offset:u}}})})).sort((a,d)=>a.label===c?-1:d.label===c?1:a.label.localeCompare(d.label))}let[{groupByOffset:g},{DateEngine:C}]=yield Promise.all([import("./chunk-XN7WCHXZ.js"),import("./chunk-5LZTOWKO.js")]),B=yield g({dateEngine:new C,groupDateRange:1,startDate:new Date(h).toISOString()}),X=new Intl.ListFormat(t,{style:"long",type:"conjunction"}),P=["Factory","Etc/UTC"];return B.forEach(n=>{let l=[],c=0;n.tzs.forEach((a,d)=>{P.includes(a)&&c++,l[d]=c}),n.tzs=n.tzs.filter(a=>!P.includes(a)),n.labelTzIdx=n.labelTzIdx.map(a=>a-l[a]).filter(a=>a>=0&&a<n.tzs.length)}),B.map(({labelTzIdx:n,tzs:l})=>{let c=l[0],a=w(z(c,r,h)),d=oe(c,h),m=n.map(u=>T(l[u],o));return{label:me(o,a,X.format(m)),value:d,metadata:{filterValue:l.map(u=>K(u))}}}).filter(n=>!!n).sort((n,l)=>n.value-l.value)})}function T(t,o){return o[t]||re(t)}function le(t,o,e){return e.timeZoneRegionLabel.replace("{city}",t).replace("{country}",O(e,o))}function O(t,o){return t[o]||o}function re(t){return t.split("/").pop()}function K(t){return t.replace(/_/g," ")}function me(t,o,e){return t.timeZoneLabel.replace("{offset}",o).replace("{cities}",e)}function z(t,o,e=Date.now()){return t==="Factory"&&(t="Etc/GMT"),J(o,{timeZone:t,timeZoneName:"shortOffset"}).formatToParts(e).find(({type:s})=>s==="timeZoneName").value}function ce(t){return t.items!==void 0}function he(t){return ce(t[0])?t.flatMap(o=>o.items):t}function Q(t,o,e){return e==null?null:he(t).find(s=>s[o]==e)}var de=E`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}.offset{white-space:nowrap}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}`,ue=(()=>{class t extends L{constructor(){super(...arguments),this.clearable=!1,this.disabled=!1,this.maxItems=0,this.messages=R({blocking:!0}),this.mode="offset",this.offsetStyle="user",this.open=!1,this.overlayPositioning="absolute",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputTimeZoneBeforeClose=f({cancelable:!1}),this.calciteInputTimeZoneBeforeOpen=f({cancelable:!1}),this.calciteInputTimeZoneChange=f({cancelable:!1}),this.calciteInputTimeZoneClose=f({cancelable:!1}),this.calciteInputTimeZoneOpen=f({cancelable:!1})}static{this.properties={clearable:7,disabled:7,form:3,maxItems:11,messageOverrides:0,mode:3,name:3,offsetStyle:3,open:7,overlayPositioning:3,readOnly:7,referenceDate:1,required:7,scale:3,status:3,validationIcon:[3,{converter:M}],validationMessage:1,validity:0,value:1}}static{this.shadowRootOptions={mode:"open",delegatesFocus:!0}}static{this.styles=de}get value(){return this._value}set value(e){this._value=e}setFocus(){return p(this,null,function*(){yield A(this),yield this.comboboxEl.setFocus()})}connectedCallback(){super.connectedCallback(),k(this),W(this)}load(){return p(this,null,function*(){this.normalizer=yield ae(this.mode),yield this.updateTimeZoneItems();let e=this.value,s=this.normalizeValue(e);this.value=s||(e===""?s:void 0),this.updateTimeZoneSelection();let i=this.selectedTimeZoneItem?`${this.selectedTimeZoneItem.value}`:"";V(this,i),this.value=i})}willUpdate(e){e.has("value")&&this.hasUpdated&&this.handleValueChange(this.value,e.get("value")),(e.has("messages")||e.has("mode")&&(this.hasUpdated||this.mode!=="offset")||e.has("referenceDate"))&&this.handleTimeZoneItemPropsChange(),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openChanged()}updated(){N(this)}loaded(){this.overrideSelectedLabelForRegion(this.open),this.openChanged()}disconnectedCallback(){super.disconnectedCallback(),U(this),j(this)}handleTimeZoneItemPropsChange(){return p(this,null,function*(){!this.timeZoneItems||!this.hasUpdated||(yield this.updateTimeZoneItems(),this.updateTimeZoneSelection())})}openChanged(){this.comboboxEl&&(this.comboboxEl.open=this.open)}handleValueChange(e,s){return p(this,null,function*(){let i=this.normalizeValue(e);if(!i){if(this.clearable){this._value=i,this.selectedTimeZoneItem=null;return}this._value=s,this.selectedTimeZoneItem=this.findTimeZoneItem(s);return}let r=this.findTimeZoneItem(i);if(!r){this._value=s;return}this._value=i,this.selectedTimeZoneItem=r,i!==e&&(yield this.updateComplete,this.overrideSelectedLabelForRegion(this.open))})}onLabelClick(){this.setFocus()}setComboboxRef(e){this.comboboxEl=e}overrideSelectedLabelForRegion(e){if(this.mode!=="region"||!this.selectedTimeZoneItem)return;let{label:s,metadata:i}=this.selectedTimeZoneItem;this.comboboxEl.selectedItems[0].textLabel=!i.country||e?s:le(s,i.country,this.messages)}onComboboxBeforeClose(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!1),this.calciteInputTimeZoneBeforeClose.emit()}onComboboxBeforeOpen(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!0),this.calciteInputTimeZoneBeforeOpen.emit()}onComboboxChange(e){e.stopPropagation();let s=e.target.selectedItems[0];if(!s){this._value="",this.selectedTimeZoneItem=null,this.calciteInputTimeZoneChange.emit();return}let i=this.findTimeZoneItemByLabel(s.getAttribute("data-label")),r=`${i.value}`;this.value===r&&i.label===this.selectedTimeZoneItem.label||(this._value=r,this.selectedTimeZoneItem=i,this.calciteInputTimeZoneChange.emit())}onComboboxClose(e){e.stopPropagation(),this.open=!1,this.calciteInputTimeZoneClose.emit()}onComboboxOpen(e){this.open=!0,e.stopPropagation(),this.calciteInputTimeZoneOpen.emit()}findTimeZoneItem(e){return Q(this.timeZoneItems,"value",e)}findTimeZoneItemByLabel(e){return Q(this.timeZoneItems,"label",e)}updateTimeZoneItems(){return p(this,null,function*(){this.timeZoneItems=yield this.createTimeZoneItems()})}updateTimeZoneSelection(){if(this.value===""&&this.clearable){this.selectedTimeZoneItem=null;return}let e=this.mode==="offset"?ie():se(),s=this.value===""||!this.value?e:this.value;this.selectedTimeZoneItem=this.findTimeZoneItem(s)||this.findTimeZoneItem(e)}createTimeZoneItems(){return p(this,null,function*(){return!this.messages._lang||!this.messages?[]:ne(this.messages._lang,this.messages,this.mode,this.referenceDate instanceof Date?this.referenceDate:new Date(this.referenceDate??Date.now()),this.offsetStyle)})}normalizeValue(e){return e=e===void 0?"":e,e&&this.normalizer(e)}render(){return q({disabled:this.disabled,children:v`<calcite-combobox .clearDisabled=${!this.clearable} .disabled=${this.disabled} .label=${this.messages.chooseTimeZone} lang=${this.messages._lang??y} .maxItems=${this.maxItems} @calciteComboboxBeforeClose=${this.onComboboxBeforeClose} @calciteComboboxBeforeOpen=${this.onComboboxBeforeOpen} @calciteComboboxChange=${this.onComboboxChange} @calciteComboboxClose=${this.onComboboxClose} @calciteComboboxOpen=${this.onComboboxOpen} .overlayPositioning=${this.overlayPositioning} .placeholder=${this.mode==="name"?this.messages.namePlaceholder:this.mode==="offset"?this.messages.offsetPlaceholder:this.messages.regionPlaceholder} placeholder-icon=search .readOnly=${this.readOnly} .scale=${this.scale} .selectionMode=${this.clearable?"single":"single-persist"} .status=${this.status} .validationIcon=${this.validationIcon} .validationMessage=${this.validationMessage} ${_(this.setComboboxRef)}>${this.renderItems()}</calcite-combobox>${G({component:this})}`})}renderItems(){return this.mode==="region"?this.renderRegionItems():$(this.timeZoneItems,({label:e})=>e,e=>{let s=this.selectedTimeZoneItem===e,{label:i,metadata:r,value:h}=e;return v`<calcite-combobox-item data-label=${i??y} .metadata=${r} .selected=${s} .textLabel=${i} .value=${h}></calcite-combobox-item>`})}renderRegionItems(){return this.timeZoneItems.flatMap(({label:e,items:s})=>H(e,v`<calcite-combobox-item-group .label=${e}>${$(s,({label:i})=>i,i=>{let r=this.selectedTimeZoneItem===i,{label:h,metadata:g,value:C}=i;return v`<calcite-combobox-item data-label=${h??y} .description=${g.country} .metadata=${g} .selected=${r} .textLabel=${h} .value=${C}><span class=${S(ee.offset)} slot=content-end>${g.offset}</span></calcite-combobox-item>`})}</calcite-combobox-item-group>`))}}return t})();F("calcite-input-time-zone",ue);export{ue as InputTimeZone};
