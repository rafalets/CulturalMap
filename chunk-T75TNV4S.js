import{a as c}from"./chunk-QR6GP2OF.js";import{a as b}from"./chunk-KWZIB4M6.js";import{a as m}from"./chunk-TVHRLNTK.js";import{b as y}from"./chunk-EKMHQEJY.js";import{d}from"./chunk-C7INQGWT.js";import{H as p}from"./chunk-WMHJC7XF.js";import{K as u}from"./chunk-D2LVMNOU.js";import{a as n}from"./chunk-QGVBCWUY.js";import{r as l}from"./chunk-HHDFN2GK.js";function x(i){return new c({getCollections:()=>[i.tables,i.layers],getChildrenFunction:s=>{let e=[];return"tables"in s&&e.push(s.tables),"layers"in s&&e.push(s.layers),e},itemFilterFunction:s=>{let e=s.parent;return!!e&&"tables"in e&&e.tables.includes(s)}})}function L(i){for(let s of i.values())s?.destroy();i.clear()}function f(i,s,e){let r,o;if(i)for(let a=0,t=i.length;a<t;a++){if(r=i.at(a),r?.[s]===e)return r;if(r?.type==="group"&&(o=f(r.layers,s,e),o))return o}}var H=i=>{let s=class extends i{constructor(...e){super(...e),this.layers=new y;let r=t=>{t.parent&&"remove"in t.parent&&t.parent.remove(t)},o=t=>{t.parent=this,this.layerAdded(t),t.type!=="elevation"&&t.type!=="base-elevation"||l.getLogger(this).error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as an operational layer and will therefore be ignored.`)},a=t=>{t.parent=null,this.layerRemoved(t)};this.addHandles([this.layers.on("before-add",t=>{if(t.item===this)return t.preventDefault(),void l.getLogger(this).error("#add()","Cannot add layer to itself.");r(t.item)}),this.layers.on("after-add",t=>o(t.item)),this.layers.on("after-remove",t=>a(t.item))])}destroy(){let e=this.layers.toArray();for(let r of e)r.destroy();this.layers.destroy()}set layers(e){this._set("layers",m(e,this._get("layers")))}add(e,r){let o=this.layers;if(r=o.getNextIndex(r),e instanceof b){let a=e;a.parent===this?this.reorder(a,r):o.add(a,r)}else u(e)?e.then(a=>{this.destroyed||this.add(a,r)}):l.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(e,r){let o=this.layers,a=o.getNextIndex(r);e.slice().forEach(t=>{t.parent!==this?(o.add(t,a),a+=1):this.reorder(t,a)})}findLayerById(e){return f(this.layers,"id",e)}findLayerByUid(e){return f(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,r){return this.layers.reorder(e,r)}layerAdded(e){}layerRemoved(e){}};return n([d()],s.prototype,"layers",null),s=n([p("esri.support.LayersMixin")],s),s};var g=new Set(["feature","subtype-group"]);function h(i,s,e){if(i)for(let r=0,o=i.length;r<o;r++){let a=i.at(r);if(a[s]===e)return a;if(a?.type==="group"){let t=h(a.tables,s,e);if(t)return t}}}var G=i=>{let s=class extends i{constructor(...e){super(...e),this.tables=new y,this.addHandles([this.tables.on("after-add",r=>{let o=r.item;o.parent&&o.parent!==this&&"tables"in o.parent&&o.parent.tables.remove(o),o.parent=this,g.has(o.type)||l.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})])}destroy(){let e=this.tables.toArray();for(let r of e)r.destroy();this.tables.destroy()}set tables(e){this._set("tables",m(e,this._get("tables")))}findTableById(e){return h(this.tables,"id",e)}findTableByUid(e){return h(this.tables,"uid",e)}};return n([d()],s.prototype,"tables",null),s=n([p("esri.support.TablesMixin")],s),s};export{x as a,L as b,H as c,G as d};
