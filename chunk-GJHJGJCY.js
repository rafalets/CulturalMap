import{a as E}from"./chunk-YHWE4TIZ.js";import{a as T,b as d}from"./chunk-QSMPW36A.js";import{a as $,b as g,c as j,d as w,e as A}from"./chunk-3HCMTURP.js";import{f as h}from"./chunk-VT67LWCR.js";import{k as c,l as S,y as I}from"./chunk-JR22Z7I2.js";import{c as N}from"./chunk-AZS4Q4RE.js";import{h as b}from"./chunk-E57FTRWF.js";import{K as p,h as f}from"./chunk-U4J5SECU.js";import{t as u}from"./chunk-HHDFN2GK.js";import{f as F}from"./chunk-VTHXE323.js";function Z(t,e,l){let o=t.name;return o==null?Promise.reject(new u("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?G(o,e,l):$(t,e,l).then(a=>C(a,o,e,j,l))}function x(t,e){return e.items.find(l=>l.name===t)}function C(t,e,l,o,a){return F(this,null,function*(){let m=l?.portal!=null?l.portal:N.getDefault(),n={portal:m,url:f(t.baseUrl),origin:"portal-item"},s=x(e,t.data);if(!s)throw new u("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});let U=a?.acceptedFormats??E,D=o(s,U);if(!D)throw new u("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${U})`,{symbolName:e});let{url:P,format:J}=D,i=b(P,n),y=s.thumbnail?.href??null,O=s.thumbnail?.imageData;T()&&(i=d(i)??"",y=d(y));let M={portal:m,url:f(p(i)),origin:"portal-item"};return w(i,a).then(v=>{let k=J==="cim"?g(v.data):v.data,r=h(k,M);if(r&&I(r)){if(y){let q=b(y,n);r.thumbnail=new S({url:q})}else O&&(r.thumbnail=new S({url:`data:image/png;base64,${O}`}));t.styleUrl?r.styleOrigin=new c({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(r.styleOrigin=new c({portal:l.portal,styleName:t.styleName,name:e}))}return r})})}function G(t,e,l){let o=A.replaceAll(/\{SymbolName\}/gi,t),a=e.portal!=null?e.portal:N.getDefault();return w(o,l).then(m=>{let n=g(m.data);return h(n,{portal:a,url:f(p(o)),origin:"portal-item"})})}export{Z as a,x as b,C as c};
