import{a as z,d as $}from"./chunk-X5AA4JDN.js";import{a as J,d as R,h as H}from"./chunk-J372WZPB.js";import{a as Le,b as se,c as Re}from"./chunk-6XFS4U2F.js";import{u as vr}from"./chunk-VOFKUGRY.js";import{a as hr,c as Ir,d as L}from"./chunk-7IPIJKWU.js";import{l as pr,m as dr}from"./chunk-HHDFN2GK.js";import{a as Ge}from"./chunk-47GHT6OF.js";import{a as fr,b as mr}from"./chunk-VTHXE323.js";var f;(function(i){i.InvalidFunctionParameters="InvalidFunctionParameters",i.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",i.UnsupportedSqlFunction="UnsupportedSqlFunction",i.UnsupportedOperator="UnsupportedOperator",i.UnsupportedSyntax="UnsupportedSyntax",i.UnsupportedIsRhs="UnsupportedIsRhs",i.UnsupportedIsLhs="UnsupportedIsLhs",i.InvalidDataType="InvalidDataType",i.CannotCastValue="CannotCastValue",i.FunctionNotRecognized="FunctionNotRecognized",i.InvalidTime="InvalidTime",i.InvalidParameterCount="InvalidParameterCount",i.InvalidTimeStamp="InvalidTimeStamp",i.InvalidDate="InvalidDate",i.InvalidOperator="InvalidOperator",i.IllegalInterval="IllegalInterval",i.YearMonthIntervals="YearMonthIntervals",i.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",i.MissingStatisticParameters="MissingStatisticParameters"})(f||(f={}));var rl={[f.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[f.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[f.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[f.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[f.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[f.UnsupportedOperator]:"Unsupported operator - {operator}",[f.UnsupportedSyntax]:"Unsupported syntax - {node}",[f.UnsupportedSqlFunction]:"Sql function not found = {function}",[f.InvalidDataType]:"Invalid sql data type",[f.InvalidDate]:"Invalid date encountered",[f.InvalidOperator]:"Invalid operator encountered",[f.InvalidTime]:"Invalid time encountered",[f.IllegalInterval]:"Illegal interval",[f.FunctionNotRecognized]:"Function not recognized",[f.InvalidTimeStamp]:"Invalid timestamp encountered",[f.InvalidParameterCount]:"Invalid parameter count for call to {name}",[f.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[f.YearMonthIntervals]:"Year-Month Intervals not supported",[f.CannotCastValue]:"Cannot cast value to the required data type"},d=class i extends Error{constructor(a,u){super(pr(rl[a],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,i)}};function wr(i){return Number.isNaN(i)||i===0?i:Math.trunc(i)}var Tr="esri.core.sql.SqlTimeStampOffset",Z=class i{constructor(a){this._timeStampOffset=a,this.declaredRootClass=Tr,this._date=null}static isTimestampOffset(a){return typeof a=="object"&&a!=null&&"declaredRootClass"in a&&a.declaredRootClass===Tr}toDateTime(){return this._date??=L.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return wr(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return wr(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return i.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(a){return new i(L.fromJSDate(a).toISO({includeOffset:!0}))}static fromDateTime(a){return new i(a.toISO({includeOffset:!0}))}static fromParts(a,u,t=0,l=0,v=0,T=0,y=0,N=!1,O=0,A=0){let P=`${a.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`,F="";T<10&&(F="0");let X=`${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${F+T.toString()}`;y!==0&&(X+="."+y.toString().padStart(3,"0"));let ee=`${N?"-":"+"}${O.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`;return new i(P+"T"+X+ee)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let a=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return a&&(a=a.replace(".000","")),a}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(a){let u=this.toDateTime().plus(a);return i.fromDateTime(u)}};function yr(i,a){let u=Sr[i.toLowerCase()];if(u==null)throw new d(f.FunctionNotRecognized);if(a.length<u.minParams||a.length>u.maxParams)throw new d(f.InvalidParameterCount,{name:i.toUpperCase()});return u.evaluate(a)}function We(i,a){let u=Sr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}var Sr={min:{minParams:1,maxParams:1,evaluate:i=>gr(i[0],"min")},max:{minParams:1,maxParams:1,evaluate:i=>gr(i[0],"max")},avg:{minParams:1,maxParams:1,evaluate:i=>Or(i[0])},sum:{minParams:1,maxParams:1,evaluate:i=>nl(i[0])},stddev:{minParams:1,maxParams:1,evaluate:i=>al(i[0])},count:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].length},var:{minParams:1,maxParams:1,evaluate:i=>Nr(i[0])}};function Or(i){if(i===null)return null;let a=0,u=0;for(let t=0;t<i.length;t++){let l=i[t];if(l!==null){if(!Ke(l))throw new d(f.InvalidValueForAggregateFunction);u++,a+=l}}return u===0?null:a/i.length}function Ke(i){return typeof i=="number"}function gr(i,a){if(i===null)return null;let u=null,t=null;for(let l of i){let v=l;v=z.isDateOnly(l)||$.isTimeOnly(l)?l.toNumber():L.isDateTime(l)?l.toMillis():Z.isTimestampOffset(l)?l.toMilliseconds():l,(u===null||a==="max"&&t!==null&&v!==null&&t<=v||a==="min"&&t!==null&&v!==null&&t>=v)&&(u=l,t=v)}return u}function nl(i){if(i===null)return null;let a=0;for(let u=0;u<i.length;u++){let t=i[u];if(t!==null){if(!Ke(t))throw new d(f.InvalidValueForAggregateFunction);a+=t}}return a}function al(i){if(i===null)return null;let a=Nr(i);return a===null?null:Math.sqrt(a)}function Nr(i){if(i===null||(i=i.filter(t=>t!==null)).length===0)return null;let a=Or(i);if(a===null)return null;let u=0;for(let t of i){if(!Ke(t))throw new d(f.InvalidValueForAggregateFunction);u+=(a-t)**2}return u/(i.length-1)}function Xe(i){if(i.precision!==null||i.secondary!==null)throw new d(f.PrimarySecondaryQualifiers)}function Ue(i,a){if(a.includes(".")){let u=a.split(".");i.second=parseFloat(u[0]),i.millis=parseInt(u[1],10)}else i.second=parseFloat(a)}var Ar="esri.core.sql.SqlInterval",U=class i{constructor(){this.declaredRootClass=Ar,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(a){return typeof a=="object"&&a!=null&&"declaredRootClass"in a&&a.declaredRootClass===Ar}static createFromMilliseconds(a){let u=new i;return u.second=a/1e3,u}static createFromValueAndQualifier(a,u,t){let l=null,v=new i;if(v.op=t==="-"?"-":"+",u.type==="interval-period"){Xe(u);let T=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new d(f.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(a))throw new d(f.IllegalInterval);Ue(v,a)}else{if(!T.test(a))throw new d(f.IllegalInterval);v[u.period]=parseFloat(a)}}else{if(Xe(u.start),Xe(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new d(f.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(a))throw new d(f.IllegalInterval);v[u.start.period]=parseFloat(a.split(" ")[0]),v[u.end.period]=parseFloat(a.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(a))throw new d(f.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);let T=a.split(" ")[1].split(":");v.hour=parseFloat(T[0]),v.minute=parseFloat(T[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new d(f.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);let T=a.split(" ")[1].split(":");v.hour=parseFloat(T[0]),v.minute=parseFloat(T[1]),Ue(v,T[2])}break;default:throw new d(f.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(a))throw new d(f.IllegalInterval);v.hour=parseFloat(a.split(":")[0]),v.minute=parseFloat(a.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new d(f.IllegalInterval);{let T=a.split(":");v.hour=parseFloat(T[0]),v.minute=parseFloat(T[1]),Ue(v,T[2])}break;default:throw new d(f.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new d(f.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new d(f.IllegalInterval);{let T=a.split(":");v.minute=parseFloat(T[0]),Ue(v,T[1])}break;default:throw new d(f.IllegalInterval)}}return v}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}};var il=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,ol=/^(\d{1,2}):(\d{1,2})$/,ul=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,xr=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,sl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,ll=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,cl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,fl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function le(i,a){if(a instanceof hr)return a===Le.instance?L.fromMillis(i.getTime(),{zone:Le.instance}):L.fromJSDate(i,{zone:a});switch(a){case"system":case"local":case null:return L.fromJSDate(i);default:return a?.toLowerCase()==="unknown"?L.fromMillis(i.getTime(),{zone:Le.instance}):L.fromJSDate(i,{zone:a})}}function W(i){return U.isInterval(i)}function D(i){return L.isDateTime(i)}function C(i){return z.isDateOnly(i)}function b(i){return $.isTimeOnly(i)}function E(i){return Z.isTimestampOffset(i)}function ve(i){let a=il.exec(i);if(a!==null){let[,u,t,l]=a,v=$.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),0);if(v!==null)return v;throw new d(f.InvalidTime)}if(a=ol.exec(i),a!==null){let[,u,t]=a,l=$.fromParts(parseInt(u,10),parseInt(t,10),0,0);if(l!==null)return l;throw new d(f.InvalidTime)}if(a=ul.exec(i),a!==null){let[,u,t,l,v]=a,T=$.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),parseInt(v,10));if(T!==null)return T;throw new d(f.InvalidTime)}throw new d(f.InvalidTime)}function ce(i,a,u=!1){let t=sl.exec(i);if(t!==null){let[,l,v,T,y,N,O,A]=t,P=L.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(T,10),hour:parseInt(y,10),minute:parseInt(N,10),second:parseInt(O,10),millisecond:A?parseInt(A.replace(".",""),10):0},{zone:Re(a)});if(P.isValid===!1)throw new d(f.InvalidTimeStamp);return P}if(t=ll.exec(i),t!==null){let[,l,v,T,y,N,O,A,P,F,X]=t,ee=Z.fromParts(parseInt(l,10),parseInt(v,10),parseInt(T,10),parseInt(y,10),parseInt(N,10),parseInt(O,10),A?parseInt(A.replace(".",""),10):0,P==="-",parseInt(F,10),parseInt(X,10));if(ee.isValid===!1)throw new d(f.InvalidTimeStamp);return ee}if(t=cl.exec(i),t!==null){let[,l,v,T,y,N,O,A,P]=t,F=Z.fromParts(parseInt(l,10),parseInt(v,10),parseInt(T,10),parseInt(y,10),parseInt(N,10),0,0,O==="-",parseInt(A,10),parseInt(P,10));if(F.isValid===!1)throw new d(f.InvalidTimeStamp);return F}if(t=fl.exec(i),t!==null){let[,l,v,T,y,N]=t,O=L.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(T,10),hour:parseInt(y,10),minute:parseInt(N,10),second:0},{zone:Re(a)});if(O.isValid===!1)throw new d(f.InvalidTimeStamp);return O}if(t=xr.exec(i),t!==null){let[,l,v,T]=t,y=L.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(T,10),hour:0,minute:0,second:0},{zone:Re(a)});if(y.isValid===!1)throw new d(f.InvalidTimeStamp);return y}throw new d(f.InvalidTimeStamp)}function et(i,a){let u=xr.exec(i);if(u===null)try{return ce(i,a)}catch{throw new d(f.InvalidDate)}let[,t,l,v]=u,T=z.fromParts(parseInt(t,10),parseInt(l,10),parseInt(v,10));if(T===null)throw new d(f.InvalidDate);return T}var ml=321408e5,pl=26784e5,dl=864e5,vl=36e5,hl=6e4;function tt(i){return!!D(i)||!!E(i)}function qe(i){return!!D(i)||!!C(i)||!!E(i)||!!b(i)}function _e(i){if(D(i))return i.toMillis();if(C(i))return i.toNumber();if(E(i))return i.toMilliseconds();throw new d(f.InvalidDataType)}function k(i,a,u,t){if(i==null||a==null)return null;if(J(i)){if(J(a))return B(i,a,u);if(R(a))return Il(i,a,u);if(qe(a))throw new d(f.InvalidOperator);if(C(a))throw new d(f.InvalidOperator)}else if(R(i)){if(J(a))return wl(i,a,u);if(R(a))return Tl(i,a,u);if(D(a))throw new d(f.InvalidOperator);if(C(a))throw new d(f.InvalidOperator);if(b(a))throw new d(f.InvalidOperator);if(E(a))throw new d(f.InvalidOperator)}else if(D(i)){if(tt(a)){if(se(i.zone)){if(L.isDateTime(a)&&!se(a.zone)||Z.isTimestampOffset(a))return he(i,a,u)}else if(L.isDateTime(a)&&se(a.zone)&&(!se(i.zone)||Z.isTimestampOffset(i)))return he(i,a,u);return B(_e(i),_e(a),u)}if(R(a))throw new d(f.InvalidOperator);if(C(a))return gl(i,a,u);if(b(a))throw new d(f.InvalidOperator);if(J(a))throw new d(f.InvalidOperator)}else if(C(i)){if(E(a))return Ol(i,a,u);if(D(a))return Sl(i,a,u);if(R(a))throw new d(f.InvalidOperator);if(C(a))return B(i.toNumber(),a.toNumber(),u);if(b(a))throw new d(f.InvalidOperator);if(J(a))throw new d(f.InvalidOperator)}else if(b(i)){if(b(a))return B(i.toNumber(),a.toNumber(),u);if(R(a))throw new d(f.InvalidOperator);if(J(a))throw new d(f.InvalidOperator);if(C(a))throw new d(f.InvalidOperator);if(tt(a))throw new d(f.InvalidOperator)}else if(E(i)){if(tt(a))return L.isDateTime(a)&&se(a.zone)?he(i,a,u):B(_e(i),_e(a),u);if(R(a))throw new d(f.InvalidOperator);if(C(a))return yl(i,a,u);if(b(a))throw new d(f.InvalidOperator);if(J(a))throw new d(f.InvalidOperator)}switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function B(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function Il(i,a,u){let t=parseFloat(a);if(!isNaN(t))return B(i,t,u);let l=i.toString();switch(u){case"<>":return l!==a;case"=":return l===a;case">":return l>a;case"<":return l<a;case">=":return l>=a;case"<=":return l<=a}}function wl(i,a,u){let t=parseFloat(i);if(!isNaN(t))return B(t,a,u);let l=a.toString();switch(u){case"<>":return i!==l;case"=":return i===l;case">":return i>l;case"<":return i<l;case">=":return i>=l;case"<=":return i<=l}}function Tl(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function gl(i,a,u){let t=a.toDateTimeLuxon(i.zone);return B((i=i.startOf("day")).toMillis(),t.toMillis(),u)}function yl(i,a,u){let t=a.toDateTimeLuxon(i.toDateTime().zone);return B((i=i.startOfDay()).toMilliseconds(),t.toMillis(),u)}function Sl(i,a,u){let t=i.toDateTimeLuxon(a.zone);return a=a.startOf("day"),B(t.toMillis(),a.toMillis(),u)}function Ol(i,a,u){let t=i.toDateTimeLuxon(a.toDateTime().zone);return a=a.startOfDay(),B(t.toMillis(),a.toMilliseconds(),u)}function he(i,a,u){Z.isTimestampOffset(i)&&(i=i.toDateTime()),Z.isTimestampOffset(a)&&(a=a.toDateTime());let t=Dr(i),l=Dr(a);switch(u){case"<>":return t!==l;case"=":return t===l;case">":return t>l;case"<":return t<l;case">=":return t>=l;case"<=":return t<=l}}function Dr(i){return i.year*ml+i.month*pl+i.day*dl+i.hour*vl+i.minute*hl+1e3*i.second+i.millisecond}function Ie(i,a,u){let t=Mr[i.toLowerCase()];if(t==null)throw new d(f.FunctionNotRecognized);if(a.length<t.minParams||a.length>t.maxParams)throw new d(f.InvalidParameterCount,{name:i.toUpperCase()});return t.evaluate(a,u)}function Cr(i,a){let u=Mr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}function rt(i){return!H(i)&&!C(i)&&!D(i)&&!b(i)&&!E(i)}function Er(i){return C(i)||b(i)?i.toString():E(i)?i.toSQLValue():D(i)?i.millisecond===0?i.toFormat("yyyy-LL-dd HH:mm:ss"):i.toSQL({includeOffset:!1}):H(i)?Er(L.fromJSDate(i)):i.toString()}function Nl(i){if(H(i))return z.fromDateJS(i);if(D(i))return z.fromParts(i.year,i.month,i.day);if(C(i))return i;if(b(i))throw new d(f.CannotCastValue);if(E(i)&&z.fromParts(i.year,i.month,i.day)===null)throw new d(f.CannotCastValue);if(R(i)){let a=z.fromReader(i);if(a!==null&&a.isValid)return a}throw new d(f.CannotCastValue)}function Al(i,a,u){if(H(i))return le(i,a);if(D(i))return i;if(C(i))return i.toDateTimeLuxon("unknown");if(b(i))throw new d(f.CannotCastValue);if(E(i))return i;if(R(i))return ce(i,"unknown",u);throw new d(f.CannotCastValue)}function xl(i){if(H(i))return $.fromDateJS(i);if(D(i))return $.fromDateTime(i);if(C(i))throw new d(f.CannotCastValue);if(b(i))return i;if(E(i))return $.fromSqlTimeStampOffset(i);if(R(i))return ve(i);throw new d(f.CannotCastValue)}var Mr={extract:{minParams:2,maxParams:2,evaluate:([i,a])=>{if(a==null)return null;if(H(a))switch(i.toUpperCase()){case"SECOND":return a.getSeconds();case"MINUTE":return a.getMinutes();case"HOUR":return a.getHours();case"DAY":return a.getDate();case"MONTH":return a.getMonth()+1;case"YEAR":return a.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(D(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new d(f.InvalidFunctionParameters,{function:"EXTRACT"})}else if(C(a))switch(i.toUpperCase()){case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new d(f.InvalidFunctionParameters,{function:"EXTRACT"})}else if(b(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour}else if(E(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":return a.timezoneOffsetHour;case"TIMEZONE_MINUTE":return a.timezoneOffsetMinutes}throw new d(f.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:i=>{if(i.length===2){let[a,u]=i;return a==null||u==null?null:a.toString().substring(u-1)}if(i.length===3){let[a,u,t]=i;return a==null||u==null||t==null?null:t<=0?"":a.toString().substring(u-1,u+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([i,a])=>i==null||a==null?null:a.indexOf(i)+1},trim:{minParams:2,maxParams:3,evaluate:i=>{let a=i.length===3,u=a?i[1]:" ",t=a?i[2]:i[1];if(u==null||t==null)return null;let l=`(${dr(u)})`;switch(i[0]){case"BOTH":return t.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return t.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return t.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new d(f.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.abs(i[0])},ceiling:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.ceil(i[0])},floor:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.floor(i[0])},log:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])},log10:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sin(i[0])},cos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cos(i[0])},tan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tan(i[0])},asin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.asin(i[0])},acos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.acos(i[0])},atan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.atan(i[0])},sign:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0]>0?1:i[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]**i[1]},mod:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]%i[1]},round:{minParams:1,maxParams:2,evaluate:i=>{let a=i[0],u=i.length===2?10**i[1]:1;return a==null?null:Math.round(a*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:i=>i[0]==null?null:i.length===1||i[1]===0?Math.trunc(i[0]):vr("trunc",i[0],-Number(i[1]))},char_length:{minParams:1,maxParams:1,evaluate:i=>R(i[0])?i[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:i=>{let a="";for(let u=0;u<i.length;u++){if(i[u]==null)return null;a+=i[u].toString()}return a}},lower:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:i=>{for(let a of i)if(a!==null)return a;return null}},cosh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cosh(i[0])},sinh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sinh(i[0])},tanh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tanh(i[0])},nullif:{minParams:2,maxParams:2,evaluate:(i,a)=>k(i[0],i[1],"=")?null:i[0]},cast:{minParams:2,maxParams:2,evaluate:(i,a)=>{let u=i[0],t=i[1];if(u===null)return null;switch(t.type){case"integer":{if(!rt(u))throw new d(f.CannotCastValue);let l=parseInt(u,10);if(isNaN(l))throw new d(f.CannotCastValue);return l}case"smallint":{if(!rt(u))throw new d(f.CannotCastValue);let l=parseInt(u,10);if(isNaN(l))throw new d(f.CannotCastValue);if(l>32767||l<-32767)throw new d(f.CannotCastValue);return l}case"float":case"real":{if(!rt(u))throw new d(f.CannotCastValue);let l=parseFloat(u);if(isNaN(l))throw new d(f.CannotCastValue);return l}case"time":return xl(u);case"date":return Nl(u);case"timestamp":return Al(u,a,t.withtimezone===!0);case"varchar":{let l=Er(u);if(l.length>t.size)throw new d(f.CannotCastValue);return l}default:throw new d(f.InvalidDataType)}}}};function nt(i,a,u,t){if(i==="||")return Ie("concat",[a,u],t);if(a===null||u===null)return null;if(J(a)){if(J(u))return at(a,u,i);if(W(u))return Ll(a,u,i);if(b(u))return kl();if(C(u))return Hl();if(E(u))return zl();if(D(u))return Jl();if(R(u))return jl(a,u,i);throw new d(f.InvalidOperator)}if(C(a)){if(J(u))return Vl(a,u,i);if(W(u))return Rl(a,u,i);if(b(u))return ec();if(C(u))return Xl(a,u,i);if(E(u))return Kl(a,u,i);if(D(u))return Wl(a,u,i);if(R(u))return pc();throw new d(f.InvalidOperator)}if(b(a)){if(J(u))return $l(a,u,i);if(W(u))return Ml(a,u,i);if(b(u))return sc();if(C(u))return oc();if(E(u))return uc();if(D(u))return ic();if(R(u))return dc();throw new d(f.InvalidOperator)}if(W(a)){if(J(u))return Pl(a,u,i);if(W(u))return Fl(a,u,i);if(b(u))return Cl(a,u,i);if(C(u))return El(a,u,i);if(E(u))return bl(a,u,i);if(D(u))return Dl(a,u,i);if(R(u))return Bl();throw new d(f.InvalidOperator)}if(D(a)){if(J(u))return ql(a,u,i);if(W(u))return Ul(a,u,i);if(b(u))return mc();if(C(u))return cc(a,u,i);if(E(u))return fc(a,u,i);if(D(u))return lc(a,u,i);if(R(u))return vc();throw new d(f.InvalidOperator)}if(E(a)){if(J(u))return Zl(a,u,i);if(W(u))return _l(a,u,i);if(b(u))return tc();if(C(u))return rc(a,u,i);if(E(u))return ac(a,u,i);if(D(u))return nc(a,u,i);if(R(u))return hc();throw new d(f.InvalidOperator)}if(R(a)){if(J(u))return Yl(a,u,i);if(W(u))return Gl();if(b(u))return Ic();if(C(u))return wc();if(E(u))return gc();if(D(u))return Tc();if(R(u))return Ql(a,u,i);throw new d(f.InvalidOperator)}throw new d(f.InvalidOperator)}function at(i,a,u){switch(u){case"+":return i+a;case"-":return i-a;case"*":return i*a;case"/":return i/a}throw new d(f.InvalidOperator)}function Dl(i,a,u){switch(u){case"+":return a.plus({milliseconds:i.valueInMilliseconds()});case"-":return i.valueInMilliseconds()-a.toMillis()}throw new d(f.InvalidOperator)}function Cl(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new d(f.InvalidOperator)}function El(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new d(f.InvalidOperator)}function Ml(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new d(f.InvalidOperator)}function bl(i,a,u){if(u==="+")return a.addMilliseconds(i.valueInMilliseconds());throw new d(f.InvalidOperator)}function Fl(i,a,u){switch(u){case"+":return U.createFromMilliseconds(i.valueInMilliseconds()+a.valueInMilliseconds());case"-":return U.createFromMilliseconds(i.valueInMilliseconds()-a.valueInMilliseconds());case"*":return U.createFromMilliseconds(i.valueInMilliseconds()*a.valueInMilliseconds());case"/":return U.createFromMilliseconds(i.valueInMilliseconds()/a.valueInMilliseconds())}throw new d(f.InvalidOperator)}function Pl(i,a,u){switch(u){case"+":return U.createFromMilliseconds(i.valueInMilliseconds()+a);case"-":return U.createFromMilliseconds(i.valueInMilliseconds()-a);case"*":return U.createFromMilliseconds(i.valueInMilliseconds()*a);case"/":return U.createFromMilliseconds(i.valueInMilliseconds()/a)}throw new d(f.InvalidOperator)}function Ll(i,a,u){switch(u){case"+":return U.createFromMilliseconds(i+a.valueInMilliseconds());case"-":return U.createFromMilliseconds(i-a.valueInMilliseconds());case"*":return U.createFromMilliseconds(i*a.valueInMilliseconds());case"/":return U.createFromMilliseconds(i/a.valueInMilliseconds())}throw new d(f.InvalidOperator)}function Rl(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new d(f.InvalidOperator)}function Ul(i,a,u){switch(u){case"+":return i.plus({milliseconds:a.valueInMilliseconds()});case"-":return i.minus({milliseconds:a.valueInMilliseconds()})}throw new d(f.InvalidOperator)}function _l(i,a,u){switch(u){case"+":return i.addMilliseconds(a.valueInMilliseconds());case"-":return i.addMilliseconds(-1*a.valueInMilliseconds())}throw new d(f.InvalidOperator)}function ql(i,a,u){let t=1e3*a*24*60*60;switch(u){case"+":return i.plus({milliseconds:t});case"-":return i.minus({milliseconds:t})}throw new d(f.InvalidOperator)}function Vl(i,a,u){let t=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",t);case"-":return i.plus("milliseconds",-1*t)}throw new d(f.InvalidOperator)}function $l(i,a,u){let t=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",t);case"-":return i.plus("milliseconds",-1*t)}throw new d(f.InvalidOperator)}function Jl(i,a,u){throw new d(f.InvalidOperator)}function Zl(i,a,u){let t=1e3*a*24*60*60;switch(u){case"+":return i.addMilliseconds(t);case"-":return i.addMilliseconds(-1*t)}throw new d(f.InvalidOperator)}function zl(i,a,u){throw new d(f.InvalidOperator)}function kl(i,a,u){throw new d(f.InvalidOperator)}function Hl(i,a,u){throw new d(f.InvalidOperator)}function jl(i,a,u){let t=parseFloat(a);if(isNaN(t))throw new d(f.InvalidOperator);return at(i,t,u)}function Yl(i,a,u){let t=parseFloat(i);if(isNaN(t))throw new d(f.InvalidOperator);return at(t,a,u)}function Ql(i,a,u){if(u==="+")return i+a;throw new d(f.InvalidOperator)}function Bl(i,a,u){throw new d(f.InvalidOperator)}function Gl(i,a,u){throw new d(f.InvalidOperator)}function Wl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.zone).diff(a).as("days");throw new d(f.InvalidOperator)}function Kl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.toDateTime().zone).diff(a.toDateTime()).as("days");throw new d(f.InvalidOperator)}function Xl(i,a,u){if(u==="-")return i.toDateTimeLuxon("UTC").diff(a.toDateTimeLuxon("UTC")).as("days");throw new d(f.InvalidOperator)}function ec(i,a,u){throw new d(f.InvalidOperator)}function tc(i,a,u){throw new d(f.InvalidOperator)}function rc(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTimeLuxon(i.toDateTime().zone)).as("days");throw new d(f.InvalidOperator)}function nc(i,a,u){if(u==="-")return i.toDateTime().diff(a).as("days");throw new d(f.InvalidOperator)}function ac(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTime()).as("days");throw new d(f.InvalidOperator)}function ic(i,a,u){throw new d(f.InvalidOperator)}function oc(i,a,u){throw new d(f.InvalidOperator)}function uc(i,a,u){throw new d(f.InvalidOperator)}function sc(i,a,u){throw new d(f.InvalidOperator)}function lc(i,a,u){if(u==="-")return i.diff(a).as("days");throw new d(f.InvalidOperator)}function cc(i,a,u){if(u==="-")return i.diff(a.toDateTimeLuxon(i.zone)).as("days");throw new d(f.InvalidOperator)}function fc(i,a,u){if(u==="-")return i.diff(a.toDateTime()).as("days");throw new d(f.InvalidOperator)}function mc(i,a,u){throw new d(f.InvalidOperator)}function pc(i,a,u){throw new d(f.InvalidOperator)}function dc(i,a,u){throw new d(f.InvalidOperator)}function vc(i,a,u){throw new d(f.InvalidOperator)}function hc(i,a,u){throw new d(f.InvalidOperator)}function Ic(i,a,u){throw new d(f.InvalidOperator)}function wc(i,a,u){throw new d(f.InvalidOperator)}function Tc(i,a,u){throw new d(f.InvalidOperator)}function gc(i,a,u){throw new d(f.InvalidOperator)}function yc(i,a){function u(){this.constructor=i}u.prototype=a.prototype,i.prototype=new u}function ie(i,a,u,t){var l=Error.call(this,i);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ie.prototype),l.expected=a,l.found=u,l.location=t,l.name="SyntaxError",l}function it(i,a,u){return u=u||" ",i.length>a?i:(a-=i.length,i+(u+=u.repeat(a)).slice(0,a))}function Sc(i,a){var u,t={},l=(a=a!==void 0?a:{}).grammarSource,v={start:Ct},T=Ct,y="!",N="=",O=">=",A=">",P="<=",F="<>",X="!=",ee="||",_r="@",lt="'",ct="N'",Te="''",qr=".",Vr="null",$r="true",Jr="false",Zr="in",zr="is",kr="like",Hr="escape",jr="not",Yr="and",Qr="or",Br="between",Gr="from",Wr="for",Kr="substring",Xr="extract",en="trim",tn="position",rn="timestamp",nn="date",an="time",on="leading",un="trailing",sn="both",ln="cast",cn="as",fn="integer",mn="int",pn="smallint",dn="float",vn="real",hn="varchar",In="to",wn="interval",Tn="year",gn="timezone_hour",yn="timezone_minute",Sn="month",On="day",Nn="hour",An="minute",xn="second",Dn="case",Cn="end",En="when",Mn="then",bn="else",Fn=",",Pn="(",Ln=")",ft="`",Rn=/^[<-=]/,ge=/^[+\-]/,Un=/^[*\/]/,_n=/^[A-Za-z_\x80-\uFFFF]/,qn=/^[A-Za-z0-9_]/,mt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Vn=/^["]/,pt=/^[^']/,$n=/^[0-9]/,Jn=/^[eE]/,Zn=/^[ \t\n\r]/,dt=/^[^`]/,zn=g("!",!1),kn=g("=",!1),Hn=g(">=",!1),jn=g(">",!1),Yn=g("<=",!1),Qn=g("<>",!1),Bn=j([["<","="]],!1,!1),Gn=g("!=",!1),ye=j(["+","-"],!1,!1),Wn=g("||",!1),Kn=j(["*","/"],!1,!1),Xn=j([["A","Z"],["a","z"],"_",["\x80","\uFFFF"]],!1,!1),ea=j([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),vt=j([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uFFFF"]],!1,!1),ta=j(['"'],!1,!1),ra=g("@",!1),ht=g("'",!1),na=g("N'",!1),It=g("''",!1),wt=j(["'"],!0,!1),aa=g(".",!1),ia=j([["0","9"]],!1,!1),oa=j(["e","E"],!1,!1),ua=g("NULL",!0),sa=g("TRUE",!0),la=g("FALSE",!0),ca=g("IN",!0),fa=g("IS",!0),ma=g("LIKE",!0),pa=g("ESCAPE",!0),da=g("NOT",!0),va=g("AND",!0),ha=g("OR",!0),Ia=g("BETWEEN",!0),wa=g("FROM",!0),Ta=g("FOR",!0),ga=g("SUBSTRING",!0),ya=g("EXTRACT",!0),Sa=g("TRIM",!0),Oa=g("POSITION",!0),Na=g("TIMESTAMP",!0),Aa=g("DATE",!0),xa=g("TIME",!0),Da=g("LEADING",!0),Ca=g("TRAILING",!0),Ea=g("BOTH",!0),Ma=g("CAST",!0),ba=g("AS",!0),Fa=g("INTEGER",!0),Pa=g("INT",!0),La=g("SMALLINT",!0),Ra=g("FLOAT",!0),Ua=g("REAL",!0),_a=g("VARCHAR",!0),qa=g("TO",!0),Va=g("INTERVAL",!0),$a=g("YEAR",!0),Ja=g("TIMEZONE_HOUR",!0),Za=g("TIMEZONE_MINUTE",!0),za=g("MONTH",!0),ka=g("DAY",!0),Ha=g("HOUR",!0),ja=g("MINUTE",!0),Ya=g("SECOND",!0),Qa=g("CASE",!0),Ba=g("END",!0),Ga=g("WHEN",!0),Wa=g("THEN",!0),Ka=g("ELSE",!0),Xa=g(",",!1),ei=g("(",!1),ti=g(")",!1),ri=j([" ","	",`
`,"\r"],!1,!1),Tt=g("`",!1),gt=j(["`"],!0,!1),ni=function(e){return e},ai=function(e){return{type:"expression-list",location:w(),value:e}},yt=function(e,r,o){return{op:r,expr:o,location:w()}},ii=function(e,r){return de(e,r)},St=function(e,r,o){return{op:r,expr:o,location:w()}},oi=function(e,r){return de(e,r)},ui=function(e){return Ks("NOT",e,w())},si=function(e,r){return r==""||r==null||r==null?e:r.type=="arithmetic"?de(e,r.tail):lr(r.op,e,r.right,r.escape,w())},Ot=function(e,r){return{op:e,expr:r,location:w()}},li=function(e){return{type:"arithmetic",tail:e}},ci=function(e,r){return{op:e+"NOT",right:r}},fi=function(e,r){return{op:e,right:r}},mi=function(e,r,o){return Y(w(),r,o)},pi=function(e,r){return{op:"NOT"+e,right:r}},di=function(e,r,o){return Y(w(),r,o)},vi=function(e,r){return{op:e,right:r}},hi=function(e){return e[0]+" "+e[2]},Ii=function(e){return e[0]+" "+e[2]},wi=function(e,r,o){return{op:e,right:r,escape:o.value}},Ti=function(e,r){return{op:e,right:r,escape:""}},gi=function(e,r){return{op:e,right:r}},yi=function(e,r){return{op:e,right:r}},Nt=function(e,r,o){return{op:r,expr:o,location:w()}},Si=function(e,r){return de(e,r)},At=function(e,r,o){return{op:r,expr:o,location:w()}},Oi=function(e,r){return de(e,r)},Ni=function(e){return e.paren=!0,e},Ai=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:w(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:w(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(e)?{type:"current-time",location:w(),mode:"time"}:/^CURRENT_USER$/i.test(e)?{type:"current-user",location:w()}:{type:"column-reference",location:w(),table:"",column:e}},xi=function(e){return{type:"column-reference",location:w(),table:"",column:e,delimited:!0}},Di=function(e){return e},Ci=function(e,r){return e+r.join("")},Ei=function(e,r){return e+r.join("")},Mi=function(e){return e},bi=function(e){return e.join("")},Fi=function(){return'"'},Pi=function(e){return{type:"parameter",location:w(),value:e[1]}},Li=function(e,r){return Y(w(),e,r)},Ri=function(e,r){return Y(w(),e,r)},Ui=function(e){return{type:"function",location:w(),name:"extract",args:e}},_i=function(e,r,o){return Y(w(),e,r,...o?[o]:[])},qi=function(e,r,o){return Y(w(),e,r,o)},Vi=function(e){return{type:"function",location:w(),name:"substring",args:e}},$i=function(e,r){return Y(w(),e,r)},Ji=function(e,r){return Y(w(),e,r)},Zi=function(e){return{type:"function",location:w(),name:"cast",args:e}},zi=function(){return{type:"data-type",location:w(),value:{type:"integer"}}},ki=function(){return{type:"data-type",location:w(),value:{type:"smallint"}}},Hi=function(){return{type:"data-type",location:w(),value:{type:"float"}}},ji=function(){return{type:"data-type",location:w(),value:{type:"real"}}},Yi=function(){return{type:"data-type",location:w(),value:{type:"date"}}},Qi=function(){return{type:"data-type",location:w(),value:{type:"timestamp"}}},Bi=function(){return{type:"data-type",location:w(),value:{type:"time"}}},Gi=function(e){return{type:"data-type",location:w(),value:{type:"varchar",size:parseInt(e)}}},Wi=function(e,r,o){return Y(w(),e,r,o)},Ki=function(e,r){return Y(w(),e,r)},Xi=function(e){return{type:"function",location:w(),name:"trim",args:e}},eo=function(e){return{type:"string",location:w(),value:e??"BOTH"}},to=function(e,r){return Y(w(),e,r)},ro=function(e,r){return Y(w(),e,r)},no=function(e){return{type:"function",location:w(),name:"position",args:e}},ao=function(e,r){return{type:"function",location:w(),name:e,args:r}},io=function(e){return{type:"string",location:w(),value:e}},oo=function(e){return e.type==="string"&&Xs(e.value),{type:"timestamp",location:w(),value:e.value}},uo=function(e){return e.type==="string"&&el(e.value),{type:"time",location:w(),value:e.value}},so=function(e,r,o){return{type:"interval",location:w(),value:r,qualifier:o,op:e}},lo=function(e,r){return{type:"interval",location:w(),value:e,qualifier:r,op:""}},co=function(e,r){return{type:"interval-qualifier",location:w(),start:e,end:r}},fo=function(e,r){return{type:"interval-period",location:w(),period:e.value,precision:r,secondary:null}},mo=function(e){return{type:"interval-period",location:w(),period:e.value,precision:null,secondary:null}},po=function(e){return{type:"interval-period",location:w(),period:e.value,precision:null,secondary:null}},vo=function(e,r){return{type:"interval-period",location:w(),period:"second",precision:e,secondary:r}},ho=function(e){return{type:"interval-period",location:w(),period:"second",precision:e,secondary:null}},Io=function(){return{type:"interval-period",location:w(),period:"second",precision:null,secondary:null}},wo=function(e,r){return{type:"interval-period",location:w(),period:e.value,precision:r,secondary:null}},To=function(e){return{type:"interval-period",location:w(),period:e.value,precision:null,secondary:null}},go=function(e,r){return{type:"interval-period",location:w(),period:"second",precision:e,secondary:r}},yo=function(e){return{type:"interval-period",location:w(),period:"second",precision:e,secondary:null}},So=function(){return{type:"interval-period",location:w(),period:"second",precision:null,secondary:null}},Oo=function(){return{type:"string",location:w(),value:"day"}},No=function(){return{type:"string",location:w(),value:"hour"}},Ao=function(){return{type:"string",location:w(),value:"minute"}},xo=function(){return{type:"string",location:w(),value:"month"}},Do=function(){return{type:"string",location:w(),value:"year"}},Co=function(e){return parseFloat(e)},Eo=function(e){return parseFloat(e)},Mo=function(e){return e.type==="string"&&tl(e.value),{type:"date",location:w(),value:e.value}},bo=function(){return{type:"null",location:w(),value:null}},Fo=function(){return{type:"boolean",location:w(),value:!0}},Po=function(){return{type:"boolean",location:w(),value:!1}},xt=function(){return"'"},Lo=function(e){return{type:"string",location:w(),value:e.join("")}},Ro=function(e,r){return{type:"case-expression",location:w(),format:"simple",operand:e,clauses:r,else:null,elseLocation:null}},Uo=function(e,r,o){return{type:"case-expression",location:w(),format:"simple",operand:e,clauses:r,else:o.value,elseLocation:o.location}},_o=function(e){return{type:"case-expression",location:w(),format:"searched",clauses:e,else:null,elseLocation:null}},qo=function(e,r){return{type:"case-expression",location:w(),format:"searched",clauses:e,else:r.value,elseLocation:r.location}},Vo=function(e,r){return{type:"when-clause",location:w(),operand:e,value:r}},$o=function(e,r){return{type:"when-clause",location:w(),operand:e,value:r}},Jo=function(e){return{type:"else-clause",location:w(),value:e}},Zo=function(e){return{type:"number",location:w(),value:e}},zo=function(e,r,o){return parseFloat(e+r+o)},ko=function(e,r){return parseFloat(e+r)},Ho=function(e,r){return parseFloat(e+r)},jo=function(e){return parseFloat(e)},Yo=function(e,r){return e[0]+r},Qo=function(e){return"."+(e??"")},Bo=function(e,r){return e+r},Go=function(e){return e.join("")},Wo=function(e,r){return"e"+(r===null?"":r)},Ko=function(){return"IN"},Xo=function(){return"IS"},eu=function(){return"LIKE"},tu=function(){return"ESCAPE"},ru=function(){return"NOT"},nu=function(){return"AND"},au=function(){return"OR"},iu=function(){return"BETWEEN"},ou=function(){return"FROM"},uu=function(){return"FOR"},su=function(){return"SUBSTRING"},lu=function(){return"EXTRACT"},cu=function(){return"TRIM"},fu=function(){return"POSITION"},mu=function(){return"TIMESTAMP"},pu=function(){return"DATE"},du=function(){return"TIME"},vu=function(){return"LEADING"},hu=function(){return"TRAILING"},Iu=function(){return"BOTH"},wu=function(){return"CAST"},Tu=function(){return"AS"},gu=function(){return"INTEGER"},yu=function(){return"INT"},Su=function(){return"SMALLINT"},Ou=function(){return"FLOAT"},Nu=function(){return"REAL"},Au=function(){return"VARCHAR"},xu=function(){return"TO"},Du=function(){return"INTERVAL"},Cu=function(){return"YEAR"},Eu=function(){return"TIMEZONE_HOUR"},Mu=function(){return"TIMEZONE_MINUTE"},bu=function(){return"MONTH"},Fu=function(){return"DAY"},Pu=function(){return"HOUR"},Lu=function(){return"MINUTE"},Ru=function(){return"SECOND"},Uu=function(){return"CASE"},_u=function(){return"END"},qu=function(){return"WHEN"},Vu=function(){return"THEN"},$u=function(){return"ELSE"},Ju=function(e){return e},Zu=function(e){return e.join("")},n=0|a.peg$currPos,m=n,ue=[{line:1,column:1}],Q=n,Se=a.peg$maxFailExpected||[],c=0|a.peg$silentFails;if(a.startRule){if(!(a.startRule in v))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');T=v[a.startRule]}function w(){return Oe(m,n)}function Je(e,r){throw ku(e,r=r!==void 0?r:Oe(m,n))}function g(e,r){return{type:"literal",text:e,ignoreCase:r}}function j(e,r,o){return{type:"class",parts:e,inverted:r,ignoreCase:o}}function zu(){return{type:"end"}}function Dt(e){var r,o=ue[e];if(o)return o;if(e>=ue.length)r=ue.length-1;else for(r=e;!ue[--r];);for(o={line:(o=ue[r]).line,column:o.column};r<e;)i.charCodeAt(r)===10?(o.line++,o.column=1):o.column++,r++;return ue[e]=o,o}function Oe(e,r,o){var s=Dt(e),h=Dt(r);return{source:l,start:{offset:e,line:s.line,column:s.column},end:{offset:r,line:h.line,column:h.column}}}function I(e){n<Q||(n>Q&&(Q=n,Se=[]),Se.push(e))}function ku(e,r){return new ie(e,null,null,r)}function Hu(e,r,o){return new ie(ie.buildMessage(e,r),e,r,o)}function Ct(){var e,r;return e=n,p(),(r=M())!==t?(p(),m=e,e=ni(r)):(n=e,e=t),e}function Et(){var e,r,o,s,h,x;if(e=n,q()!==t){for(p(),r=[],o=M();o!==t;)r.push(o),o=n,s=n,h=p(),(x=K())!==t?s=h=[h,x,p()]:(n=s,s=t),s!==t&&(s=M())===t?(n=o,o=t):o=s;o=p(),(s=V())!==t?(m=e,e=ai(r)):(n=e,e=t)}else n=e,e=t;return e}function M(){var e,r,o,s,h,x;if(e=n,(r=Ze())!==t){for(o=[],s=n,p(),(h=Qt())!==t?(p(),(x=Ze())!==t?(m=s,s=yt(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Qt())!==t?(p(),(x=Ze())!==t?(m=s,s=yt(r,h,x)):(n=s,s=t)):(n=s,s=t);m=e,e=ii(r,o)}else n=e,e=t;return e}function Ze(){var e,r,o,s,h,x;if(e=n,(r=Ne())!==t){for(o=[],s=n,p(),(h=be())!==t?(p(),(x=Ne())!==t?(m=s,s=St(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=be())!==t?(p(),(x=Ne())!==t?(m=s,s=St(r,h,x)):(n=s,s=t)):(n=s,s=t);m=e,e=oi(r,o)}else n=e,e=t;return e}function Ne(){var e,r,o,s,h;return e=n,(r=pe())===t&&(r=n,i.charCodeAt(n)===33?(o=y,n++):(o=t,c===0&&I(zn)),o!==t?(s=n,c++,i.charCodeAt(n)===61?(h=N,n++):(h=t,c===0&&I(kn)),c--,h===t?s=void 0:(n=s,s=t),s!==t?r=o=[o,s]:(n=r,r=t)):(n=r,r=t)),r!==t?(o=p(),(s=Ne())!==t?(m=e,e=ui(s)):(n=e,e=t)):(n=e,e=t),e===t&&(e=ju()),e}function ju(){var e,r,o,s;return e=n,(r=G())!==t?(o=n,p(),(s=Yu())!==t?o=s:(n=o,o=t),o===t&&(o=null),m=e,e=si(r,o)):(n=e,e=t),e}function Yu(){var e;return(e=Qu())===t&&(e=Ku())===t&&(e=Gu())===t&&(e=Bu())===t&&(e=Wu()),e}function Qu(){var e,r,o,s,h;if(e=n,r=[],o=n,p(),(s=Mt())!==t?(p(),(h=G())!==t?(m=o,o=Ot(s,h)):(n=o,o=t)):(n=o,o=t),o!==t)for(;o!==t;)r.push(o),o=n,p(),(s=Mt())!==t?(p(),(h=G())!==t?(m=o,o=Ot(s,h)):(n=o,o=t)):(n=o,o=t);else r=t;return r!==t&&(m=e,r=li(r)),e=r}function Mt(){var e;return i.substr(n,2)===O?(e=O,n+=2):(e=t,c===0&&I(Hn)),e===t&&(i.charCodeAt(n)===62?(e=A,n++):(e=t,c===0&&I(jn)),e===t&&(i.substr(n,2)===P?(e=P,n+=2):(e=t,c===0&&I(Yn)),e===t&&(i.substr(n,2)===F?(e=F,n+=2):(e=t,c===0&&I(Qn)),e===t&&(e=i.charAt(n),Rn.test(e)?n++:(e=t,c===0&&I(Bn)),e===t&&(i.substr(n,2)===X?(e=X,n+=2):(e=t,c===0&&I(Gn))))))),e}function Bu(){var e,r,o,s;return e=n,(r=jt())!==t?(p(),(o=pe())!==t?(p(),(s=G())!==t?(m=e,e=ci(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=jt())!==t?(p(),(o=G())!==t?(m=e,e=fi(r,o)):(n=e,e=t)):(n=e,e=t)),e}function Gu(){var e,r,o,s,h,x,ae,cr;return e=n,(r=pe())!==t?(p(),(o=Bt())!==t?(s=p(),h=n,(x=G())!==t?(p(),(ae=be())!==t?(p(),(cr=G())!==t?(m=h,h=mi(o,x,cr)):(n=h,h=t)):(n=h,h=t)):(n=h,h=t),h!==t?(m=e,e=pi(o,h)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Bt())!==t?(p(),o=n,(s=G())!==t?(h=p(),(x=be())!==t?(p(),(ae=G())!==t?(m=o,o=di(r,s,ae)):(n=o,o=t)):(n=o,o=t)):(n=o,o=t),o!==t?(m=e,e=vi(r,o)):(n=e,e=t)):(n=e,e=t)),e}function bt(){var e,r,o,s,h;return e=n,r=n,(o=pe())!==t?(s=p(),(h=Yt())!==t?r=o=[o,s,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(m=e,r=hi(r)),(e=r)===t&&(e=Yt()),e}function Ft(){var e,r,o,s,h;return e=n,r=n,(o=pe())!==t?(s=p(),(h=Qe())!==t?r=o=[o,s,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(m=e,r=Ii(r)),(e=r)===t&&(e=Qe()),e}function Wu(){var e,r,o,s;return e=n,(r=bt())!==t?(p(),(o=te())!==t?(p(),bs()!==t?(p(),(s=Ye())!==t?(m=e,e=wi(r,o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=bt())!==t?(p(),(o=te())!==t?(m=e,e=Ti(r,o)):(n=e,e=t)):(n=e,e=t)),e}function Ku(){var e,r,o;return e=n,(r=Ft())!==t?(p(),(o=Et())!==t?(m=e,e=gi(r,o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Ft())!==t?(p(),(o=je())!==t?(m=e,e=yi(r,o)):(n=e,e=t)):(n=e,e=t)),e}function G(){var e,r,o,s,h,x;if(e=n,(r=ze())!==t){for(o=[],s=n,p(),(h=Pt())!==t?(p(),(x=ze())!==t?(m=s,s=Nt(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Pt())!==t?(p(),(x=ze())!==t?(m=s,s=Nt(r,h,x)):(n=s,s=t)):(n=s,s=t);m=e,e=Si(r,o)}else n=e,e=t;return e}function Pt(){var e;return e=i.charAt(n),ge.test(e)?n++:(e=t,c===0&&I(ye)),e===t&&(i.substr(n,2)===ee?(e=ee,n+=2):(e=t,c===0&&I(Wn))),e}function ze(){var e,r,o,s,h,x;if(e=n,(r=ke())!==t){for(o=[],s=n,p(),(h=Lt())!==t?(p(),(x=ke())!==t?(m=s,s=At(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Lt())!==t?(p(),(x=ke())!==t?(m=s,s=At(r,h,x)):(n=s,s=t)):(n=s,s=t);m=e,e=Oi(r,o)}else n=e,e=t;return e}function Lt(){var e;return e=i.charAt(n),Un.test(e)?n++:(e=t,c===0&&I(Kn)),e}function ke(){var e,r;return(e=ms())===t&&(e=os())===t&&(e=us())===t&&(e=ls())===t&&(e=cs())===t&&(e=ss())===t&&(e=fs())===t&&(e=Ss())===t&&(e=Xu())===t&&(e=je())===t&&(e=n,q()!==t?(p(),(r=M())!==t?(p(),V()!==t?(m=e,e=Ni(r)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Xu(){var e,r;return e=n,(r=es())!==t&&(m=e,r=Ai(r)),(e=r)===t&&(e=n,(r=rs())!==t&&(m=e,r=xi(r)),e=r),e}function es(){var e,r;return e=n,(r=ts())!==t&&(m=e,r=Di(r)),e=r}function ts(){var e,r,o,s;if(e=n,(r=He())!==t){for(o=[],s=Ut();s!==t;)o.push(s),s=Ut();m=e,e=Ci(r,o)}else n=e,e=t;return e}function Rt(){var e,r,o,s;if(e=n,(r=He())!==t){for(o=[],s=S();s!==t;)o.push(s),s=S();m=e,e=Ei(r,o)}else n=e,e=t;return e}function He(){var e;return e=i.charAt(n),_n.test(e)?n++:(e=t,c===0&&I(Xn)),e}function S(){var e;return e=i.charAt(n),qn.test(e)?n++:(e=t,c===0&&I(ea)),e}function Ut(){var e;return e=i.charAt(n),mt.test(e)?n++:(e=t,c===0&&I(vt)),e}function rs(){var e,r;return e=n,Ae()!==t?(r=ns(),Ae()!==t?(m=e,e=Mi(r)):(n=e,e=t)):(n=e,e=t),e}function ns(){var e,r,o;for(e=n,r=[],o=_t();o!==t;)r.push(o),o=_t();return m=e,e=r=bi(r)}function _t(){var e;return(e=is())===t&&(e=as()),e}function as(){var e;return e=n,Ae()!==t&&Ae()!==t?(m=e,e=Fi()):(n=e,e=t),e}function is(){var e;return e=i.charAt(n),mt.test(e)?n++:(e=t,c===0&&I(vt)),e}function Ae(){var e;return e=i.charAt(n),Vn.test(e)?n++:(e=t,c===0&&I(ta)),e}function je(){var e,r,o,s;return e=n,r=n,i.charCodeAt(n)===64?(o=_r,n++):(o=t,c===0&&I(ra)),o!==t&&(s=Rt())!==t?r=o=[o,s]:(n=r,r=t),r!==t&&(m=e,r=Pi(r)),e=r}function os(){var e,r,o,s;return e=n,Gt()!==t?(p(),r=n,q()!==t?(p(),(o=$t())!==t?(p(),Be()!==t?(p(),(s=M())!==t?(p(),V()!==t?(m=r,r=Li(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,q()!==t?(p(),(o=$t())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),V()!==t?(m=r,r=Ri(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(m=e,e=Ui(r)):(n=e,e=t)):(n=e,e=t),e}function us(){var e,r,o,s,h,x,ae;return e=n,Ps()!==t?(p(),r=n,q()!==t?(p(),(o=M())!==t?(p(),Be()!==t?(p(),(s=M())!==t?(p(),h=n,Fs()!==t?(x=p(),(ae=M())!==t?(p(),h=ae):(n=h,h=t)):(n=h,h=t),h===t&&(h=null),V()!==t?(m=r,r=_i(o,s,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,q()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),(h=K())!==t?(p(),(x=M())!==t&&(ae=V())!==t?(m=r,r=qi(o,s,x)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(m=e,e=Vi(r)):(n=e,e=t)):(n=e,e=t),e}function ss(){var e,r,o,s;return e=n,Vs()!==t?(p(),r=n,q()!==t?(p(),(o=M())!==t?(p(),$s()!==t?(p(),(s=qt())!==t?(p(),V()!==t?(m=r,r=$i(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,q()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=qt())!==t?(p(),V()!==t?(m=r,r=Ji(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(m=e,e=Zi(r)):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,o;return e=n,(r=Js())===t&&(r=Zs()),r!==t&&(m=e,r=zi()),(e=r)===t&&(e=n,(r=zs())!==t&&(m=e,r=ki()),(e=r)===t&&(e=n,(r=ks())!==t&&(m=e,r=Hi()),(e=r)===t&&(e=n,(r=Hs())!==t&&(m=e,r=ji()),(e=r)===t&&(e=n,(r=Kt())!==t&&(m=e,r=Yi()),(e=r)===t&&(e=n,(r=Wt())!==t&&(m=e,r=Qi()),(e=r)===t&&(e=n,(r=Xt())!==t&&(m=e,r=Bi()),(e=r)===t&&(e=n,(r=js())!==t?(p(),q()!==t?(p(),(o=re())!==t?(p(),V()!==t?(m=e,e=Gi(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function ls(){var e,r,o,s,h;return e=n,Ls()!==t?(p(),r=n,q()!==t?(p(),o=Vt(),p(),(s=M())!==t?(p(),Be()!==t?(p(),(h=M())!==t?(p(),V()!==t?(m=r,r=Wi(o,s,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,q()!==t?(p(),o=Vt(),p(),(s=M())!==t?(p(),V()!==t?(m=r,r=Ki(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(m=e,e=Xi(r)):(n=e,e=t)):(n=e,e=t),e}function Vt(){var e,r;return e=n,(r=Us())===t&&(r=_s())===t&&(r=qs()),r===t&&(r=null),m=e,e=r=eo(r)}function cs(){var e,r,o,s;return e=n,Rs()!==t?(p(),r=n,q()!==t?(p(),(o=M())!==t?(p(),Qe()!==t?(p(),(s=M())!==t?(p(),V()!==t?(m=r,r=to(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,q()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),V()!==t?(m=r,r=ro(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(m=e,e=no(r)):(n=e,e=t)):(n=e,e=t),e}function fs(){var e,r,o,s;return e=n,r=n,c++,o=Gt(),c--,o===t?r=void 0:(n=r,r=t),r!==t&&(o=Ws())!==t?(p(),(s=Et())!==t?(m=e,e=ao(o,s)):(n=e,e=t)):(n=e,e=t),e}function $t(){var e,r;return e=n,(r=tr())===t&&(r=rr())===t&&(r=nr())===t&&(r=ar())===t&&(r=ir())===t&&(r=ne())===t&&(r=Qs())===t&&(r=Bs()),r!==t&&(m=e,r=io(r)),e=r}function ms(){var e;return(e=Ye())===t&&(e=As())===t&&(e=ys())===t&&(e=gs())===t&&(e=Ts())===t&&(e=ps())===t&&(e=vs())===t&&(e=ds()),e}function ps(){var e,r;return e=n,Wt()!==t?(p(),(r=te())!==t?(m=e,e=oo(r)):(n=e,e=t)):(n=e,e=t),e}function ds(){var e,r;return e=n,Xt()!==t?(p(),(r=te())!==t?(m=e,e=uo(r)):(n=e,e=t)):(n=e,e=t),e}function vs(){var e,r,o,s;return e=n,er()!==t?(p(),r=i.charAt(n),ge.test(r)?n++:(r=t,c===0&&I(ye)),r!==t?(p(),(o=te())!==t?(p(),(s=Jt())!==t?(m=e,e=so(r,o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,er()!==t?(p(),(r=te())!==t?(p(),(o=Jt())!==t?(m=e,e=lo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Jt(){var e,r,o;return e=n,(r=hs())!==t?(p(),Ys()!==t?(p(),(o=Is())!==t?(m=e,e=co(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=ws()),e}function hs(){var e,r,o;return e=n,(r=me())!==t?(p(),q()!==t?(p(),(o=De())!==t?(p(),V()!==t?(m=e,e=fo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=me())!==t&&(m=e,r=mo(r)),e=r),e}function Is(){var e,r,o,s;return e=n,(r=me())!==t&&(m=e,r=po(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),q()!==t?(p(),(o=De())!==t?(p(),K()!==t?(p(),(s=xe())!==t?(p(),V()!==t?(m=e,e=vo(o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),q()!==t?(p(),(o=De())!==t?(p(),V()!==t?(m=e,e=ho(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(m=e,r=Io()),e=r))),e}function ws(){var e,r,o,s;return e=n,(r=me())!==t?(p(),q()!==t?(p(),(o=xe())!==t?(p(),V()!==t?(m=e,e=wo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=me())!==t&&(m=e,r=To(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),q()!==t?(p(),(o=De())!==t?(p(),K()!==t?(p(),(s=xe())!==t?(p(),V()!==t?(m=e,e=go(o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),q()!==t?(p(),(o=xe())!==t?(p(),V()!==t?(m=e,e=yo(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(m=e,r=So()),e=r)))),e}function me(){var e,r;return e=n,(r=nr())!==t&&(m=e,r=Oo()),(e=r)===t&&(e=n,(r=ar())!==t&&(m=e,r=No()),(e=r)===t&&(e=n,(r=ir())!==t&&(m=e,r=Ao()),(e=r)===t&&(e=n,(r=rr())!==t&&(m=e,r=xo()),(e=r)===t&&(e=n,(r=tr())!==t&&(m=e,r=Do()),e=r)))),e}function xe(){var e,r;return e=n,(r=re())!==t&&(m=e,r=Co(r)),e=r}function De(){var e,r;return e=n,(r=re())!==t&&(m=e,r=Eo(r)),e=r}function Ts(){var e,r;return e=n,Kt()!==t?(p(),(r=te())!==t?(m=e,e=Mo(r)):(n=e,e=t)):(n=e,e=t),e}function gs(){var e,r;return e=n,(r=Cs())!==t&&(m=e,r=bo()),e=r}function ys(){var e,r;return e=n,(r=Es())!==t&&(m=e,r=Fo()),(e=r)===t&&(e=n,(r=Ms())!==t&&(m=e,r=Po()),e=r),e}function te(){var e;return(e=Ye())===t&&(e=je()),e}function Ye(){var e,r,o,s,h;if(e=n,i.charCodeAt(n)===39?(r=lt,n++):(r=t,c===0&&I(ht)),r===t&&(i.substr(n,2)===ct?(r=ct,n+=2):(r=t,c===0&&I(na))),r!==t){for(o=[],s=n,i.substr(n,2)===Te?(h=Te,n+=2):(h=t,c===0&&I(It)),h!==t&&(m=s,h=xt()),(s=h)===t&&(s=i.charAt(n),pt.test(s)?n++:(s=t,c===0&&I(wt)));s!==t;)o.push(s),s=n,i.substr(n,2)===Te?(h=Te,n+=2):(h=t,c===0&&I(It)),h!==t&&(m=s,h=xt()),(s=h)===t&&(s=i.charAt(n),pt.test(s)?n++:(s=t,c===0&&I(wt)));i.charCodeAt(n)===39?(s=lt,n++):(s=t,c===0&&I(ht)),s!==t?(m=e,e=Lo(o)):(n=e,e=t)}else n=e,e=t;return e}function Ss(){var e;return(e=Os())===t&&(e=Ns()),e}function Os(){var e,r,o,s,h;if(e=n,Fe()!==t)if(p(),(r=M())!==t){for(p(),o=[],s=n,(h=Ee())!==t?(p(),s=h):(n=s,s=t);s!==t;)o.push(s),s=n,(h=Ee())!==t?(p(),s=h):(n=s,s=t);(s=Pe())!==t?(m=e,e=Ro(r,o)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Fe()!==t)if(p(),(r=M())!==t){for(p(),o=[],s=n,(h=Ee())!==t?(p(),s=h):(n=s,s=t);s!==t;)o.push(s),s=n,(h=Ee())!==t?(p(),s=h):(n=s,s=t);(s=Zt())!==t?(h=p(),Pe()!==t?(m=e,e=Uo(r,o,s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function Ns(){var e,r,o,s;if(e=n,Fe()!==t){for(p(),r=[],o=n,(s=Ce())!==t?(p(),o=s):(n=o,o=t);o!==t;)r.push(o),o=n,(s=Ce())!==t?(p(),o=s):(n=o,o=t);(o=Pe())!==t?(m=e,e=_o(r)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Fe()!==t){for(p(),r=[],o=n,(s=Ce())!==t?(p(),o=s):(n=o,o=t);o!==t;)r.push(o),o=n,(s=Ce())!==t?(p(),o=s):(n=o,o=t);(o=Zt())!==t?(s=p(),Pe()!==t?(m=e,e=qo(r,o)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Ce(){var e,r,o;return e=n,or()!==t?(p(),(r=M())!==t?(p(),ur()!==t?(p(),(o=M())!==t?(m=e,e=Vo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Ee(){var e,r,o;return e=n,or()!==t?(p(),(r=M())!==t?(p(),ur()!==t?(p(),(o=M())!==t?(m=e,e=$o(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Zt(){var e,r;return e=n,Gs()!==t?(p(),(r=M())!==t?(m=e,e=Jo(r)):(n=e,e=t)):(n=e,e=t),e}function As(){var e,r,o,s;return e=n,(r=xs())!==t?(o=n,c++,s=He(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Zo(r)):(n=e,e=t)):(n=e,e=t),e}function xs(){var e,r,o,s;return e=n,(r=Me())!==t&&(o=zt())!==t&&(s=kt())!==t?(m=e,e=zo(r,o,s)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(o=zt())!==t?(m=e,e=ko(r,o)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(o=kt())!==t?(m=e,e=Ho(r,o)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(m=e,r=jo(r)),e=r))),e}function Me(){var e,r,o;return(e=re())===t&&(e=n,r=i.charAt(n),ge.test(r)?n++:(r=t,c===0&&I(ye)),r!==t&&(o=re())!==t?(m=e,e=Yo(r,o)):(n=e,e=t)),e}function zt(){var e,r,o;return e=n,i.charCodeAt(n)===46?(r=qr,n++):(r=t,c===0&&I(aa)),r!==t?((o=re())===t&&(o=null),m=e,e=Qo(o)):(n=e,e=t),e}function kt(){var e,r,o;return e=n,(r=Ds())!==t&&(o=re())!==t?(m=e,e=Bo(r,o)):(n=e,e=t),e}function re(){var e,r,o;if(e=n,r=[],(o=Ht())!==t)for(;o!==t;)r.push(o),o=Ht();else r=t;return r!==t&&(m=e,r=Go(r)),e=r}function Ht(){var e;return e=i.charAt(n),$n.test(e)?n++:(e=t,c===0&&I(ia)),e}function Ds(){var e,r,o;return e=n,r=i.charAt(n),Jn.test(r)?n++:(r=t,c===0&&I(oa)),r!==t?(o=i.charAt(n),ge.test(o)?n++:(o=t,c===0&&I(ye)),o===t&&(o=null),m=e,e=Wo(r,o)):(n=e,e=t),e}function Cs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Vr?n+=4:(r=t,c===0&&I(ua)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function Es(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===$r?n+=4:(r=t,c===0&&I(sa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function Ms(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===Jr?n+=5:(r=t,c===0&&I(la)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function Qe(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===Zr?n+=2:(r=t,c===0&&I(ca)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Ko()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===zr?n+=2:(r=t,c===0&&I(fa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Xo()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===kr?n+=4:(r=t,c===0&&I(ma)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=eu()):(n=e,e=t)):(n=e,e=t),e}function bs(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===Hr?n+=6:(r=t,c===0&&I(pa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=tu()):(n=e,e=t)):(n=e,e=t),e}function pe(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===jr?n+=3:(r=t,c===0&&I(da)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=ru()):(n=e,e=t)):(n=e,e=t),e}function be(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===Yr?n+=3:(r=t,c===0&&I(va)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=nu()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===Qr?n+=2:(r=t,c===0&&I(ha)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=au()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===Br?n+=7:(r=t,c===0&&I(Ia)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=iu()):(n=e,e=t)):(n=e,e=t),e}function Be(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Gr?n+=4:(r=t,c===0&&I(wa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=ou()):(n=e,e=t)):(n=e,e=t),e}function Fs(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===Wr?n+=3:(r=t,c===0&&I(Ta)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=uu()):(n=e,e=t)):(n=e,e=t),e}function Ps(){var e,r,o,s;return e=n,(r=i.substr(n,9)).toLowerCase()===Kr?n+=9:(r=t,c===0&&I(ga)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=su()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===Xr?n+=7:(r=t,c===0&&I(ya)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=lu()):(n=e,e=t)):(n=e,e=t),e}function Ls(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===en?n+=4:(r=t,c===0&&I(Sa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=cu()):(n=e,e=t)):(n=e,e=t),e}function Rs(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===tn?n+=8:(r=t,c===0&&I(Oa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=fu()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,o,s;return e=n,(r=i.substr(n,9)).toLowerCase()===rn?n+=9:(r=t,c===0&&I(Na)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=mu()):(n=e,e=t)):(n=e,e=t),e}function Kt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===nn?n+=4:(r=t,c===0&&I(Aa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=pu()):(n=e,e=t)):(n=e,e=t),e}function Xt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===an?n+=4:(r=t,c===0&&I(xa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=du()):(n=e,e=t)):(n=e,e=t),e}function Us(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===on?n+=7:(r=t,c===0&&I(Da)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=vu()):(n=e,e=t)):(n=e,e=t),e}function _s(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===un?n+=8:(r=t,c===0&&I(Ca)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=hu()):(n=e,e=t)):(n=e,e=t),e}function qs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===sn?n+=4:(r=t,c===0&&I(Ea)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Iu()):(n=e,e=t)):(n=e,e=t),e}function Vs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===ln?n+=4:(r=t,c===0&&I(Ma)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=wu()):(n=e,e=t)):(n=e,e=t),e}function $s(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===cn?n+=2:(r=t,c===0&&I(ba)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Tu()):(n=e,e=t)):(n=e,e=t),e}function Js(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===fn?n+=7:(r=t,c===0&&I(Fa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=gu()):(n=e,e=t)):(n=e,e=t),e}function Zs(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===mn?n+=3:(r=t,c===0&&I(Pa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=yu()):(n=e,e=t)):(n=e,e=t),e}function zs(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===pn?n+=8:(r=t,c===0&&I(La)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Su()):(n=e,e=t)):(n=e,e=t),e}function ks(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===dn?n+=5:(r=t,c===0&&I(Ra)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Ou()):(n=e,e=t)):(n=e,e=t),e}function Hs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===vn?n+=4:(r=t,c===0&&I(Ua)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Nu()):(n=e,e=t)):(n=e,e=t),e}function js(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===hn?n+=7:(r=t,c===0&&I(_a)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Au()):(n=e,e=t)):(n=e,e=t),e}function Ys(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===In?n+=2:(r=t,c===0&&I(qa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=xu()):(n=e,e=t)):(n=e,e=t),e}function er(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===wn?n+=8:(r=t,c===0&&I(Va)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Du()):(n=e,e=t)):(n=e,e=t),e}function tr(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Tn?n+=4:(r=t,c===0&&I($a)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Cu()):(n=e,e=t)):(n=e,e=t),e}function Qs(){var e,r,o,s;return e=n,(r=i.substr(n,13)).toLowerCase()===gn?n+=13:(r=t,c===0&&I(Ja)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Eu()):(n=e,e=t)):(n=e,e=t),e}function Bs(){var e,r,o,s;return e=n,(r=i.substr(n,15)).toLowerCase()===yn?n+=15:(r=t,c===0&&I(Za)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Mu()):(n=e,e=t)):(n=e,e=t),e}function rr(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===Sn?n+=5:(r=t,c===0&&I(za)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=bu()):(n=e,e=t)):(n=e,e=t),e}function nr(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===On?n+=3:(r=t,c===0&&I(ka)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Fu()):(n=e,e=t)):(n=e,e=t),e}function ar(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Nn?n+=4:(r=t,c===0&&I(Ha)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Pu()):(n=e,e=t)):(n=e,e=t),e}function ir(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===An?n+=6:(r=t,c===0&&I(ja)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Lu()):(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===xn?n+=6:(r=t,c===0&&I(Ya)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Ru()):(n=e,e=t)):(n=e,e=t),e}function Fe(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Dn?n+=4:(r=t,c===0&&I(Qa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Uu()):(n=e,e=t)):(n=e,e=t),e}function Pe(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===Cn?n+=3:(r=t,c===0&&I(Ba)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=_u()):(n=e,e=t)):(n=e,e=t),e}function or(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===En?n+=4:(r=t,c===0&&I(Ga)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=qu()):(n=e,e=t)):(n=e,e=t),e}function ur(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Mn?n+=4:(r=t,c===0&&I(Wa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=Vu()):(n=e,e=t)):(n=e,e=t),e}function Gs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===bn?n+=4:(r=t,c===0&&I(Ka)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(m=e,e=$u()):(n=e,e=t)):(n=e,e=t),e}function K(){var e;return i.charCodeAt(n)===44?(e=Fn,n++):(e=t,c===0&&I(Xa)),e}function q(){var e;return i.charCodeAt(n)===40?(e=Pn,n++):(e=t,c===0&&I(ei)),e}function V(){var e;return i.charCodeAt(n)===41?(e=Ln,n++):(e=t,c===0&&I(ti)),e}function p(){var e,r;for(e=[],r=sr();r!==t;)e.push(r),r=sr();return e}function sr(){var e;return e=i.charAt(n),Zn.test(e)?n++:(e=t,c===0&&I(ri)),e}function Ws(){var e,r,o,s;if(e=n,(r=Rt())!==t&&(m=e,r=Ju(r)),(e=r)===t)if(e=n,i.charCodeAt(n)===96?(r=ft,n++):(r=t,c===0&&I(Tt)),r!==t){if(o=[],s=i.charAt(n),dt.test(s)?n++:(s=t,c===0&&I(gt)),s!==t)for(;s!==t;)o.push(s),s=i.charAt(n),dt.test(s)?n++:(s=t,c===0&&I(gt));else o=t;o!==t?(i.charCodeAt(n)===96?(s=ft,n++):(s=t,c===0&&I(Tt)),s!==t?(m=e,e=Zu(o)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Ks(e,r,o){return{type:"unary-expression",location:o,operator:e,expr:r}}function lr(e,r,o,s,h){let x={type:"binary-expression",location:h,operator:e,left:r,right:o};return s!==void 0&&(x.escape=s),x}function Y(e,...r){return{type:"expression-list",location:e,value:r}}function de(e,r){let o=e;for(let{op:s,expr:h,location:{end:x}}of r)o=lr(s,o,h,void 0,mr(fr({},o.location),{end:x}));return o}function Xs(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Je("Timestamp literal is invalid")}function el(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&Je("Time literal is invalid")}function tl(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Je("Date literal is invalid")}if(u=T(),a.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:t,peg$maxFailExpected:Se,peg$maxFailPos:Q};if(u!==t&&n===i.length)return u;throw u!==t&&n<i.length&&I(zu()),Hu(Se,Q<i.length?i.charAt(Q):null,Q<i.length?Oe(Q,Q+1):Oe(Q,Q))}yc(ie,Error),ie.prototype.format=function(i){var a="Error: "+this.message;if(this.location){var u,t=null;for(u=0;u<i.length;u++)if(i[u].source===this.location.source){t=i[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,v=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,T=this.location.source+":"+v.line+":"+v.column;if(t){var y=this.location.end,N=it("",v.line.toString().length," "),O=t[l.line-1],A=(l.line===y.line?y.column:O.length+1)-l.column||1;a+=`
 --> `+T+`
`+N+` |
`+v.line+" | "+O+`
`+N+" | "+it("",l.column-1," ")+it("",A,"^")}else a+=`
 at `+T}return a},ie.buildMessage=function(i,a){var u={literal:function(O){return'"'+l(O.text)+'"'},class:function(O){var A=O.parts.map(function(P){return Array.isArray(P)?v(P[0])+"-"+v(P[1]):v(P)});return"["+(O.inverted?"^":"")+A.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(O){return O.description}};function t(O){return O.charCodeAt(0).toString(16).toUpperCase()}function l(O){return O.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+t(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+t(A)})}function v(O){return O.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+t(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+t(A)})}function T(O){return u[O.type](O)}function y(O){var A,P,F=O.map(T);if(F.sort(),F.length>0){for(A=1,P=1;A<F.length;A++)F[A-1]!==F[A]&&(F[P]=F[A],P++);F.length=P}switch(F.length){case 1:return F[0];case 2:return F[0]+" or "+F[1];default:return F.slice(0,-1).join(", ")+", or "+F[F.length-1]}}function N(O){return O?'"'+l(O)+'"':"end of input"}return"Expected "+y(i)+" but "+N(a)+" found."};var Ve=class{static parse(a){return Sc(a)}};function _(i,a){if(i!=null)switch(a(i),i.type){case"when-clause":_(i.operand,a),_(i.value,a);break;case"case-expression":for(let u of i.clauses)_(u,a);i.format==="simple"&&_(i.operand,a),i.else!==null&&_(i.else,a);break;case"expression-list":for(let u of i.value)_(u,a);break;case"unary-expression":_(i.expr,a);break;case"binary-expression":_(i.left,a),_(i.right,a);break;case"function":_(i.args,a);break;case"interval":_(i.value,a),_(i.qualifier,a);break;case"interval-qualifier":_(i.start,a),_(i.end,a)}}var Oc=new Set(["current_timestamp","current_date","current_time"]),fe=class{static makeBool(a){return Pr(a)}static featureValue(a,u,t,l){return Ur(a,u,t,l)}static equalsNull(a){return a===null}static applyLike(a,u,t){return st(a,u,t)}static ensureArray(a){return ot(a)}static applyIn(a,u,t){return ut(a,u)}static currentTimestamp(a){return le(new Date,a)}static currentDate(a){return z.fromNow(a)}static currentTime(a){let u=le(new Date,a);return $.fromDateTime(u)}static makeSqlInterval(a,u,t){return U.createFromValueAndQualifier(a,u,t)}static convertInterval(a){return U.isInterval(a)?a.valueInMilliseconds():a}static compare(a,u,t,l){return k(u,t,a)}static calculate(a,u,t,l){return nt(a,u,t,l)}static evaluateTime(a){return ve(a)}static evaluateTimestamp(a,u,t){return ce(a,u,t)}static evaluateDate(a,u){return et(a,u)}static evaluateFunction(a,u,t){return Ie(a,u,t)}static lookup(a,u){let t=u[a];return t===void 0?null:t}static between(a,u,t){return a==null||u[0]==null||u[1]==null?null:k(a,u[0],">=")&&k(a,u[1],"<=")}static notbetween(a,u,t){return a==null||u[0]==null||u[1]==null?null:k(a,u[0],"<")||k(a,u[1],">")}static ternaryNot(a){return $e(a)}static ternaryAnd(a,u){return Lr(a,u)}static ternaryOr(a,u){return Rr(a,u)}},br=class i{constructor(a,u,t="UTC",l=null){this.fieldsIndex=u,this.timeZone=t,this.currentUser=l,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=Ve.parse(a);let{isStandardized:v,isAggregate:T,currentUserRequired:y,referencedFieldNames:N}=this._extractExpressionInfo(u);this._referencedFieldNames=N,this.isStandardized=v,this.isAggregate=T,this.currentUserRequired=y}static convertValueToStorageFormat(a,u=null){if(u===null)return H(a)?a.getTime():D(a)?a.toMillis():E(a)?a.toStorageFormat():b(a)?a.toStorageString():C(a)?a.toStorageFormat():a;switch(u){case"date":return H(a)?a.getTime():D(a)?a.toMillis():E(a)?a.toMilliseconds():C(a)?a.toNumber():a;case"date-only":return H(a)?z.fromDateJS(a).toString():E(a)?z.fromSqlTimeStampOffset(a).toString():D(a)?z.fromDateTime(a).toString():a;case"time-only":return H(a)?$.fromDateJS(a).toStorageString():D(a)?$.fromDateTime(a).toStorageString():E(a)?$.fromSqlTimeStampOffset(a).toStorageString():b(a)?a.toStorageString():a;case"timestamp-offset":if(H(a))return Z.fromJSDate(a).toStorageFormat();if(D(a))return Z.fromDateTime(a).toStorageFormat();if(E(a))return a.toStorageFormat()}return a}static create(a,u={}){return new i(a,u.fieldsIndex,u.timeZone??void 0,u.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(a,u=we,t=this.currentUser){return!!this._evaluateNode(this.parseTree,null,u,a,t)}calculateValue(a,u=we,t=this.currentUser){let l=this._evaluateNode(this.parseTree,a,u,null,t);return U.isInterval(l)?l.valueInMilliseconds()/864e5:l}calculateValueCompiled(a,u=we,t=this.currentUser){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):Ge("esri-csp-restrictions")?this.calculateValue(a,u):(this._compileMe(),this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}testFeature(a,u=we,t=this.currentUser){return!!this._evaluateNode(this.parseTree,a,u,null,t)}testFeatureCompiled(a,u=we,t=this.currentUser){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):Ge("esri-csp-restrictions")?this.testFeature(a,u):(this._compileMe(),!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,_(this.parseTree,a=>{a.type==="current-time"?this._hasDateFunctions=!0:a.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Oc.has(a.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){let a=new Set;return _(this.parseTree,u=>{u.type==="function"&&a.add(u.name.toLowerCase())}),Array.from(a)}getExpressions(){let a=new Map;return _(this.parseTree,u=>{if(u.type==="function"){let t=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){let v=l.column,T=`${t}-${v}`;a.has(T)||a.set(T,{aggregateType:t,field:v})}}}),[...a.values()]}getVariables(){let a=new Set;return _(this.parseTree,u=>{u.type==="parameter"&&a.add(u.value.toLowerCase())}),Array.from(a)}_compileMe(){let a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",a).bind(fe)}_extractExpressionInfo(a){let u=[],t=new Set,l=!0,v=!1,T=!1;return _(this.parseTree,y=>{switch(y.type){case"column-reference":{let N=a?.get(y.column),O,A;N?O=A=N.name??"":(A=y.column,O=A.toLowerCase()),t.has(O)||(t.add(O),u.push(A)),y.column=A;break}case"current-user":T=!0;break;case"function":{let{name:N,args:O}=y,A=O.value.length;l&&(l=Cr(N,A)),v===!1&&(v=We(N,A));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:v,currentUserRequired:T}}evaluateNodeToJavaScript(a){switch(a.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case"case-expression":{let u="";if(a.format==="simple"){let t=this.evaluateNodeToJavaScript(a.operand);u="( ";for(let l=0;l<a.clauses.length;l++)u+=" (this.compare('=',"+t+","+this.evaluateNodeToJavaScript(a.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(a.clauses[l].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}else{u="( ";for(let t=0;t<a.clauses.length;t++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[t].operand)+")===true ? ("+this.evaluateNodeToJavaScript(a.clauses[t].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(let t of a.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(t);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case"binary-expression":switch(a.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"IS":if(a.right.type!=="null")throw new d(f.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case"ISNOT":if(a.right.type!=="null")throw new d(f.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";default:throw new d(f.UnsupportedOperator,{operator:a.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(a.value);case"time":return"this.evaluateTime("+JSON.stringify(a.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(a.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(a.value)+", 'unknown')";case"current-time":return a.mode==="date"?"this.currentDate(timeZone)":a.mode==="time"?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(a.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+", timeZone)"}throw new d(f.UnsupportedSyntax,{node:a.type})}_evaluateNode(a,u,t,l,v){let T;switch(a.type){case"interval":{let y=this._evaluateNode(a.value,u,t,l,v);return U.createFromValueAndQualifier(y,a.qualifier,a.op)}case"case-expression":if(a.format==="simple"){let y=this._evaluateNode(a.operand,u,t,l,v);for(let N=0;N<a.clauses.length;N++)if(k(y,this._evaluateNode(a.clauses[N].operand,u,t,l,v),"=",this.timeZone))return this._evaluateNode(a.clauses[N].value,u,t,l,v);if(a.else!==null)return this._evaluateNode(a.else,u,t,l,v)}else{for(let y=0;y<a.clauses.length;y++)if(Pr(this._evaluateNode(a.clauses[y].operand,u,t,l,v)))return this._evaluateNode(a.clauses[y].value,u,t,l,v);if(a.else!==null)return this._evaluateNode(a.else,u,t,l,v)}return null;case"parameter":return T=this.parameters[a.value.toLowerCase()],H(T)?L.fromJSDate(T):T!=null&&typeof T=="object"&&"toDateTime"in T?T.toDateTime():T;case"expression-list":{let y=[];for(let N of a.value)y.push(this._evaluateNode(N,u,t,l,v));return y}case"unary-expression":return $e(this._evaluateNode(a.expr,u,t,l,v));case"binary-expression":switch(a.operator){case"AND":return Lr(this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v));case"OR":return Rr(this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v));case"IS":if(a.right.type!=="null")throw new d(f.UnsupportedIsRhs);return this._evaluateNode(a.left,u,t,l,v)===null;case"ISNOT":if(a.right.type!=="null")throw new d(f.UnsupportedIsRhs);return this._evaluateNode(a.left,u,t,l,v)!==null;case"IN":{let y=ot(this._evaluateNode(a.right,u,t,l,v));return ut(this._evaluateNode(a.left,u,t,l,v),y,this.timeZone)}case"NOT IN":{let y=ot(this._evaluateNode(a.right,u,t,l,v));return $e(ut(this._evaluateNode(a.left,u,t,l,v),y,this.timeZone))}case"BETWEEN":{let y=this._evaluateNode(a.left,u,t,l,v),N=this._evaluateNode(a.right,u,t,l,v);return y==null||N[0]==null||N[1]==null?null:k(y,N[0],">=",this.timeZone)&&k(y,N[1],"<=",this.timeZone)}case"NOTBETWEEN":{let y=this._evaluateNode(a.left,u,t,l,v),N=this._evaluateNode(a.right,u,t,l,v);return y==null||N[0]==null||N[1]==null?null:k(y,N[0],"<",this.timeZone)||k(y,N[1],">",this.timeZone)}case"LIKE":return st(this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v),a.escape);case"NOT LIKE":return $e(st(this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v),a.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return k(this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v),a.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return nt(a.operator,this._evaluateNode(a.left,u,t,l,v),this._evaluateNode(a.right,u,t,l,v),this.timeZone)}case"null":case"boolean":case"string":case"number":return a.value;case"date":return a.parsedValue??=et(a.value,"unknown"),a.parsedValue;case"timestamp":return a.parsedValue??=ce(a.value,"unknown"),a.parsedValue;case"time":return ve(a.value);case"current-time":return a.mode==="date"?fe.currentDate(this.timeZone):a.mode==="time"?fe.currentTime(this.timeZone):fe.currentTimestamp(this.timeZone);case"current-user":return v??null;case"column-reference":return Ur(u,a.column,this.fieldsIndex,t);case"data-type":return a.value;case"function":{if(this.isAggregate&&We(a.name,a.args.value.length)){let N=[];for(let O of a.args?.value||[]){let A=[];for(let P of l||[])A.push(this._evaluateNode(O,P,t,null,v));N.push(A)}return yr(a.name,N)}let y=this._evaluateNode(a.args,u,t,l,v);return Ie(a.name,y,this.timeZone)}}throw new d(f.UnsupportedSyntax,{node:a.type})}};function Pr(i){return i===!0}function ot(i){return Array.isArray(i)?i:[i]}function $e(i){return i!==null?i!==!0:null}function Lr(i,a){return i!=null&&a!=null?i===!0&&a===!0:i!==!1&&a!==!1&&null}function Rr(i,a){return i!=null&&a!=null?i===!0||a===!0:i===!0||a===!0||null}function ut(i,a,u){if(i==null)return null;let t=!1;for(let l of a)if(l==null)t=null;else{if(i===l){t=!0;break}if(qe(i)&&qe(l)&&(t=k(i,l,"="),t))break}return t}var Fr="-[]/{}()*+?.\\^$|",oe;function Nc(i,a){let u=a,t="",l=oe.Normal;for(let v=0;v<i.length;v++){let T=i.charAt(v);switch(l){case oe.Normal:T===u?l=oe.Escaped:Fr.includes(T)?t+="\\"+T:t+=T==="%"?".*":T==="_"?".":T;break;case oe.Escaped:Fr.includes(T)?t+="\\"+T:t+=T,l=oe.Normal}}return new RegExp("^"+t+"$","m")}function st(i,a,u){return i==null?null:Nc(a,u).test(i)}function Ac(i){return i&&typeof i.attributes=="object"}function Ur(i,a,u,t){if("getAttributeSQL"in t)return t.getAttributeSQL(i,a);let l=t.getAttribute(i,a),v=u?.get(a);return l==null||v?.type!=="esriFieldTypeDate"&&v?.type!=="date"?l==null||v?.type!=="esriFieldTypeDateOnly"&&v?.type!=="date-only"?l==null||v?.type!=="esriFieldTypeTimeOnly"&&v?.type!=="time-only"?l==null||v?.type!=="esriFieldTypeTimestampOffset"&&v?.type!=="timestamp-offset"?l:new Z(l):$.fromReader(l):z.fromReader(l):le(new Date(l),u?.getLuxonTimeZone(v.name)??Ir.utcInstance)}(function(i){i[i.Normal=0]="Normal",i[i.Escaped=1]="Escaped"})(oe||(oe={}));var we={getAttribute:(i,a)=>(Ac(i)?i.attributes:i)[a]};export{f as a,d as b,Z as c,yr as d,br as e};
