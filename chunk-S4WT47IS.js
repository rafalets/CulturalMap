import{D as de,a as We,f as Ke,g as Ue,h as Ne,i as je,k as qe,z as Ze}from"./chunk-TVN7IBCP.js";import"./chunk-ZEE52UAO.js";import"./chunk-4OC4J3KU.js";import"./chunk-MIOOILW6.js";import"./chunk-G6C3YEMS.js";import"./chunk-XSALJEMC.js";import"./chunk-IDLNQPT7.js";import"./chunk-VRPEURU5.js";import"./chunk-JAPGPEA6.js";import"./chunk-UFTHBQFR.js";import"./chunk-VU5W7W6Y.js";import{b as Ye,c as Je,d as Xe,f as me}from"./chunk-DQZJXCCL.js";import"./chunk-5PZVB26A.js";import{c as q,d as he}from"./chunk-G4BV3YO7.js";import"./chunk-QZT7QMTB.js";import{b as ue}from"./chunk-QW25UBG2.js";import"./chunk-OSKPIRVE.js";import"./chunk-2AZGC46B.js";import"./chunk-HR4LHAHO.js";import"./chunk-DJ6TVMFM.js";import"./chunk-3PSFVK5X.js";import"./chunk-A6AUN6JK.js";import"./chunk-OGTXAEI4.js";import"./chunk-QXCWUIQ2.js";import"./chunk-OC2XJJQU.js";import"./chunk-E6JHCD7G.js";import"./chunk-DIWV6SBV.js";import"./chunk-NSDBF4VB.js";import"./chunk-IL63CQ3W.js";import{c as Qe}from"./chunk-LK4L5XN7.js";import"./chunk-BYX5KLGZ.js";import"./chunk-5IRLA4AM.js";import"./chunk-AVLSWJCG.js";import"./chunk-FKL22O54.js";import"./chunk-IOI3V6WL.js";import"./chunk-IAM754TS.js";import{a as Z}from"./chunk-DLMQHZTF.js";import"./chunk-2XQT24NO.js";import"./chunk-PUWPAT3A.js";import"./chunk-Y4OUS3AZ.js";import{a as De,b as Fe}from"./chunk-CCGZQUKC.js";import"./chunk-7LVUNMSI.js";import"./chunk-5K5ZHVX6.js";import"./chunk-SNPAQLOL.js";import{b as $e}from"./chunk-LZ2LEOYK.js";import"./chunk-RXT2WPNA.js";import{a as He}from"./chunk-FHBFWDFD.js";import{c as Ve}from"./chunk-WBPLJNRU.js";import"./chunk-E2J2V7JN.js";import"./chunk-7X55A7Q6.js";import"./chunk-NFWLUI2Z.js";import"./chunk-WRYEUJBQ.js";import"./chunk-ELQ6TEDY.js";import"./chunk-JMMCRVVF.js";import{e as j}from"./chunk-ICWXUNPZ.js";import"./chunk-VC7OIMIK.js";import"./chunk-NIYDRLW4.js";import"./chunk-WTJO2NGM.js";import"./chunk-3Q427ME6.js";import"./chunk-3BZAI7HK.js";import"./chunk-LNYBTIG7.js";import"./chunk-EXXSZWI5.js";import"./chunk-6T37AWU6.js";import"./chunk-EOLWCIYR.js";import"./chunk-4AIH3WFI.js";import"./chunk-JOGV3DWE.js";import"./chunk-SKMO433W.js";import"./chunk-2FO7ARYZ.js";import"./chunk-NOQEJXLK.js";import"./chunk-DJW5LMRG.js";import"./chunk-QXXXCEV5.js";import"./chunk-QMKRRCM3.js";import"./chunk-TCGGI7DC.js";import"./chunk-ALWV3RJ2.js";import"./chunk-7C6Z24SS.js";import"./chunk-5WKDXHVH.js";import"./chunk-B5LBE5HD.js";import"./chunk-F6A6XWW4.js";import"./chunk-AESEF3B2.js";import"./chunk-PWU2QHPV.js";import"./chunk-WUJRCGDY.js";import"./chunk-QPGCDGIN.js";import"./chunk-PTZYZULI.js";import"./chunk-KZKWOEFD.js";import"./chunk-LNVVFNTC.js";import"./chunk-5TMYC5PF.js";import"./chunk-RCDSCJMH.js";import"./chunk-QJADLTFR.js";import"./chunk-IWPCZHB6.js";import"./chunk-FXCL7YYQ.js";import"./chunk-HX2BGUTP.js";import"./chunk-XSTBHERR.js";import"./chunk-KWZIB4M6.js";import"./chunk-YQPWWSMJ.js";import"./chunk-JEIB6WNP.js";import"./chunk-6JJCXUHW.js";import"./chunk-CVRJ6GOM.js";import"./chunk-X7QUUHRV.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-JR22Z7I2.js";import"./chunk-3QNSJ5HY.js";import"./chunk-UNVICPIE.js";import"./chunk-BGICKEJR.js";import"./chunk-TRZXSDYA.js";import"./chunk-OGS2SUK5.js";import"./chunk-TVHRLNTK.js";import"./chunk-JA3EMS2I.js";import{u as Ae}from"./chunk-HKHTIKVW.js";import"./chunk-XFESK2YB.js";import"./chunk-IJBTA53P.js";import"./chunk-ZHUXSQTN.js";import"./chunk-YLZWDFCJ.js";import"./chunk-TLMADEUL.js";import"./chunk-WNSGKHQ6.js";import"./chunk-J5MXC6AL.js";import{d as Re}from"./chunk-OLOKUDVI.js";import"./chunk-RJWOVI3M.js";import{b as Ge,c as Be,d as ze,e as ie,f as re,g as ce}from"./chunk-MDL4XPLR.js";import"./chunk-AZS4Q4RE.js";import"./chunk-QEBUS3TL.js";import"./chunk-IB2IUO7T.js";import"./chunk-MS3KE2OO.js";import"./chunk-NHSDW26F.js";import"./chunk-NMAGYK3Q.js";import"./chunk-GWBRHLNH.js";import"./chunk-WKJJQIBC.js";import"./chunk-VDADRLEF.js";import"./chunk-J372WZPB.js";import"./chunk-6XFS4U2F.js";import"./chunk-XPRVY6JT.js";import{h as Le}from"./chunk-7N3ZKWML.js";import{i as ke}from"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import{a as Se,h as xe,j as Ee,k as Ie,u as Pe,x as pe}from"./chunk-3SDSCSDJ.js";import"./chunk-I4M2OT5W.js";import{n as Oe}from"./chunk-NTVLK3P2.js";import"./chunk-WMQNRNIU.js";import"./chunk-HD52PWPC.js";import"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-MDSLION2.js";import{c as x,d as C,e as I}from"./chunk-7ZYPJJID.js";import{g as c,h as oe}from"./chunk-UAKHZRKN.js";import{f as Ce}from"./chunk-HAHX77IL.js";import{a as ae}from"./chunk-IXCTZWTQ.js";import"./chunk-6PN3I333.js";import"./chunk-ZTJLFKGG.js";import"./chunk-5TW726OD.js";import"./chunk-VGD3XLDH.js";import{a as B,b as Me,i as le}from"./chunk-LB5YQINJ.js";import{b as te}from"./chunk-EKMHQEJY.js";import{a as N}from"./chunk-VACZNAP3.js";import{e as Te}from"./chunk-JKNCWG7E.js";import"./chunk-SLAWDKDA.js";import"./chunk-KTE5HCNJ.js";import"./chunk-F7VRLFCB.js";import"./chunk-7IPIJKWU.js";import"./chunk-7R33MKVL.js";import{a as we}from"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import"./chunk-U4J5SECU.js";import"./chunk-7EG726PT.js";import{L as ee,d as n,g as K}from"./chunk-C7INQGWT.js";import{H as m}from"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import{B as X,D as G,M as be,a as J,d as W,i as U,k as R,z as _e}from"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import{a as r}from"./chunk-QGVBCWUY.js";import{r as L}from"./chunk-HHDFN2GK.js";import{t as Y}from"./chunk-47GHT6OF.js";import"./chunk-5RWLLGQU.js";import{a as v,b as S,f as _}from"./chunk-VTHXE323.js";var f={groupSeparator:1,action:{s:32,m:48,l:64},splitButtonPart:{horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}}},se={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function ge(e,t){return e.vnodeSelector===t?[e]:e.children?.flatMap(i=>ge(i,t))??[]}var Q=e=>{let t=class extends e{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){this.measurementManager?.managedElements.remove(this),this.measurementManager=null}set measurementManager(i){let o=this._get("measurementManager");i!==o&&(o&&o.managedElements.remove(this),this._set("measurementManager",i),i?.managedElements.add(this))}set budgetedLength(i){this.budgetedLength!==i&&(this._set("budgetedLength",i),this.scheduleRender())}get actionChildren(){return this.children?.flatMap(i=>ge(i,"calcite-action"))??[]}get activeChildElement(){let i=this.actionChildren.find(o=>o.properties?.active===!0);return i?(this._set("lastActiveKey",i.properties?.key),i):this.lastActiveKey?this.actionChildren.find(o=>o.properties?.key===this.lastActiveKey):void 0}_handleClick(i){i?.dataset&&"dataset"in i&&i.dataset.actionKey&&(this.lastActiveKey=i.dataset.actionKey)}};return r([n()],t.prototype,"priority",void 0),r([n()],t.prototype,"measurementManager",null),r([n()],t.prototype,"budgetedLength",null),r([n()],t.prototype,"actionChildren",null),r([n()],t.prototype,"activeChildElement",null),r([n()],t.prototype,"scale",void 0),r([n()],t.prototype,"slot",void 0),r([n()],t.prototype,"lastActiveKey",void 0),r([n()],t.prototype,"layout",void 0),t=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],t),t};var et=Symbol("on-resize-handle-key"),D=class extends Q(C){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return[this.layout==="horizontal"?this._measuredWidth:this._measuredHeight]}render(){return c("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles(Ce(this._measuredElement,()=>{this._measuredWidth=this._measuredElement?.clientWidth??0,this._measuredHeight=this._measuredElement?.clientHeight??0}),et)},afterRemoved:()=>this.removeHandles(et)},this.children)}};r([n()],D.prototype,"_measuredWidth",void 0),r([n()],D.prototype,"_measuredHeight",void 0),r([n()],D.prototype,"lengthOptions",null),r([n()],D.prototype,"_measuredElement",void 0),D=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],D);var tt=D;var z=class extends Q(C){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return x({action:()=>import("./chunk-CXZZQXIM.js"),"action-group":()=>import("./chunk-ULFRJWQP.js"),"action-menu":()=>import("./chunk-O5BPNJF3.js")})}get minimumLength(){let{actionChildren:e,scale:t}=this;return e.length?this.allowCollapse?f.groupSeparator+f.action[t]*Math.min(e.length,2):f.groupSeparator+f.action[t]*e.length:0}get lengthOptions(){let{actionChildren:e,scale:t,minimumLength:i,allowCollapse:o,priority:s}=this,a=[i];if(e.length<=2||!o||s<1)return a;for(let l=1;l<e.length-1;l++)a.push(i+f.action[t]*l);return a}render(){if(!this.actionChildren.length)return c(oe,null,void 0);let{budgetedLength:e,actionChildren:t,activeChildElement:i,layout:o,slot:s,scale:a}=this,l=Math.floor(e/f.action[a]),p=[],d=[];if(l>=t.length)p.push(...t);else{let h=i??p.at(0);if(p.push(...t.slice(0,l-1)),d.push(...t.slice(l-1)),h&&d.includes(h)){let[g]=d.splice(d.indexOf(h),1),w=p.pop();p.push(g),w&&d.unshift(w)}}return c("calcite-action-group",{key:"overflow-button-group",layout:o,onclick:h=>this._handleClick(h.target),slot:s},p.map(h=>this._renderManagedAction(h)),d.length>0?c("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},c("calcite-action",{icon:se.overflow,key:"split-button-dropdown-trigger",scale:a,slot:"trigger",text:this.messagesCommon.more}),d.map(h=>this._renderManagedAction(h))):void 0)}_renderManagedAction(e){return c("calcite-action",S(v({},e?.properties),{"data-action-key":e?.properties?.key,text:e?.properties?.text??""}))}};z.vnodeSelector="calcite-action-group",r([n()],z.prototype,"allowCollapse",void 0),r([n()],z.prototype,"minimumLength",null),r([n(),I("esri/t9n/common")],z.prototype,"messagesCommon",void 0),r([n()],z.prototype,"lengthOptions",null),z=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],z);var ot=z;var A=class extends ee{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new te,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver(()=>{this._measure()})}get _sortedElements(){return[...this.managedElements].sort((e,t)=>t.priority-e.priority)}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){let e=new Map,{availableLength:t,_sortedElements:i}=this,o=0;for(let s of i){let a=s.lengthOptions[0];e.set(s,a),o+=a}for(let s of i)for(;o<t;){let a=e.get(s);if(!a)break;let l=s.lengthOptions.find(d=>d>a);if(!l)break;let p=o-a+l;if(p>t)break;e.set(s,l),o=p}for(let[s,a]of e)s.budgetedLength=a}_measure(){let e=this.measuredElement;this.availableLength=e?this.layout==="horizontal"?e.clientWidth??0:e.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};r([n()],A.prototype,"measuredElement",void 0),r([n()],A.prototype,"managedElements",void 0),r([n()],A.prototype,"_sortedElements",null),r([n()],A.prototype,"availableLength",void 0),r([n()],A.prototype,"layout",void 0),A=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],A);var it=A;var ht={base:"esri-split-button",splitButtonBase:"esri-split-button--split-part"},H=class extends Q(C){constructor(e){super(e),this.messagesCommon=null}loadDependencies(){return x({action:()=>import("./chunk-CXZZQXIM.js"),"action-group":()=>import("./chunk-ULFRJWQP.js"),"action-menu":()=>import("./chunk-O5BPNJF3.js")})}get minimumLength(){let e=this.actionChildren;return e.length?e.length===1?f.action[this.scale]+f.groupSeparator:f.action[this.scale]+f.splitButtonPart[this.layout][this.scale]+f.groupSeparator:0}get lengthOptions(){let{actionChildren:e,minimumLength:t,layout:i,scale:o,priority:s}=this;if(e.length<2||s<0)return[t];let a=f.groupSeparator+f.action[o]*e.length;return[f.groupSeparator+f.action[o]+f.splitButtonPart[i][o],a]}render(){if(!this.actionChildren.length)return c(oe,null,void 0);let{actionChildren:e,minimumLength:t,budgetedLength:i,layout:o,slot:s}=this,a=e.length<2||i>t;return c("calcite-action-group",{key:"split-button-group",layout:o,onclick:l=>this._handleClick(l.target),slot:s},a?this._renderUnSplit():this._renderSplit())}_renderSplit(){let{activeChildElement:e,layout:t,actionChildren:i,scale:o,messagesCommon:s}=this,a=e??i.at(0);if(!a)return;let l=i.filter(p=>p!==a);return[this._renderManagedAction(a),c("calcite-action-menu",{key:"split-button-dropdown",label:s.more,overlayPositioning:"fixed",placement:t==="horizontal"?"bottom-end":"right-end"},c("calcite-action",{class:`${ht.splitButtonBase}--${t}--${this.scale}`,compact:t==="horizontal",icon:se.splitButton[t],key:"split-button-dropdown-trigger",scale:o,slot:"trigger",text:s.more}),l?.map(p=>this._renderManagedAction(p)))]}_renderUnSplit(){return this.actionChildren.map(e=>this._renderManagedAction(e))}_renderManagedAction(e){return c("calcite-action",S(v({},e?.properties),{"data-action-key":e?.properties?.key,text:e?.properties?.text??""}))}};H.vnodeSelector="calcite-action-group",r([n()],H.prototype,"minimumLength",null),r([n()],H.prototype,"lengthOptions",null),r([n(),I("esri/t9n/common")],H.prototype,"messagesCommon",void 0),H=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],H);var O="esri-responsive-toolbar",k={rulerBase:`${O}__ruler`,rulerBarHorizontal:`${O}__ruler--bar`,rulerBarVertical:`${O}__ruler--bar--vertical`,rulerPadVertical:`${O}__ruler--pad--vertical`,rulerPadHorizontal:`${O}__ruler--pad--horizontal`,bar:`${O}__bar`,barHorizontal:`${O}__bar--horizontal`,barVertical:`${O}__bar--vertical`,pad:`${O}__pad`,padVertical:`${O}__pad--vertical`,padHorizontal:`${O}__pad--horizontal`},$=class extends C{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new it,this._managedWidgets=new Map}loadDependencies(){return x({"action-bar":()=>import("./chunk-J5KVU72X.js"),"action-pad":()=>import("./chunk-2EFTH4VX.js")})}destroy(){this._measurementManager=U(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){let t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}render(){let{layout:e,scale:t,barStyle:i}=this,o={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},s=i==="docked"?e==="vertical"?k.rulerBarVertical:k.rulerBarHorizontal:e==="horizontal"?k.rulerPadHorizontal:k.rulerPadVertical;return c("div",null,c("div",{afterCreate:a=>{this._measurementManager?.connect(a)},class:this.classes(k.rulerBase,s)}),i==="docked"?c("calcite-action-bar",S(v({},o),{classes:{[k.barHorizontal]:this.layout==="horizontal",[k.barVertical]:this.layout==="vertical",[k.bar]:!0},overflowActionsDisabled:!0}),this._renderChildren()):c("calcite-action-pad",S(v({},o),{class:this.classes(k.pad,e==="horizontal"?k.padHorizontal:k.padVertical)}),this._renderChildren()))}_renderChildren(){if(!this.children)return;let e=this.children.filter(o=>o.properties?.key!==void 0&&"group-kind"in o.properties),t=new Set,i=e.map(o=>{let s=o.properties,a=s.key;t.add(a);let l=this.barStyle==="docked"?s.slot??void 0:void 0,p=s.priority??0,d=s["group-kind"]??"overflow-group",h=s["allow-collapse"]??!0,g=this._managedWidgets.get(a);if(g)return g.children=o.children,g.priority=p,"allowCollapse"in g&&(g.allowCollapse=h),g.slot=l,g.layout=this.layout,g.scale=this.scale,g.measurementManager=this._measurementManager,g;let w={scale:this.scale,priority:p,measurementManager:this._measurementManager,children:o.children,slot:l,layout:this.layout};switch(d){case"split-button":{let M=new H(v({},w));return this._managedWidgets.set(a,M),M}case"overflow-group":{let M=new ot(S(v({},w),{allowCollapse:h}));return this._managedWidgets.set(a,M),M}case"measured-content":{let M=new tt(v({},w));return this._managedWidgets.set(a,M),M}}}).filter(Y);return Array.from(this._managedWidgets.keys()).filter(o=>!t.has(o)).forEach(o=>{this._managedWidgets.get(o)?.destroy(),this._managedWidgets.delete(o)}),this._measurementManager?.allocate(),i.map(o=>o.render())}};r([n()],$.prototype,"scale",void 0),r([n({value:"horizontal"})],$.prototype,"layout",null),r([n()],$.prototype,"barStyle",void 0),r([n()],$.prototype,"_measurementManager",void 0),r([n()],$.prototype,"_managedWidgets",void 0),$=r([m("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],$);var ye=$;var b=class extends ee{constructor(e){super(e),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){let e=this.strokeColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _strokeBackgroundStyle(){let e=this.strokeDashColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _fillStyle(){let e=this.fillColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _renderCoordinates(){let e=[];if(!this.coordinates)return{coordinates:e,rect:pe};let t=Pe(xe(Se(pe),this.coordinates),2*this.strokeWidth);t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]+.5),t[3]=Math.ceil(t[3]+.5);for(let i of this.coordinates)e.push([Math.floor(i[0]-t[0])+.5,Math.floor(i[1]-t[1])+.5]);return e.reverse(),{coordinates:e,rect:t}}render(){let{coordinates:e,rect:t}=this._renderCoordinates,i=Ee(t),o=Ie(t);return c("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:t[0]+"px",top:t[1]+"px",width:i+"px",height:o+"px",visibility:this.visible?"visible":"hidden"}},c("svg",{height:o,styles:{display:"block"},width:i},c("polygon",{fill:this._fillStyle,points:e.map(([s,a])=>`${s},${a}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),c("polygon",{fill:"transparent",points:e.map(([s,a])=>`${s},${a}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};r([n()],b.prototype,"coordinates",void 0),r([n()],b.prototype,"strokeDash",void 0),r([n()],b.prototype,"strokeWidth",void 0),r([n()],b.prototype,"strokeColor",void 0),r([n()],b.prototype,"strokeDashColor",void 0),r([n()],b.prototype,"fillColor",void 0),r([n()],b.prototype,"visible",void 0),r([n()],b.prototype,"isDecoration",void 0),r([n({readOnly:!0})],b.prototype,"_strokeStyle",null),r([n({readOnly:!0})],b.prototype,"_strokeBackgroundStyle",null),r([n({readOnly:!0})],b.prototype,"_fillStyle",null),r([n({readOnly:!0})],b.prototype,"_renderCoordinates",null),b=r([m("esri.views.overlay.OutlineOverlayItem")],b);var rt=b;var T=class extends N.EventedMixin(qe){constructor(e){super(e),this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();let e=t=>this.drawOperation.on(t,i=>{this._updateVisuals(),this.emit(t,i)});this.addHandles([e("vertex-add"),e("vertex-remove"),e("vertex-update"),e("cursor-update"),e("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=U(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centeredToggled(e){this._set("centeredToggled",e),this._updateVisuals()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set uniformSizeToggled(e){this._set("uniformSizeToggled",e),this._updateVisuals()}get updating(){return this.drawOperation?.updating??!1}get cursor(){return this.geometryType==="point"?"default":"crosshair"}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.destroyed||this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}undo(){this.drawOperation.undo()}reset(){}_makeDrawOperation(){let{view:e}=this;return new Ze({view:e,manipulators:this.manipulators,geometryType:mt(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new de,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor})}get coordinates(){let{drawOperation:e}=this;if(!e?.geometryIncludingUncommittedVertices.length)return[];let{coordinateHelper:t}=e,i=e.committableVertex,o=e.committedVertices.slice();i!=null&&o.push(t.pointToArray(i));let s=o.length;switch(this.geometryType){case"circle":case"rectangle":{let a=new We(Ve,de.spatialReference),l=this.geometryType==="circle"?Ne:Ke,p=this.geometryType==="circle"?je:Ue;if(s===1&&e.isCompleted){let d=o[0],h=a.makeMapPoint(d[0]+gt,d[1]);return l([d,h],a,!0)?.geometry.rings[0]??[]}if(s===2){let d=this.geometryType!=="rectangle",h=this.centeredToggled!==d,g=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==g?l(o,a,h)?.geometry.rings[0]:p(o,a,h)?.geometry.rings[0])??[]}return[]}}return o}_updateVisuals(){if(!this._overlayItem){let e=new rt({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(e),this.addHandles(J(()=>{this.view.overlay?.removeItem(e),e?.destroy(),this._overlayItem=void 0})),this._overlayItem=e}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}};function mt(e){switch(e){case"polygon":case"point":return e;case"circle":case"rectangle":return"segment"}}r([n({value:!1})],T.prototype,"centeredToggled",null),r([n()],T.prototype,"drawOperation",void 0),r([n({value:!0})],T.prototype,"enabled",null),r([n({value:!1})],T.prototype,"uniformSizeToggled",null),r([n({constructOnly:!0})],T.prototype,"geometryType",void 0),r([n({constructOnly:!0})],T.prototype,"mode",void 0),r([n({readOnly:!0})],T.prototype,"type",void 0),r([n({readOnly:!0})],T.prototype,"updating",null),r([n({constructOnly:!0,nonNullable:!0})],T.prototype,"view",void 0),r([n()],T.prototype,"cursor",null),T=r([m("esri.views.draw.DrawScreenTool")],T);var gt=48;function yt(){return _(this,null,function*(){return import("./chunk-FOYQ56X5.js")})}function vt(){return _(this,null,function*(){return yt().then(({contains:e,intersects:t,overlaps:i,simplify:o})=>({contains:e,intersects:t,overlaps:i,simplify:o}))})}function nt(e){return _(this,null,function*(){let{currentSelection:t,selector:i,signal:o,sources:s,view:a}=e;if(!s?.length)return{added:[],removed:[]};let{layers:l,layerViews:p,graphicsLayers:d}=wt(s),h=(yield X(Promise.all([_t(i,l,a,o),bt(i,p,a,o),ft(i,d,a)]),o)).flat();if(!t)return{added:h,removed:[]};let g=t.toArray(),w=h.filter(ne=>!st(g,ne)),M=g.filter(ne=>!st(h,ne));return t.removeMany(M),t.addMany(w),{added:w,removed:M}})}var ft=(e,t,i)=>_(void 0,null,function*(){return Ot({candidates:t.flatMap(o=>o.graphics.toArray())??[],selector:e,view:i})}),_t=(e,t,i,o)=>_(void 0,null,function*(){let s=yield G(Mt({selector:e,signal:o,layers:t,view:i}));return s?at(s):[]}),bt=(e,t,i,o)=>_(void 0,null,function*(){let s=yield G(Tt({selector:e,signal:o,layerViews:t,view:i}));return s?at(s):[]});function at(e){let t=[];for(let i=0;i<e.length;i++){let o=e[i];o.status==="fulfilled"&&t.push(...o.value)}return t}function wt(e){let t=[],i=[],o=[];return e.forEach(s=>{Ge(s)?t.push(s):(ie(s)||re(s))&&s.layers?.length?t.push(...s.layers.toArray()):ze(s)&&s.sublayers?.length?o.push(...s.sublayers.toArray()):Be(s)?o.push(s):j(s)&&i.push(s)}),{layers:t,layerViews:i,graphicsLayers:o}}function st(e,t){if(e.includes(t))return!0;let i=t.getObjectId(),o=i!=null,{layer:s,uid:a}=t;return o?e.some(l=>{if(s===l.layer)return i===l.getObjectId()}):e.some(l=>{if(s===l.layer)return a===l.uid})}function Tt(e){return _(this,null,function*(){let{layerViews:t,selector:i,signal:o,view:s}=e;return X(Promise.allSettled(t.map(a=>_(this,null,function*(){let l=a.createQuery(),{geometry:p}=lt(i,a.layer,s);return l.outFields=["*"],l.geometry=p,l.returnGeometry=!0,l.outSpatialReference=s.spatialReference,a.queryFeatures(l,{signal:o}).then(({features:d})=>d)}))),o)})}function Mt(e){return _(this,null,function*(){let{layers:t,selector:i,signal:o,view:s}=e;return X(Promise.allSettled(t.map(a=>_(this,null,function*(){return a.queryFeatures(Ct(a.createQuery(),i,a,s),{signal:o}).then(({features:l})=>l)}))),o)})}function lt(e,t,i){let o="renderer"in t?De({renderer:t.renderer}):0,s=e.type==="point"?Fe(e,o,i):e,a="displayField"in t?t.displayField:null,l=Ae({displayField:a,fields:t.fields}),p=[t.objectIdField];if(l!=null&&t.fieldsIndex.has(l)&&p.push(l),"globalIdField"in t&&t.globalIdField!=null&&t.fieldsIndex.has(t.globalIdField)&&p.push(t.fieldsIndex.get(t.globalIdField).name),ce(t)&&t.subtypeField!=null&&t.fieldsIndex.has(t.subtypeField)&&p.push(t.fieldsIndex.get(t.subtypeField).name),"utilityNetworks"in i.map&&i.map.utilityNetworks?.length&&(ce(t)||t.type==="feature")){let d=t.fieldsIndex.get("assetgroup"),h=t.fieldsIndex.get("assettype");d?.name&&p.push(d.name),h?.name&&p.push(h.name)}return{geometry:s,outFields:p}}function Ct(e,t,i,o){let{outFields:s,geometry:a}=lt(t,i,o);return e.outFields=s,e.geometry=a,e.returnGeometry=!0,e.outSpatialReference=o.spatialReference,e}function Ot(e){return _(this,null,function*(){let{selector:t,candidates:i,view:o}=e;if(!i?.length||!t)return[];let{spatialReference:s}=o,a=t,l=yield vt();return i.filter(p=>p.geometry&&p.geometry.type!=="mesh"&&l.intersects(s,a,p.geometry))})}var kt=100,F=class extends N.EventedAccessor{constructor(e){super(e),this._processTask=null,this.options=null,this.selection=new te,this.sources=null,this._process=be((t,i)=>_(this,null,function*(){let{callback:o,selector:s,completed:a}=t,l=Te(p=>_(this,null,function*(){let{options:d,sources:h,selection:g,view:w}=this;if(!(!h?.length&&!w?.selectionManager.sources.length)&&w){if(s&&h!=null){let M=yield nt({currentSelection:g,selector:s,signal:p,sources:h,view:w});a&&d?.persistSelection!==!1&&w.selectionManager?.updateSelection(v({current:g.toArray()},M))}o&&o()}else g.removeAll()}));return _e(i,()=>l.abort()),this._processTask=l,l.promise}),kt)}initialize(){this._setup()}cancel(){this.removeAllHandles(),this._processTask?.abort()}_setup(){return _(this,null,function*(){let{view:e}=this;if(yield e.whenReady(),this.destroyed)return;let t=this.options,i=t?.createTool??"rectangle",o=t?.mode??(i==="polygon"?"click":"hybrid"),s=Symbol();this._tool=new T({view:e,mode:o,geometryType:i}),t?.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],()=>G(this._process({selector:this._selectionArea}))),s),this.addHandles([e.on("key-down",a=>{if(!a.repeat)switch(a.key){case Z.constraint:this._tool.uniformSizeToggled=!0,a.stopPropagation();break;case Z.center:this._tool.centeredToggled=!0,a.stopPropagation()}}),e.on("key-up",a=>{switch(a.key){case Z.constraint:this._tool.uniformSizeToggled=!1,a.stopPropagation();break;case Z.center:this._tool.centeredToggled=!1,a.stopPropagation()}}),this._tool.on("complete",a=>_(this,null,function*(){this.removeHandles(s);let l=()=>{this.removeAllHandles(),this.emit("complete",{aborted:a.aborted,selection:this.selection.toArray()})};a.aborted?(this.cancel(),this.selection.removeAll(),l()):yield this._process({selector:this._selectionArea,callback:l,completed:!0})}))],s),this.addHandles(J(()=>e.tools.remove(this._tool))),e.addAndActivateTool(this._tool)})}get _selectionArea(){let e=Re(),t=this._tool.coordinates,i=this.view.spatialReference,o=a=>{e.x=a[0],e.y=a[1];let{x:l,y:p}=this.view.toMap(e);return[l,p]};if(t.length===0)return;if(t.length===1||t.every(([a,l])=>a===t[0][0]&&l===t[0][1])){let[a,l]=o(t[0]);return new Oe({x:a,y:l,spatialReference:i})}let s=t.map(o);if(s.length!==0)return ke(s)||s.reverse(),new Le({spatialReference:i,rings:[s]})}};r([n()],F.prototype,"options",void 0),r([n({readOnly:!0})],F.prototype,"selection",void 0),r([n()],F.prototype,"sources",void 0),r([n({constructOnly:!0})],F.prototype,"view",void 0),F=r([m("esri.widgets.support.Selector2D.SelectionOperation")],F);var pt=F;var E=class extends N.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.layerViewPreferenceEnabled=!0,this.sources=null}initialize(){this.addHandles([B(()=>this._sources,e=>{this.activeOperation&&(this.activeOperation.sources=e)})])}destroy(){this._operationHandlesGroup=R(this._operationHandlesGroup)}get _sources(){let{layerViewPreferenceEnabled:e,sources:t,view:i}=this;return i&&t?.length?t.flatMap(o=>{if(j(o))return o;if(ie(o)||re(o)){let a=o.layers||[],l=a.map(p=>{let d=ue(i,p)||void 0;return e&&j(d)?d:p});return l.length?l.toArray():a.length?a.toArray():o}if(!e)return o;let s=ue(i,o)||void 0;return j(s)?s:o}):[]}get layers(){return K(L.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){K(L.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){let{_sources:e,view:t}=this,i=!e?.length&&!t?.selectionManager.sources.length;return this.activeOperation?"active":t?.ready&&!i?"ready":"disabled"}cancel(){this.state==="active"&&(this.activeOperation?.cancel(),this._set("activeOperation",null))}activate(e){let{_sources:t,state:i,view:o}=this,s=!t?.length&&!o?.selectionManager.sources.length;if(i==="disabled"||s||!this.view)return;i==="active"&&this.cancel();let a=new pt({view:this.view,sources:t,options:e});return this._operationHandlesGroup=W([a.selection.on("change",l=>this.emit("selection-change",l)),a.once("complete",l=>this._onOperationComplete(l))]),this._set("activeOperation",a),a}_onOperationComplete(e){this._operationHandlesGroup=R(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e)}};r([n()],E.prototype,"_sources",null),r([n({readOnly:!0})],E.prototype,"activeOperation",void 0),r([n()],E.prototype,"layers",null),r([n()],E.prototype,"layerViewPreferenceEnabled",void 0),r([n()],E.prototype,"sources",void 0),r([n({readOnly:!0})],E.prototype,"state",null),r([n()],E.prototype,"view",void 0),E=r([m("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],E);var ct=E;var dt={lassoTool:!0,rectangleTool:!0},ve="esri-selection-toolbar",fe={base:ve,container:`${ve}__container`,toolButton:`${ve}__tool-button`},y=class extends C{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.defaultLassoToolOptions={createTool:"polygon",mode:"freehand"},this.defaultRectangleToolOptions={createTool:"rectangle"},this.messages=null,this.toolConfigs=[],this.viewModel=new ct,this.visibleElements=v({},dt),this.scale="s",this.layout="horizontal",this._viewModelHandlesGroup=W([this.viewModel.on("complete",i=>{this._set("activeToolInfo",null),this.emit("complete",i)})])}destroy(){this._viewModelHandlesGroup=R(this._viewModelHandlesGroup)}loadDependencies(){return x({action:()=>import("./chunk-CXZZQXIM.js")})}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layers(){return K(L.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){K(L.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(e){this.viewModel.layerViewPreferenceEnabled=e}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return v(v({},dt),e)}get state(){return this.viewModel.state}get visibleToolCount(){let{view:e,toolConfigs:t,visibleElements:i}=this;return(t?.length??0)+(e?.type==="2d"?(i.lassoTool?1:0)+(i.rectangleTool?1:0):0)}activate(e){if(this.cancel(),this.state!=="disabled")switch(e){case"lasso":this._activateTool("lasso");break;case"rectangle":this._activateTool("rectangle");break;default:this._activateTool(e)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return c("div",{"aria-label":this.label,class:this.classes(fe.base,He.widget)},c("div",{class:fe.container},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){if(this.view?.type==="2d")return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){if(this.toolConfigs?.length)return this.toolConfigs.map(({toolName:e,icon:t,toolKey:i})=>this._renderToolWithTooltip(e,i,t))}_renderLassoTool(){let{messages:e,visibleElements:t}=this;if(!t.lassoTool)return;let i=e.selectByLasso;return this._renderToolWithTooltip("lasso","lasso","lasso-select",i)}_renderRectangleTool(){let{messages:e,visibleElements:t}=this;if(!t.rectangleTool)return;let i=e.selectByRectangle;return this._renderToolWithTooltip("rectangle","rectangle","cursor-marquee",i)}_renderToolWithTooltip(e,t,i,o=e){let s=`${this.id}-tool-${t}`;return c("calcite-action",{active:this.activeToolInfo?.toolName===e,bind:this,class:fe.toolButton,disabled:this.state==="disabled",icon:i||"selection",id:s,key:s,onclick:()=>this._toggleTool(e),scale:this.scale,text:o,title:o})}_activateTool(e){let t=this._getToolOptions(e);if(!t)return;let i=this.viewModel.activate(t);i&&this._set("activeToolInfo",{toolName:e,operation:i})}_toggleTool(e){if(this.activeToolInfo){let t=this.activeToolInfo.toolName;if(this.cancel(),t===e)return}this._activateTool(e)}_getToolOptions(e){return e==="lasso"?this.defaultLassoToolOptions:e==="rectangle"?this.defaultRectangleToolOptions:this.toolConfigs.find(t=>t.toolName===e)}};r([n({readOnly:!0})],y.prototype,"activeToolInfo",void 0),r([n()],y.prototype,"defaultLassoToolOptions",void 0),r([n()],y.prototype,"defaultRectangleToolOptions",void 0),r([n()],y.prototype,"label",null),r([n()],y.prototype,"layers",null),r([n()],y.prototype,"layerViewPreferenceEnabled",null),r([n(),I("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],y.prototype,"messages",void 0),r([n()],y.prototype,"sources",null),r([n()],y.prototype,"toolConfigs",void 0),r([n()],y.prototype,"view",null),r([n()],y.prototype,"viewModel",void 0),r([n()],y.prototype,"visibleElements",void 0),r([we("visibleElements")],y.prototype,"castVisibleElements",null),r([n()],y.prototype,"scale",void 0),r([n()],y.prototype,"state",null),r([n()],y.prototype,"layout",void 0),r([n()],y.prototype,"visibleToolCount",null),y=r([m("esri.widgets.support.SelectionToolbar")],y);var ut=y;var V="esri-sketch",P={base:V,vertical:`${V}--vertical`,docked:`${V}-bar`,floating:`${V}-pad`,chipHorizontal:`${V}__selection-count-chip--horizontal`,chipVertical:`${V}__selection-count-chip--vertical`,chipVerticalSmall:`${V}__selection-count-chip--vertical--s`,popoverWrapper:`${V}__popover-wrapper`},St={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3-d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"},u=class extends C{constructor(e,t){super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new me,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=e?.viewModel||(this._defaultViewModel=new he({creationMode:e?.creationMode??"continuous"}))}initialize(){let{layer:e,view:t}=this,i=new ut({view:t?.type==="2d"?t:null,sources:e?[e]:null,scale:this.scale});this.addHandles([B(()=>this.viewModel,o=>{this._viewModelHandlesGroup=R(this._viewModelHandlesGroup),o&&(this._viewModelHandlesGroup=W([o.on("create",()=>this.scheduleRender()),o.on("update",()=>this.scheduleRender()),o.on("delete",s=>this.emit("delete",s)),o.on("undo",()=>this.scheduleRender()),o.on("redo",()=>this.scheduleRender()),B(()=>o.layer,s=>{this._selectionToolbar&&(this._selectionToolbar.sources=s?[s]:null)}),B(()=>o.view,s=>{this._selectionToolbar&&(this._selectionToolbar.view=s?.type==="2d"?s:null)}),B(()=>o.state,()=>this.notifyChange("state"))]))},le),Me(()=>i.activeToolInfo,()=>this.viewModel.cancel()),i.on("complete",o=>this._onSelectionOperationComplete(o)),B(()=>{let{selectionTools:o}=this.visibleElements;return{lassoTool:!!o?.["lasso-selection"],rectangleTool:!!o?.["rectangle-selection"]}},o=>{Object.assign(i.visibleElements,o)},le)]),this._selectionToolbar=i}loadDependencies(){return x({action:()=>import("./chunk-CXZZQXIM.js"),chip:()=>import("./chunk-KUULEAF3.js"),popover:()=>import("./chunk-QY326AOF.js")})}destroy(){this._selectionToolbar?.destroy(),this._viewModelHandlesGroup=R(this._viewModelHandlesGroup)}get activeTool(){let e=this._selectionToolbar?.activeToolInfo;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}let t=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:o}=this.viewModel;return i==="polygon"&&o==="freehand"&&t?.includes("freehandPolygon")?"freehandPolygon":i==="polyline"&&o==="freehand"&&t?.includes("freehandPolyline")?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){let t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&U(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){let{availableCreateTools:e,view:t,visibleElements:i}=this,o=e?.filter(s=>!!i.createTools?.[s]);return t?.type==="3d"?o?.filter(s=>s!=="multipoint"):o}create(e,t,i){let o=i?.createOptions??t;return this._activeCustomToolOptions=i,G(this.viewModel.create(e,o))}update(e,t){return G(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){let{toolbarKind:e,layout:t,scale:i}=this,o=this.customActions?.filter(s=>s.position==="selection-toolbar");return c("div",null,c("div",{classes:{[P.base]:!0,[P.floating]:e==="floating",[P.docked]:e==="docked",[P.vertical]:t==="vertical"}},c(ye,{barStyle:e,layout:t,scale:i},this._renderSelectionSetItemGroupInline(),c("div",{"group-kind":"split-button",key:"selection-split-button",priority:this.groupCollapsePriorities?.get("selectionTools")??q.Low},this._renderDefaultSelectionButton(),this._selectionToolbar?.render(),o?.map(s=>this._renderToolbarItem(s))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){let{messagesCommon:e,snappingOptions:t,view:i,viewModel:o,visibleElements:s}=this;if(!this._calcitePopoverReferenceElement)return;let a={directionModePicker:s.directionModePicker,labelsToggle:s.labelsToggle,tooltipsToggle:s.tooltipsToggle},l=this.layout==="horizontal"?this._relativeLocation==="top"?"bottom-end":"top-end":"right-end";return c("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:l,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:p=>this._remeasurePopoverSizes(p.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},c("div",{class:P.popoverWrapper},Object.values(a).includes(!0)?c(Je,{sketchOptions:o.sketchOptions,viewType:i?.type,visibleElements:new Ye(a)}):void 0,s.snappingControls&&i&&t?c(Xe,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:i,visibleElements:s.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if(this.contextualToolLocation!=="separate")return;let e=this._renderSelectionSetItemGroup();return e?.length?c(ye,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return this.contextualToolLocation==="separate"?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){return c("div",{"group-kind":"split-button",key:"undo-redo-menu",priority:this.groupCollapsePriorities?.get("undoRedo")??q.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){let e=[],t=[];this.customActions?.forEach(o=>{o.position==="settings-before"?t.push(o):o.position==="settings-after"&&e.push(o)});let i=[...t.map(o=>this._renderToolbarItem(o)),this._renderSettingsMenuButton(),...e.map(o=>this._renderToolbarItem(o))].filter(Y);if(i.length)return c("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"settings-menu",priority:this.groupCollapsePriorities?.get("settings")??q.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){if(!this.updateGraphics.length)return[];let e=this.contextualToolLocation==="inline-end"?"actions-end":void 0,t=this.customActions?.filter(s=>s.position==="before-selection-set"),i=this.customActions?.filter(s=>s.position==="after-selection-set"),o=this.groupCollapsePriorities?.get("selectionSet")??q.High;return[c("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:o,slot:e},this._renderFeatureCountChip()),c("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:o,slot:e},t?.map(s=>this._renderToolbarItem(s)),this._renderDuplicateButton(),this._renderDeleteButton(),i?.map(s=>this._renderToolbarItem(s)))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];let{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:t==="ready"})}_renderCreateToolActionGroup(){let e=this._effectiveAvailableCreateTools?.flatMap(i=>this._renderBuiltInCreateToolItem(i))??[],t=this.customToolOptions?.flatMap(i=>this._renderCustomToolItem(i))??[];return c("div",{"group-kind":"overflow-group",key:"create-tools-group",priority:this.groupCollapsePriorities?.get("createTools")??q.High},e,t)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:`${e}-button`,text:this.messages.draw[e],icon:St[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){let{toolKey:t}=e;return this._renderToolbarItem({id:`custom-${e.toolKey}`,text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:this._activeCustomToolOptions?.toolKey===t})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];let{layout:e,messages:t,scale:i,id:o,updateGraphics:{length:s}}=this,a=ae(t.selectedCount,{count:s}),l=i==="s"?99:999,p=s>l?ae(t.selectedCountTruncated,{truncated:l}):s,d=i==="s"&&e==="vertical",h=d?`${o}-selection-chip-small`:`${o}-selection-chip`;return[d?c("span",{classes:{[P.chipVertical]:!0,[P.chipVerticalSmall]:this.scale==="s"},id:h,tabIndex:0,title:a},p):c("calcite-chip",{appearance:"outline",class:e==="horizontal"?P.chipHorizontal:P.chipVertical,id:h,kind:"brand",label:a,scale:i==="l"?"m":"s",tabIndex:0,title:e==="vertical"?a:void 0},e==="vertical"?p:a)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];let{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];let{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:e,text:t,icon:i,disabled:o,onclick:s,active:a,flipRTL:l,afterCreate:p,afterUpdate:d,afterRemoved:h}){let g=`${this.id}-${e}`;return[c("calcite-action",{active:a,afterCreate:p,afterRemoved:h,afterUpdate:d,bind:this,"data-testid":e,disabled:o||this.state==="disabled",icon:i,iconFlipRtl:l??!1,id:g,key:e,onclick:s,scale:this.scale,text:t,title:t})]}_remeasurePopoverSizes(e){try{let t=e.parentElement,i=this?.view?.container?.getBoundingClientRect(),o=t?.style;if(!(t&&i&&o&&this.view?.container?.contains(t)))return;let s=this._calcitePopoverReferenceElement;if(!s)return;let{bottom:a,top:l}=s.getBoundingClientRect();if(this.layout==="horizontal"){let d=a<i.height/2;d!==(this._relativeLocation==="top")&&(this._relativeLocation=d?"top":"bottom"),d?(o?.setProperty("--sketch-view-height-offset",a-i.top+"px"),o?.setProperty("--sketch-view-margin-offset","30px")):(o?.setProperty("--sketch-view-height-offset",i.bottom-l+"px"),o?.setProperty("--sketch-view-margin-offset","15px"))}else this.layout==="vertical"&&(o.setProperty("--sketch-view-height-offset","15px"),o.setProperty("--sketch-view-margin-offset","15px"));let p=e.shadowRoot?.querySelector("div.header")?.getBoundingClientRect().height;o.setProperty("--sketch-popover-header-offset",`${p}px`)}catch(t){L.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",t)}}_activateCreateTool(e,t,i){let o=this._activeCustomToolOptions;if(i||o){if(i?.toolKey===o?.toolKey)return void this.cancel()}else if(this.activeTool===e)return void this.cancel();this._selectionToolbar?.cancel(),this.create(e,t,i)}_onDuplicateSelect(){let e=this.duplicate(),t=this.viewModel.activeTool;t!=="transform"&&t!=="reshape"||this.update(e,{tool:t})}_onSelectionOperationComplete(e){let{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){let o=t.tool,s=i.length>1&&o==="reshape"?"transform":o;this.update(i,S(v({},t),{tool:s}))}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}_refocusOnView(){this.activeTool&&this.view?.focus()}};r([n()],u.prototype,"_activeCustomToolOptions",void 0),r([n()],u.prototype,"activeTool",null),r([n({readOnly:!0})],u.prototype,"activeTooltip",null),r([n({cast:e=>{if(!e?.length)return null;let t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return e.filter(i=>t.has(i))}})],u.prototype,"availableCreateTools",void 0),r([n({readOnly:!0})],u.prototype,"createGraphic",null),r([n()],u.prototype,"creationMode",null),r([n()],u.prototype,"customToolOptions",void 0),r([n()],u.prototype,"customActions",void 0),r([n()],u.prototype,"defaultCreateOptions",null),r([n()],u.prototype,"defaultUpdateOptions",null),r([n()],u.prototype,"icon",null),r([n()],u.prototype,"label",null),r([n()],u.prototype,"labelOptions",null),r([n()],u.prototype,"layer",null),r([n({type:["horizontal","vertical"],value:"horizontal"})],u.prototype,"layout",null),r([n({value:"m"})],u.prototype,"scale",null),r([n()],u.prototype,"toolbarKind",void 0),r([n()],u.prototype,"contextualToolLocation",void 0),r([n()],u.prototype,"groupCollapsePriorities",void 0),r([n(),I("esri/widgets/Sketch/t9n/Sketch")],u.prototype,"messages",void 0),r([n(),I("esri/t9n/common")],u.prototype,"messagesCommon",void 0),r([n()],u.prototype,"snappingOptions",null),r([n()],u.prototype,"state",null),r([n()],u.prototype,"tooltipOptions",null),r([n({readOnly:!0})],u.prototype,"updateGraphics",null),r([n({type:Qe,nonNullable:!0})],u.prototype,"valueOptions",null),r([n()],u.prototype,"view",null),r([n({type:he}),$e(["create","update","undo","redo"])],u.prototype,"viewModel",null),r([n({type:me,nonNullable:!0})],u.prototype,"visibleElements",void 0),r([n()],u.prototype,"_effectiveAvailableCreateTools",null),r([n()],u.prototype,"_defaultViewModel",void 0),r([n()],u.prototype,"_calcitePopoverReferenceElement",void 0),r([n()],u.prototype,"_relativeLocation",void 0),r([n()],u.prototype,"_popoverOpen",void 0),u=r([m("esri.widgets.Sketch")],u);var fs=u;export{fs as default};
