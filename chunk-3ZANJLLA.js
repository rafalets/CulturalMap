import{a as ne}from"./chunk-7QY3BMVN.js";import{b as z}from"./chunk-WPDP647R.js";import{a as T}from"./chunk-4E4FE2IX.js";import{b as D,c as H,d as J,e as K}from"./chunk-LNVVFNTC.js";import{G as W,H as ee}from"./chunk-TRZXSDYA.js";import{c as X}from"./chunk-3SDSCSDJ.js";import{h as B}from"./chunk-D2LVMNOU.js";import{r as Q,t as x}from"./chunk-HHDFN2GK.js";function F(e,n){return e?n?4:3:n?3:2}var E=()=>Q.getLogger("esri.layers.graphics.featureConversionUtils"),A={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},me=(e,n,o,r,s,t)=>{e[o]=s,e[o+1]=t},oe=(e,n,o,r,s,t)=>{e[o]=s,e[o+1]=t,e[o+2]=n[r+2]},ge=(e,n,o,r,s,t)=>{e[o]=s,e[o+1]=t,e[o+2]=n[r+3]},ye=(e,n,o,r,s,t)=>{e[o]=s,e[o+1]=t,e[o+2]=n[r+2],e[o+3]=n[r+3]};function L(e,n,o,r){if(e){if(o)return n&&r?ye:oe;if(n&&r)return ge}else if(n&&r)return oe;return me}function O({scale:e,translate:n},o){return Math.round((o-n[0])/e[0])}function S({scale:e,translate:n},o){return Math.round((n[1]-o)/e[1])}function Y({scale:e,translate:n},o){return Math.round((o-n[0])/e[0])}function j({scale:e,translate:n},o){return Math.round((o-n[1])/e[1])}function k({scale:e,translate:n},o,r){return o*e[r]+n[r]}function Ce(e,n,o){return e?n?o?$(e):R(e):o?U(e):V(e):null}function V(e){let n=e.coords;return{x:n[0],y:n[1]}}function se(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e}function R(e){let n=e.coords;return{x:n[0],y:n[1],z:n[2]}}function pe(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.z,e}function U(e){let n=e.coords;return{x:n[0],y:n[1],m:n[2]}}function Fe(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.m,e}function $(e){let n=e.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Ie(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.z,e.coords[3]=n.m,e}function Me(e,n,o,r){let s=V;o&&r?s=$:o?s=R:r&&(s=U);for(let t of n){let{geometry:u,attributes:l}=t,i=u!=null?s(u):null;e.push({attributes:l,geometry:i})}return e}function C(e,n){return e&&n?Ie:e?pe:n?Fe:se}function Ge(e,n,o,r,s){let t=C(o,r);for(let{geometry:u,attributes:l}of n){let i=u!=null?t(new T,u):null;e.push(new z(i,l,null,s?l[s]:void 0))}return e}function Te(e,n,o=C(n.z!=null,n.m!=null)){return o(e,n)}function be(e,n,o,r){for(let{geometry:s,attributes:t}of n)e.push({attributes:t,geometry:s!=null?ue(s,o,r):null});return e}function ue(e,n,o){if(e==null)return null;let r=F(n,o),s=[];for(let t=0;t<e.coords.length;t+=r){let u=[];for(let l=0;l<r;l++)u.push(e.coords[t+l]);s.push(u)}return n?o?{points:s,hasZ:n,hasM:o}:{points:s,hasZ:n}:o?{points:s,hasM:o}:{points:s}}function Ne(e,n,o,r,s){let t=F(o,r);for(let{geometry:u,attributes:l}of n){let i=u!=null?le(new T,u,t):null;e.push(new z(i,l,null,s?l[s]:void 0))}return e}function le(e,n,o=F(n.hasZ,n.hasM)){e.lengths[0]=n.points.length;let r=e.coords,s=0;for(let t of n.points)for(let u=0;u<o;u++)r[s++]=t[u];return e}function we(e,n,o,r){for(let{geometry:s,attributes:t}of n)e.push({attributes:t,geometry:s!=null?ce(s,o,r):null});return e}function ce(e,n,o){if(!e)return null;let r=F(n,o),{coords:s,lengths:t}=e,u=[],l=0;for(let i of t){let c=[];for(let a=0;a<i;a++){let f=[];for(let h=0;h<r;h++)f.push(s[l++]);c.push(f)}u.push(c)}return n?o?{paths:u,hasZ:n,hasM:o}:{paths:u,hasZ:n}:o?{paths:u,hasM:o}:{paths:u}}function ve(e,n,o,r,s){let t=F(o,r);for(let{geometry:u,attributes:l,centroid:i}of n){let c=u!=null?ie(new T,u,t):null,a=i!=null?Te(new T,i):null;e.push(new z(c,l,a,s?l[s]:void 0))}return e}function ie(e,n,o=F(n.hasZ,n.hasM)){let{lengths:r,coords:s}=e,t=0;for(let u of n.paths){for(let l of u)for(let i=0;i<o;i++)s[t++]=l[i];r.push(u.length)}return e}function Pe(e,n,o,r){for(let{geometry:s,attributes:t,centroid:u}of n){let l=s!=null?ae(s,o,r):null;if(u!=null){let i=V(u);e.push({attributes:t,centroid:i,geometry:l})}else e.push({attributes:t,geometry:l})}return e}function ae(e,n,o){if(!e)return null;let r=F(n,o),{coords:s,lengths:t}=e,u=[],l=0;for(let i of t){let c=[];for(let a=0;a<i;a++){let f=[];for(let h=0;h<r;h++)f.push(s[l++]);c.push(f)}u.push(c)}return n?o?{rings:u,hasZ:n,hasM:o}:{rings:u,hasZ:n}:o?{rings:u,hasM:o}:{rings:u}}function ze(e,n,o,r,s){for(let{geometry:t,centroid:u,attributes:l}of n){let i=t!=null?fe(new T,t,o,r):null,c=s?l[s]:void 0;u!=null?e.push(new z(i,l,se(new T,u),c)):e.push(new z(i,l,null,c))}return e}function fe(e,n,o=n.hasZ,r=n.hasM){return xe(e,n.rings,o,r)}function xe(e,n,o,r){let s=F(o,r),{lengths:t,coords:u}=e,l=0;w(e);for(let i of n){for(let c of i)for(let a=0;a<s;a++)u[l++]=c[a];t.push(i.length)}return e}var Z=[],q=[];function Qe(e,n,o,r,s){Z[0]=e;let[t]=he(q,Z,n,o,r,s);return b(Z),b(q),t}function he(e,n,o,r,s,t){if(b(e),!o){for(let u of n){let l=t?u.attributes[t]:void 0;e.push(new z(null,u.attributes,null,l))}return e}switch(o){case"esriGeometryPoint":return Ge(e,n,r,s,t);case"esriGeometryMultipoint":return Ne(e,n,r,s,t);case"esriGeometryPolyline":return ve(e,n,r,s,t);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return ze(e,n,r,s,t);default:E().error("convertToFeatureSet:unknown-geometry",new x(`Unable to parse unknown geometry type '${o}'`)),b(e)}return e}function Be(e,n,o,r){q[0]=e,de(Z,q,n,o,r);let s=Z[0];return b(Z),b(q),s}function Xe(e,n,o){if(e==null)return null;let r=new T;return"hasZ"in e&&n==null&&(n=e.hasZ),"hasM"in e&&o==null&&(o=e.hasM),H(e)?C(n??e.z!=null,o??e.m!=null)(r,e):K(e)?fe(r,e,n,o):J(e)?ie(r,e,F(n,o)):D(e)?le(r,e,F(n,o)):void E().error("convertFromGeometry:unknown-geometry",new x(`Unable to parse unknown geometry type '${e}'`))}function Ze(e,n,o,r){let s=e&&("coords"in e?e:e.geometry);if(s==null)return null;switch(n){case"esriGeometryPoint":{let t=V;return o&&r?t=$:o?t=R:r&&(t=U),t(s)}case"esriGeometryMultipoint":return ue(s,o,r);case"esriGeometryPolyline":return ce(s,o,r);case"esriGeometryPolygon":return ae(s,o,r);default:return E().error("convertToGeometry:unknown-geometry",new x(`Unable to parse unknown geometry type '${n}'`)),null}}function qe(e,n){for(let o of n)e.push({attributes:o.attributes});return e}function de(e,n,o,r,s){if(b(e),o==null)return qe(e,n);switch(o){case"esriGeometryPoint":return Me(e,n,r,s);case"esriGeometryMultipoint":return be(e,n,r,s);case"esriGeometryPolyline":return we(e,n,r,s);case"esriGeometryPolygon":return Pe(e,n,r,s);default:E().error("convertToFeatureSet:unknown-geometry",new x(`Unable to parse unknown geometry type '${o}'`))}return e}function De(e){let{objectIdFieldName:n,spatialReference:o,transform:r,fields:s,hasM:t,hasZ:u,features:l,geometryType:i,exceededTransferLimit:c,uniqueIdField:a,queryGeometry:f,queryGeometryType:h}=e,m={features:de([],l,i,u,t),fields:s,geometryType:i,objectIdFieldName:n,spatialReference:o,uniqueIdField:a,queryGeometry:Ze(f,h,!1,!1)};return r&&(m.transform=r),c&&(m.exceededTransferLimit=c),t&&(m.hasM=t),u&&(m.hasZ=u),m}function He(e,n){let o=new ne,{hasM:r,hasZ:s,features:t,objectIdFieldName:u,spatialReference:l,geometryType:i,exceededTransferLimit:c,transform:a,fields:f}=e;return f&&(o.fields=f),o.geometryType=i??null,o.objectIdFieldName=u??n??null,o.spatialReference=l??null,o.objectIdFieldName?(t&&he(o.features,t,i,s,r,o.objectIdFieldName),c&&(o.exceededTransferLimit=c),r&&(o.hasM=r),s&&(o.hasZ=s),a&&(o.transform=a),o):(E().error(new x("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),o)}function Je(e){let{transform:n,features:o,hasM:r,hasZ:s}=e;if(!n)return e;for(let t of o)t.geometry!=null&&te(t.geometry,t.geometry,r,s,n),t.centroid!=null&&te(t.centroid,t.centroid,r,s,n);return e.transform=null,e}function Ke(e,n){let{geometryType:o,features:r,hasM:s,hasZ:t}=n;if(!e)return n;for(let u=0;u<r.length;u++){let l=r[u],i=l.weakClone();i.geometry=new T,re(i.geometry,l.geometry,s,t,o,e),l.centroid&&(i.centroid=new T,re(i.centroid,l.centroid,s,t,"esriGeometryPoint",e)),r[u]=i}return n.transform=e,n}function re(e,n,o,r,s,t,u=o,l=r){if(w(e),!n?.coords.length)return null;let i=A[s],{coords:c,lengths:a}=n,f=F(o,r),h=F(o&&u,r&&l),m=L(o,r,u,l);if(!a.length)return m(e.coords,c,0,0,O(t,c[0]),S(t,c[1])),w(e,f,0),e;let d,y,I,G,p=0,g=0,M=g;for(let v of a){if(v<i)continue;let N=0;g=M,I=d=O(t,c[p]),G=y=S(t,c[p+1]),m(e.coords,c,g,p,I,G),N++,p+=f,g+=h;for(let P=1;P<v;P++,p+=f)I=O(t,c[p]),G=S(t,c[p+1]),I===d&&G===y||(m(e.coords,c,g,p,I-d,G-y),g+=h,N++,d=I,y=G);N>=i&&(e.lengths.push(N),M=g)}return b(e.coords,M),e.coords.length?e:null}function We(e,n,o,r,s,t,u=o,l=r){if(w(e),!n?.coords.length)return null;let i=A[s],{coords:c,lengths:a}=n,f=F(o,r),h=F(o&&u,r&&l),m=L(o,r,u,l);if(!a.length)return m(e.coords,c,0,0,c[0],c[1]),w(e,f,0),e;let d=0,y=t*t;for(let I of a){if(I<i){d+=I*f;continue}let G=e.coords.length/h,p=d,g=d+(I-1)*f;m(e.coords,c,e.coords.length,p,c[p],c[p+1]),_(e.coords,c,f,y,m,p,g),m(e.coords,c,e.coords.length,g,c[g],c[g+1]);let M=e.coords.length/h-G;M>=i?e.lengths.push(M):b(e.coords,G*h),d+=I*f}return e.coords.length?e:null}function Ee(e,n,o,r){let s=e[n],t=e[n+1],u=e[o],l=e[o+1],i=e[r],c=e[r+1],a=u,f=l,h=i-a,m=c-f;if(h!==0||m!==0){let d=((s-a)*h+(t-f)*m)/(h*h+m*m);d>1?(a=i,f=c):d>0&&(a+=h*d,f+=m*d)}return h=s-a,m=t-f,h*h+m*m}function _(e,n,o,r,s,t,u){let l,i=r,c=0;for(let a=t+o;a<u;a+=o)l=Ee(n,a,t,u),l>i&&(c=a,i=l);i>r&&(c-t>o&&_(e,n,o,r,s,t,c),s(e,n,e.length,c,n[c],n[c+1]),u-c>o&&_(e,n,o,r,s,c,u))}function en(e,n,o,r){if(!n?.coords?.length)return null;let s=F(o,r),t=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){let c=n.coords;for(let a=0;a<c.length;a+=s){let f=c[a],h=c[a+1];t=Math.min(t,f),l=Math.max(l,f),u=Math.min(u,h),i=Math.max(i,h)}}return ee(e)?W(e,t,u,l,i):X(t,u,l,i,e),e}function te(e,n,o,r,s){let{coords:t,lengths:u}=n,l=F(o,r);if(!t.length)return e!==n&&w(e),e;B(s);let{originPosition:i,scale:c,translate:a}=s,f=Se;f.originPosition=i;let h=f.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;let m=f.translate;if(m[0]=a[0]??0,m[1]=a[1]??0,m[2]=a[2]??0,m[3]=a[3]??0,!u.length){for(let y=0;y<l;++y)e.coords[y]=k(f,t[y],y);return e!==n&&w(e,l,0),e}let d=0;for(let y=0;y<u.length;y++){let I=u[y];e.lengths[y]=I;for(let g=0;g<l;++g)e.coords[d+g]=k(f,t[d+g],g);let G=e.coords[d],p=e.coords[d+1];d+=l;for(let g=1;g<I;g++,d+=l){G+=t[d]*h[0],p+=t[d+1]*h[1],e.coords[d]=G,e.coords[d+1]=p;for(let M=2;M<l;++M)e.coords[d+M]=k(f,t[d+M],M)}}return e!==n&&w(e,t.length,u.length),e}function nn(e,n,o,r,s,t){if(w(e),e.lengths.push(...n.lengths),o===s&&r===t)for(let u=0;u<n.coords.length;u++)e.coords.push(n.coords[u]);else{let u=F(o,r),l=L(o,r,s,t),i=n.coords;for(let c=0;c<i.length;c+=u)l(e.coords,i,e.coords.length,c,i[c],i[c+1])}return e}function Ve(e,n,o,r){let s=0,t=e[r*n],u=e[r*(n+1)];for(let l=1;l<o;l++){let i=t+e[r*(n+l)],c=u+e[r*(n+l)+1],a=(i-t)*(c+u);t=i,u=c,s+=a}return .5*s}function on(e,n){let{coords:o,lengths:r}=e,s=0,t=0;for(let u=0;u<r.length;u++){let l=r[u];t+=Ve(o,s,l,n),s+=l}return Math.abs(t)}function Oe(e,n,o,r){return e*r-o*n===0&&e*o+n*r>0}function rn(e,n,o,r,s){let t=F(r,s);if(!e.lengths.length){if(e.coords.length<2)return null;let[f,h]=e.coords,m=Y(n,f),d=j(n,h);return new T([],[m,d])}let u=new T([],[0,0]),l=A[o],i=o==="esriGeometryPolygon"||o==="esriGeometryPolyline",c=0,a=0;for(let f=0;f<e.lengths.length;f++){let h=e.lengths[f],m=a,d=Y(n,e.coords[t*c]),y=j(n,e.coords[t*c+1]);u.coords[a++]=d,u.coords[a++]=y;let I=0,G=0,p=1;for(let g=1;g<h;g++){let M=Y(n,e.coords[t*(g+c)]),v=j(n,e.coords[t*(g+c)+1]);if(M!==d||v!==y){let N=M-d,P=v-y;i&&Oe(I,G,N,P)?(u.coords[a-2]+=N,u.coords[a-1]+=P,d+=N,y+=P):(u.coords[a++]=M,u.coords[a++]=v,d=M,y=v,I=N,G=P,p+=1)}}p<l?a=m:u.lengths.push(p),c+=h}return u.lengths.length===0?null:u}function w(e,n=0,o=0){b(e.lengths,o),b(e.coords,n)}function b(e,n=0){e.length!==n&&(e.length=n)}var Se={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{O as a,S as b,Ce as c,Te as d,ue as e,ce as f,ae as g,fe as h,xe as i,Qe as j,he as k,Be as l,Xe as m,Ze as n,De as o,He as p,Je as q,Ke as r,re as s,We as t,en as u,te as v,nn as w,on as x,rn as y};
