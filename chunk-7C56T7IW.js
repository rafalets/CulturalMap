import{b as _}from"./chunk-2ZJT7DIL.js";import{a as x}from"./chunk-S5AJRU4D.js";import"./chunk-MPSCABVQ.js";import"./chunk-NKCIC566.js";import"./chunk-7LVUNMSI.js";import"./chunk-7HLFOT25.js";import"./chunk-67ZC4UJG.js";import"./chunk-R3KYOH5H.js";import"./chunk-7X55A7Q6.js";import"./chunk-X7BNFUFQ.js";import"./chunk-BUZBVNOM.js";import"./chunk-VYZHOYXV.js";import"./chunk-ICWXUNPZ.js";import"./chunk-HM5RIVQC.js";import"./chunk-LNVVFNTC.js";import"./chunk-QJADLTFR.js";import"./chunk-CVRJ6GOM.js";import"./chunk-X7QUUHRV.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-TVHRLNTK.js";import{b as h}from"./chunk-XFESK2YB.js";import"./chunk-J5MXC6AL.js";import"./chunk-OLOKUDVI.js";import"./chunk-RJWOVI3M.js";import"./chunk-NHSDW26F.js";import"./chunk-WAGBL553.js";import"./chunk-WKJJQIBC.js";import"./chunk-J372WZPB.js";import"./chunk-XPRVY6JT.js";import"./chunk-7N3ZKWML.js";import"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import"./chunk-3SDSCSDJ.js";import"./chunk-I4M2OT5W.js";import"./chunk-NTVLK3P2.js";import"./chunk-WMQNRNIU.js";import"./chunk-HD52PWPC.js";import"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-LB5YQINJ.js";import{b as y}from"./chunk-EKMHQEJY.js";import"./chunk-VACZNAP3.js";import"./chunk-JKNCWG7E.js";import"./chunk-KTE5HCNJ.js";import"./chunk-F7VRLFCB.js";import"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import"./chunk-U4J5SECU.js";import"./chunk-7EG726PT.js";import{d as a}from"./chunk-C7INQGWT.js";import{H as m}from"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import{D as C,M as F,a as S,d as $}from"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import{a as r}from"./chunk-QGVBCWUY.js";import{r as b}from"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{f as v}from"./chunk-VTHXE323.js";var c=Symbol(),U=d=>{let e=class extends d{constructor(){super(...arguments),this.layerViews=new y,this._debouncedUpdate=F(()=>v(this,null,function*(){let{layer:i,parent:s}=this,o=s?.footprintLayerView,n=[],p=this._createQuery();if(p&&o){let{features:f}=yield o.queryFeatures(p);this.suspended||(n=f.map(w=>i.acquireLayer(w)))}this.removeHandles(c),this.addHandles(n,c)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some(i=>i.updating)}enableLayerUpdates(){return $([this._updatingHandles.addWhen(()=>this.parent?.footprintLayerView?.dataUpdating===!1,()=>this.updateLayers()),this._updatingHandles.add(()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended],()=>this.updateLayers()),S(()=>this.removeHandles(c))])}updateLayers(){this.suspended?this.removeHandles(c):this._updatingHandles.addPromise(C(this._debouncedUpdate()).catch(i=>{b.getLogger(this).error(i)}))}_createQuery(){let i=this.parent?.footprintLayerView,s=this.layer?.parent;if(!i||!s||s.destroyed)return null;let{layer:{maximumVisibleSublayers:o},view:{scale:n}}=this;if(!o)return null;let{itemTypeField:p,itemSourceField:f,itemNameField:w,minScaleField:g,maxScaleField:V,objectIdField:H,orderBy:I}=s,A=h(`${g} IS NULL OR ${n} <= ${g} OR ${g} = 0`,`${V} IS NULL OR ${n} >= ${V}`),l=I?.find(u=>u.field&&!u.valueExpression),t=i.createQuery();if(t.returnGeometry=!1,t.num=o,t.outFields=[H,f,w],t.where=h(t.where,A),this.unsupportedItemTypes!=null){let u=`${p} NOT IN (${this.unsupportedItemTypes.map(O=>`'${O}'`)})`;t.where=h(t.where,u)}return l?.field&&(t.orderByFields=[`${l.field} ${l.order==="descending"?"DESC":"ASC"}`],t.outFields.push(l.field)),t}};return r([a({readOnly:!0})],e.prototype,"creatingLayerViews",null),r([a()],e.prototype,"layer",void 0),r([a()],e.prototype,"layerViews",void 0),r([a({readOnly:!0})],e.prototype,"unsupportedItemTypes",void 0),r([a()],e.prototype,"parent",void 0),r([a({readOnly:!0})],e.prototype,"isUpdating",null),e=r([m("esri.views.layers.CatalogDynamicGroupLayerView")],e),e};var L=class extends U(_(x)){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new y}attach(){this.addAttachHandles([this.layerViews.on("after-changes",()=>this._updateStageChildren()),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(d){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((d,e)=>this.container.addChildAt(d.container,e))}};L=r([m("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],L);var ie=L;export{ie as default};
