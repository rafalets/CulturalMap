import{a as A,b as D}from"./chunk-Y7SPZFFF.js";import"./chunk-KDN6GG5Y.js";import{a as E}from"./chunk-4OC4J3KU.js";import"./chunk-GOLGIJPD.js";import{a as h,b as V,c as m}from"./chunk-NOTCESS5.js";import"./chunk-OGTXAEI4.js";import"./chunk-QXCWUIQ2.js";import"./chunk-OC2XJJQU.js";import{r as C}from"./chunk-IOI3V6WL.js";import"./chunk-IAM754TS.js";import"./chunk-DLMQHZTF.js";import"./chunk-2XQT24NO.js";import"./chunk-Y4OUS3AZ.js";import"./chunk-5K5ZHVX6.js";import"./chunk-SNPAQLOL.js";import"./chunk-NIYDRLW4.js";import{q as F}from"./chunk-WTJO2NGM.js";import"./chunk-3BZAI7HK.js";import"./chunk-LNYBTIG7.js";import"./chunk-6T37AWU6.js";import"./chunk-4AIH3WFI.js";import"./chunk-JOGV3DWE.js";import"./chunk-SKMO433W.js";import"./chunk-2FO7ARYZ.js";import"./chunk-DJW5LMRG.js";import"./chunk-QXXXCEV5.js";import"./chunk-TCGGI7DC.js";import"./chunk-ALWV3RJ2.js";import"./chunk-7C6Z24SS.js";import"./chunk-5WKDXHVH.js";import"./chunk-B5LBE5HD.js";import"./chunk-F6A6XWW4.js";import"./chunk-AESEF3B2.js";import"./chunk-QPGCDGIN.js";import"./chunk-PTZYZULI.js";import"./chunk-KZKWOEFD.js";import"./chunk-LNVVFNTC.js";import"./chunk-XSTBHERR.js";import"./chunk-YQPWWSMJ.js";import"./chunk-JEIB6WNP.js";import"./chunk-6JJCXUHW.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-OGS2SUK5.js";import{b}from"./chunk-XFESK2YB.js";import"./chunk-WNSGKHQ6.js";import"./chunk-NHSDW26F.js";import"./chunk-GWBRHLNH.js";import"./chunk-WKJJQIBC.js";import"./chunk-VDADRLEF.js";import"./chunk-CNQVGGE6.js";import"./chunk-JGD7UKVF.js";import"./chunk-XPRVY6JT.js";import"./chunk-7N3ZKWML.js";import"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import"./chunk-3SDSCSDJ.js";import"./chunk-I4M2OT5W.js";import"./chunk-NTVLK3P2.js";import"./chunk-WMQNRNIU.js";import"./chunk-HD52PWPC.js";import"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-5TW726OD.js";import"./chunk-VGD3XLDH.js";import{a as g,c as _,h as c}from"./chunk-LB5YQINJ.js";import"./chunk-EKMHQEJY.js";import"./chunk-VACZNAP3.js";import"./chunk-JKNCWG7E.js";import"./chunk-F7VRLFCB.js";import"./chunk-7IPIJKWU.js";import"./chunk-7R33MKVL.js";import"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import"./chunk-U4J5SECU.js";import"./chunk-7EG726PT.js";import{L as S,d as o}from"./chunk-C7INQGWT.js";import{H as f}from"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import{B as w,u as s}from"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import{a as n}from"./chunk-QGVBCWUY.js";import"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{f as y}from"./chunk-VTHXE323.js";var r=class extends S{get availability(){return 1}get _snappingElevationAligner(){let{view:e}=this,{layer:t}=this.layerSource,i=e!=null&&e.type==="3d";if(!i||t.type==="subtype-group")return h();let a=(l,p)=>y(this,null,function*(){return(yield w(e.whenLayerView(t),p)).elevationAlignPointsInFeatures(l,p)});return h(i,{elevationInfo:t.elevationInfo,alignPointsInFeatures:a})}get _snappingElevationFilter(){let{view:e}=this,t=e!=null&&e.type==="3d"&&this.layerSource.layer.type!=="subtype-group";return V(t)}get _symbologySnappingFetcher(){let{view:e}=this,{layer:t}=this.layerSource;return e!=null&&e.type==="3d"&&t.type!=="subtype-group"?m(this._symbologySnappingSupported,(i,a)=>y(this,null,function*(){let l=yield e.whenLayerView(t);return s(a),l.queryForSymbologySnapping({candidates:i,spatialReference:e.spatialReference},a)})):m()}get _layerView(){let{view:e}=this;if(e==null)return null;let{layer:t}=this.layerSource;return e.allLayerViews.find(i=>i.layer===t)}get _layerView3D(){let{view:e}=this;return e==null||e.type==="2d"?null:this._layerView}get _symbologySnappingSupported(){return this._layerView3D!=null&&this._layerView3D.symbologySnappingSupported}initialize(){let{view:e}=this,{layer:t}=this.layerSource;e!=null&&e.type==="3d"&&t.type!=="subtype-group"&&this.addHandles([e.elevationProvider.on("elevation-change",({context:i})=>{let{elevationInfo:a}=t;F(i,a)&&this._snappingElevationAligner.notifyElevationSourceChange()}),g(()=>t.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),c),g(()=>this._layerView3D!=null?this._layerView3D.layer?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),c),_(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}constructor(e){super(e),this.view=null,this.updating=!1,this._memoizedMakeGetGroundElevation=E(D)}refresh(){}fetchCandidates(e,t){return y(this,null,function*(){let{layer:i}=this.layerSource,a=i.source;if(!a?.querySnapping)return[];let l=i.createQuery();this._layerView&&"effectiveDisplayFilter"in this._layerView&&(l.where=b(l.where,this._layerView.effectiveDisplayFilter?.where));let p=C(e,this.view?.type??"2d",l),I=yield a.querySnapping(p,{signal:t});s(t);let d=e.coordinateHelper.spatialReference,u=yield this._snappingElevationAligner.alignCandidates(I.candidates,d,t);s(t);let v=yield this._symbologySnappingFetcher.fetch(u,t);s(t);let G=v.length===0?u:[...u,...v],k=this._snappingElevationFilter.filter(p,G),q=this._memoizedMakeGetGroundElevation(this.view,d);return k.map(x=>A(x,q))})}};n([o({constructOnly:!0})],r.prototype,"layerSource",void 0),n([o({constructOnly:!0})],r.prototype,"view",void 0),n([o()],r.prototype,"_snappingElevationAligner",null),n([o()],r.prototype,"_snappingElevationFilter",null),n([o()],r.prototype,"_symbologySnappingFetcher",null),n([o()],r.prototype,"_layerView",null),n([o()],r.prototype,"_layerView3D",null),n([o()],r.prototype,"_symbologySnappingSupported",null),r=n([f("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],r);export{r as FeatureCollectionSnappingSource};
