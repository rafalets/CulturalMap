import{a as B}from"./chunk-TM2N4VZT.js";import{a as I}from"./chunk-LUKGY62K.js";import{a as z}from"./chunk-QEMDJ4GW.js";import"./chunk-4KBVKETT.js";import{a as H}from"./chunk-ISPBFG3X.js";import{b as A}from"./chunk-2ZJT7DIL.js";import{a as _}from"./chunk-S5AJRU4D.js";import"./chunk-KQSP6CH6.js";import"./chunk-423EPWZ2.js";import"./chunk-MPSCABVQ.js";import"./chunk-RME3N3WY.js";import"./chunk-VZWPFXBV.js";import"./chunk-BYXBJQAS.js";import"./chunk-TTCWVZMG.js";import"./chunk-WH5SLVE3.js";import"./chunk-ET5YWLZA.js";import"./chunk-JXEAVWUK.js";import"./chunk-XAHD7XBV.js";import{a as W}from"./chunk-57XVWGJX.js";import"./chunk-JLWYDAJB.js";import"./chunk-W5OI4BJ2.js";import"./chunk-DHLVTH5U.js";import"./chunk-QXNVQZT7.js";import"./chunk-3ZANJLLA.js";import"./chunk-7QY3BMVN.js";import"./chunk-WPDP647R.js";import"./chunk-4E4FE2IX.js";import"./chunk-5SSISWTF.js";import"./chunk-HBZAOVHW.js";import"./chunk-4ZBUTOIE.js";import"./chunk-2XQT24NO.js";import"./chunk-NKCIC566.js";import"./chunk-7LVUNMSI.js";import"./chunk-SNL6C5QO.js";import"./chunk-7HLFOT25.js";import"./chunk-67ZC4UJG.js";import"./chunk-R3KYOH5H.js";import"./chunk-EG4E2T2R.js";import"./chunk-4D3QHJI2.js";import"./chunk-E2J2V7JN.js";import"./chunk-7X55A7Q6.js";import"./chunk-J3BDQLVD.js";import"./chunk-X7BNFUFQ.js";import"./chunk-37H4LYIE.js";import"./chunk-BUZBVNOM.js";import"./chunk-VYZHOYXV.js";import"./chunk-ICWXUNPZ.js";import"./chunk-JOGV3DWE.js";import"./chunk-HM5RIVQC.js";import"./chunk-2FO7ARYZ.js";import"./chunk-DJW5LMRG.js";import"./chunk-QXXXCEV5.js";import"./chunk-5WKDXHVH.js";import"./chunk-63B3IOWG.js";import"./chunk-LNVVFNTC.js";import"./chunk-BVXSAX5Q.js";import"./chunk-V2JYXY4D.js";import"./chunk-QJADLTFR.js";import"./chunk-YQPWWSMJ.js";import"./chunk-JEIB6WNP.js";import"./chunk-CVRJ6GOM.js";import"./chunk-X7QUUHRV.js";import"./chunk-7B2UKJ5N.js";import"./chunk-RSDQHAJX.js";import"./chunk-TRZXSDYA.js";import"./chunk-TVHRLNTK.js";import"./chunk-J5MXC6AL.js";import"./chunk-OLOKUDVI.js";import"./chunk-RJWOVI3M.js";import"./chunk-NHSDW26F.js";import"./chunk-WAGBL553.js";import"./chunk-WKJJQIBC.js";import"./chunk-J372WZPB.js";import"./chunk-XPRVY6JT.js";import"./chunk-7N3ZKWML.js";import"./chunk-E62WHYYG.js";import"./chunk-QDTU3MWT.js";import"./chunk-BCREO4Q5.js";import"./chunk-3SDSCSDJ.js";import{j as U}from"./chunk-I4M2OT5W.js";import"./chunk-NTVLK3P2.js";import"./chunk-WMQNRNIU.js";import"./chunk-HD52PWPC.js";import"./chunk-EIPVFA6F.js";import"./chunk-VOFKUGRY.js";import"./chunk-IG66NQHW.js";import"./chunk-ARRCN5K3.js";import"./chunk-5TW726OD.js";import"./chunk-VGD3XLDH.js";import{a as L}from"./chunk-LB5YQINJ.js";import"./chunk-EKMHQEJY.js";import"./chunk-VACZNAP3.js";import"./chunk-JKNCWG7E.js";import"./chunk-KTE5HCNJ.js";import"./chunk-F7VRLFCB.js";import"./chunk-7IPIJKWU.js";import"./chunk-7R33MKVL.js";import"./chunk-ISSJ3A6Y.js";import"./chunk-VDKRSX77.js";import"./chunk-WUA6PW3I.js";import"./chunk-E57FTRWF.js";import"./chunk-U4J5SECU.js";import"./chunk-7EG726PT.js";import{d as o}from"./chunk-C7INQGWT.js";import{H as f}from"./chunk-WMHJC7XF.js";import"./chunk-NJEWDTYF.js";import"./chunk-N3SDOFND.js";import"./chunk-OVHPPCBL.js";import"./chunk-FNXQZPHT.js";import"./chunk-3TQOUBNU.js";import{C as q,i as l,u as V}from"./chunk-D2LVMNOU.js";import"./chunk-SNFOAZZQ.js";import{a as r}from"./chunk-QGVBCWUY.js";import{r as R,t as y}from"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{a as F,f as c}from"./chunk-VTHXE323.js";var D=e=>{let t=class extends e{initialize(){this.exportImageParameters=new W({layer:this.layer})}destroy(){this.exportImageParameters=l(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}get timeExtent(){return z(this.layer,this.view?.timeExtent,this._get("timeExtent"))}fetchPopupFeaturesAtLocation(a,s){return c(this,null,function*(){let{layer:p}=this;if(!a)throw new y("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:p});let{popupEnabled:d}=p;if(!d)throw new y("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:d});let i=this.createFetchPopupFeaturesQuery(a);if(!i)return[];let{extent:m,width:n,height:h,x:g,y:x}=i;if(!(m&&n&&h))throw new y("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:m,width:n,height:h});let w=yield p.fetchFeatureInfo(m,n,h,g,x);return V(s),w})}};return r([o()],t.prototype,"exportImageParameters",void 0),r([o({readOnly:!0})],t.prototype,"exportImageVersion",null),r([o()],t.prototype,"layer",void 0),r([o({readOnly:!0})],t.prototype,"timeExtent",null),t=r([f("esri.views.layers.WMSLayerView")],t),t};var u=class extends D(H(A(_))){constructor(){super(...arguments),this.bitmapContainer=new I}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}update(e){this.strategy.update(e).catch(t=>{q(t)||R.getLogger(this).error(t)})}attach(){let{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:a}=e;this.bitmapContainer=new I,this.container.addChild(this.bitmapContainer),this.strategy=new B({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:a,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.addAttachHandles(L(()=>this.exportImageVersion,()=>this.requestUpdate()))}detach(){this.strategy=l(this.strategy),this.container.removeAllChildren()}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){let{view:t,bitmapContainer:a}=this,{x:s,y:p}=e,{spatialReference:d}=t,i,m=0,n=0;if(a.children.some(w=>{let{width:E,height:P,resolution:M,x:b,y:v}=w,S=b+M*E,C=v-M*P;return s>=b&&s<=S&&p<=v&&p>=C&&(i=new U({xmin:b,ymin:C,xmax:S,ymax:v,spatialReference:d}),m=E,n=P,!0)}),!i)return null;let h=i.width/m,g=Math.round((s-i.xmin)/h),x=Math.round((i.ymax-p)/h);return{extent:i,width:m,height:n,x:g,y:x}}doRefresh(){return c(this,null,function*(){this.requestUpdate()})}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,a,s){return this.layer.fetchImageBitmap(e,t,a,F({timeExtent:this.timeExtent},s))}};r([o()],u.prototype,"strategy",void 0),r([o()],u.prototype,"updating",void 0),u=r([f("esri.views.2d.layers.WMSLayerView2D")],u);var gt=u;export{gt as default};
