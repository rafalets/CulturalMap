import{a as P}from"./chunk-HBZAOVHW.js";import{a as M}from"./chunk-Y7MZCJ2F.js";import{a as S}from"./chunk-TKZJUAKL.js";import{m as W,s as X}from"./chunk-SKMO433W.js";import{c as H}from"./chunk-5WKDXHVH.js";import{a as b,b as Z,c as F}from"./chunk-TRZXSDYA.js";import{i as C}from"./chunk-E62WHYYG.js";import{a as g}from"./chunk-BCREO4Q5.js";import{f as E}from"./chunk-VOFKUGRY.js";import{ga as O,ia as N}from"./chunk-IG66NQHW.js";function k(t,o,l){let r=R(Y,t,o,l)?Y:[0,0,1];return Math.abs(r[2])>Math.cos(E(80))?g.Z:Math.abs(r[1])>Math.abs(r[0])?g.Y:g.X}function R(t,o,l,r){let n=(i=>!Array.isArray(i[0]))(o)?(i,e)=>o[3*i+e]:(i,e)=>o[i][e],s=r?N(r)/O(r):1;return X(t,(i,e)=>H(i,n(e,0)*s,n(e,1)*s,n(e,2)),l)}var Y=W();function ot(t){let o=U(t.rings,t.hasZ,I.CCW_IS_HOLE,t.spatialReference),l=new Array,r=0,n=0;for(let e of o.polygons){let h=e.count,a=e.index,d=F(o.position,3*a,3*h),A=e.holeIndices.map(f=>f-a),m=S(P(d,A,3));l.push({position:d,faces:m}),r+=d.length,n+=m.length}let s=T(l,r,n),i=Array.isArray(s.position)?M(s.position,3,{originalIndices:s.faces}):M(s.position.buffer,6,{originalIndices:s.faces});return s.position=Z(new Float64Array(i.buffer)),s.faces=i.indices,s}function T(t,o,l){if(t.length===1)return t[0];let r=b(o),n=new Array(l),s=0,i=0,e=0;for(let h of t){for(let a=0;a<h.position.length;a++)r[s++]=h.position[a];for(let a of h.faces)n[i++]=a+e;e=s/3}return{position:r,faces:S(n)}}function U(t,o,l,r){let n=t.length,s=new Array(n),i=new Array(n),e=new Array(n),h=0;for(let u=0;u<n;++u)h+=t[u].length;let a=0,d=0,A=0,m=b(3*h),f=0;for(let u=n-1;u>=0;u--){let c=t[u],_=l===I.CCW_IS_HOLE&&v(c,o,r);if(_&&n!==1)s[a++]=c;else{let L=c.length;for(let p=0;p<a;++p)L+=s[p].length;let y={index:f,pathLengths:new Array(a+1),count:L,holeIndices:new Array(a)};y.pathLengths[0]=c.length,c.length>0&&(e[A++]={index:f,count:c.length}),f=_?x(c,c.length-1,-1,m,f,c.length,o):x(c,0,1,m,f,c.length,o);for(let p=0;p<a;++p){let w=s[p];y.holeIndices[p]=f,y.pathLengths[p+1]=w.length,w.length>0&&(e[A++]={index:f,count:w.length}),f=x(w,0,1,m,f,w.length,o)}a=0,y.count>0&&(i[d++]=y)}}for(let u=0;u<a;++u){let c=s[u];c.length>0&&(e[A++]={index:f,count:c.length}),f=x(c,0,1,m,f,c.length,o)}return i.length=d,e.length=A,{position:m,polygons:i,outlines:e}}function x(t,o,l,r,n,s,i){n*=3;for(let e=0;e<s;++e){let h=t[o];r[n++]=h[0],r[n++]=h[1],r[n++]=i&&h[2]?h[2]:0,o+=l}return n/3}function v(t,o,l){if(!o)return!C(t);let r=t.length-1;switch(k(t,r,l)){case g.X:return!C(t,g.Y,g.Z);case g.Y:return!C(t,g.X,g.Z);case g.Z:return!C(t,g.X,g.Y)}}var I;(function(t){t[t.NONE=0]="NONE",t[t.CCW_IS_HOLE=1]="CCW_IS_HOLE"})(I||(I={}));export{k as a,ot as b,U as c,I as d};
