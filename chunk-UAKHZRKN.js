import{j as A}from"./chunk-HAHX77IL.js";import{a as I}from"./chunk-D2LVMNOU.js";import{a as T,b as H}from"./chunk-VTHXE323.js";var W=Symbol("widget"),$=Symbol("widget-test-data");var Q=[],X={},N=new WeakMap;function Z(e,t){let r=t.children;if(r?.length)for(let n=0;n<r.length;++n)r[n]=Z(e,r[n]);else r=Q;let o=t.vnodeSelector;if(k(o)){let n=t.properties||X,d=n.key||o,a={key:d,afterCreate:_,afterUpdate:ee,afterRemoved:q,parentWidget:e,widgetConstructor:o,widgetProperties:H(T({},n),{key:d,children:r})};return{vnodeSelector:o.vnodeSelector,properties:a,children:void 0,text:void 0,domNode:null}}return t}function _(e,t,r,{parentWidget:o,widgetConstructor:n,widgetProperties:d}){let a=new n(d);a.container=e,N.set(e,a),a.afterCreate?.(a,e),o.addHandles(I(()=>q(e))),queueMicrotask(()=>{a[$].projector.renderNow()})}function ee(e,t,r,{widgetProperties:o}){let n=N.get(e);n&&(n.set(o),n.afterUpdate?.(n,e))}function q(e){let t=N.get(e);t&&(t.afterRemoved?.(t,e),t.destroy(),N.delete(e))}function k(e){return typeof e=="function"&&e[W]}var te=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},B=function(e,t){for(var r=0,o=e.length;r<o;r++){var n=e[r];Array.isArray(n)?B(n,t):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=te(n)),t.push(n))}},re=function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:e,properties:t||void 0,children:void 0,text:r[0],domNode:null};var n=[];return B(r,n),{vnodeSelector:e,properties:t||void 0,children:n,text:void 0,domNode:null}};function we(e,t,...r){return typeof e!="function"||k(e)?re(e,t??null,...r):e(t,...r)}function Ne(...e){return e}var V="http://www.w3.org/",x=`${V}2000/svg`,Y=`${V}1999/xlink`,M=[],S=(e,t)=>{let r={};return Object.keys(e).forEach(o=>{r[o]=e[o]}),t&&Object.keys(t).forEach(o=>{r[o]=t[o]}),r},L=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),G=e=>{if(typeof e!="string")throw new Error("Style values must be strings")},oe=(e,t,r)=>{if(t.vnodeSelector!==""){for(let o=r;o<e.length;o++)if(L(e[o],t))return o}return-1},C=(e,t,r,o)=>{let n=e[t];if(n.vnodeSelector==="")return;let d=n.properties;if(!(d&&(d.key===void 0?d.bind:d.key))){for(let a=0;a<e.length;a++)if(a!==t){let p=e[a];if(L(p,n))throw new Error(`${r.vnodeSelector} had a ${n.vnodeSelector} child ${o==="added"?o:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},ne=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},E=[],j=!1,J=e=>{(e.children||[]).forEach(J),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},F=()=>{j=!1,E.forEach(J),E.length=0},U=e=>{E.push(e),j||(j=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(F,{timeout:16}):setTimeout(F,16))},z=e=>{let t=e.domNode;if(e.properties){let r=e.properties.exitAnimation;if(r)return t.style.pointerEvents="none",void r(t,()=>{t.parentNode&&(t.parentNode.removeChild(t),U(e))},e.properties)}t.parentNode&&(t.parentNode.removeChild(t),U(e))},ie=(e,t,r)=>{if(!t)return;let o=r.eventHandlerInterceptor,n=Object.keys(t),d=n.length;for(let a=0;a<d;a++){let p=n[a],i=t[p];if(p==="className")throw new Error('Property "className" is not supported, use "class".');if(p==="class")P(e,i,!0);else if(p==="classes"){let l=Object.keys(i),f=l.length;for(let s=0;s<f;s++){let c=l[s];i[c]&&e.classList.add(c)}}else if(p==="styles"){let l=Object.keys(i),f=l.length;for(let s=0;s<f;s++){let c=l[s],u=i[c];u&&(G(u),r.styleApplyer(e,c,u))}}else if(p!=="key"&&i!=null){let l=typeof i;l==="function"?(p.lastIndexOf("on",0)===0&&(o&&(i=o(p,i,e,t)),p==="oninput"&&function(){let f=i;i=function(s){f.apply(this,[s]),s.target["oninput-value"]=s.target.value}}()),e[p]=i):r.namespace===x?p==="href"?e.setAttributeNS(Y,p,i):e.setAttribute(p,i):l==="string"&&p!=="value"?p==="innerHTML"?e[p]=A.sanitize(i):O(e)&&p in e?e[p]=i:e.setAttribute(p,i):e[p]=i}}};function O(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;let t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}var b,se=(e,t,r)=>{if(t)for(let o of t)h(o,e,void 0,r)},D=(e,t,r)=>{se(e,t.children,r),t.text&&(e.textContent=t.text),ie(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},h=(e,t,r,o)=>{let n,d=0,a=e.vnodeSelector,p=t.ownerDocument;if(a==="")n=e.domNode=p.createTextNode(e.text),r!==void 0?t.insertBefore(n,r):t.appendChild(n);else{for(let i=0;i<=a.length;++i){let l=a.charAt(i);if(i===a.length||l==="."||l==="#"){let f=a.charAt(d-1),s=a.slice(d,i);f==="."?n.classList.add(s):f==="#"?n.id=s:(s==="svg"&&(o=S(o,{namespace:x})),o.namespace!==void 0?n=e.domNode=p.createElementNS(o.namespace,s):(n=e.domNode=e.domNode||p.createElement(s),s==="input"&&e.properties&&e.properties.type!==void 0&&n.setAttribute("type",e.properties.type)),r!==void 0?t.insertBefore(n,r):n.parentNode!==t&&t.appendChild(n)),d=i+1}}D(n,e,o)}},P=(e,t,r)=>{t&&t.split(" ").forEach(o=>{o&&e.classList.toggle(o,r)})},de=(e,t,r,o)=>{if(!r)return;let n=!1,d=Object.keys(r),a=d.length;for(let p=0;p<a;p++){let i=d[p],l=r[i],f=t[i];if(i==="class")f!==l&&(P(e,f,!1),P(e,l,!0));else if(i==="classes"){let s=e.classList,c=Object.keys(l),u=c.length;for(let m=0;m<u;m++){let v=c[m],R=!!l[v];R!==!!f[v]&&(n=!0,R?s.add(v):s.remove(v))}}else if(i==="styles"){let s=Object.keys(l),c=s.length;for(let u=0;u<c;u++){let m=s[u],v=l[m];v!==f[m]&&(n=!0,v?(G(v),o.styleApplyer(e,m,v)):o.styleApplyer(e,m,""))}}else if(l||typeof f!="string"||(l=""),i!=="value"||O(e)){if(l!==f){let s=typeof l;s==="function"&&o.eventHandlerInterceptor||(o.namespace===x?i==="href"?e.setAttributeNS(Y,i,l):e.setAttribute(i,l):s==="string"?i==="innerHTML"?e[i]=A.sanitize(l):i==="role"&&l===""?e.removeAttribute(i):O(e)&&i in e?e[i]=l:e.setAttribute(i,l):e[i]!==l&&(e[i]=l),n=!0)}}else{let s=e[i];s!==l&&(e["oninput-value"]?s===e["oninput-value"]:l!==f)&&(e[i]=l,e["oninput-value"]=void 0),l!==f&&(n=!0)}}return n},le=(e,t,r,o,n)=>{if(r===o)return!1;o=o||M;let d,a=(r=r||M).length,p=o.length,i=0,l=0,f=!1;for(;l<p;){let s=i<a?r[i]:void 0,c=o[l];if(s!==void 0&&L(s,c))f=b(s,c,n)||f,i++;else{let u=oe(r,c,i+1);if(u>=0){for(d=i;d<u;d++)z(r[d]),C(r,d,e,"removed");f=b(r[u],c,n)||f,i=u+1}else h(c,t,i<a?r[i].domNode:void 0,n),ne(c),C(o,l,e,"added")}l++}if(a>i)for(d=i;d<a;d++)z(r[d]),C(r,d,e,"removed");return f};b=(e,t,r)=>{let o=e.domNode,n=!1;if(e===t)return!1;let d=!1;if(t.vnodeSelector===""){if(t.text!==e.text){let a=o.ownerDocument.createTextNode(t.text);return o.parentNode.replaceChild(a,o),t.domNode=a,n=!0,n}t.domNode=o}else t.vnodeSelector.lastIndexOf("svg",0)===0&&(r=S(r,{namespace:x})),e.text!==t.text&&(d=!0,t.text===void 0?o.removeChild(o.firstChild):o.textContent=t.text),t.domNode=o,d=le(t,o,e.children,t.children,r)||d,d=de(o,e.properties,t.properties,r)||d,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[o,r,t.vnodeSelector,t.properties,t.children]);return d&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(o,t.properties,e.properties),n};var y=(e,t)=>({getLastRender:()=>e,update:r=>{if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let o=e;e=r,b(o,r,t)},domNode:e.domNode});var ae={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{t.charAt(0)==="-"?e.style.setProperty(t,r):e.style[t]=r}},g=e=>S(ae,e),w={create:(e,t)=>(t=g(t),h(e,document.createElement("div"),void 0,t),y(e,t)),append:(e,t,r)=>(r=g(r),h(t,e,void 0,r),y(t,r)),insertBefore:(e,t,r)=>(r=g(r),h(t,e.parentNode,e,r),y(t,r)),merge:(e,t,r)=>(r=g(r),t.domNode=e,D(e,t,r),y(t,r)),replace:(e,t,r)=>(r=g(r),h(t,e.parentNode,e,r),e.parentNode.removeChild(e),y(t,r))};var K,pe=(e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r};K=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];var ce=(e,t)=>{let r=e;return t.forEach(o=>{r=r&&r.children?K(r.children,n=>n.domNode===o):void 0}),r},fe=(e,t,r)=>{let o=function(n){r("domEvent",n);let d=t(),a=pe(n.currentTarget,d.domNode);a.reverse();let p,i=ce(d.getLastRender(),a);return e.scheduleRender(),i&&(p=i.properties[`on${n.type}`].apply(i.properties.bind||this,arguments)),r("domEventProcessed",n),p};return(n,d,a,p)=>o},Ee=e=>{let t,r,o=g(e),n=o.performanceLogger,d=!0,a=!1,p=[],i=[],l=(s,c,u)=>{let m,v=()=>m;o.eventHandlerInterceptor=fe(t,v,n),m=s(c,u(),o),p.push(m),i.push(u)},f=()=>{if(r=void 0,d){d=!1,n("renderStart",void 0);for(let s=0;s<p.length;s++){let c=i[s]();n("rendered",void 0),p[s].update(c),n("patched",void 0)}n("renderDone",void 0),d=!0}};return t={renderNow:f,scheduleRender:()=>{r||a||(r=requestAnimationFrame(f))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,d=!0,t.scheduleRender()},append:(s,c)=>{l(w.append,s,c)},insertBefore:(s,c)=>{l(w.insertBefore,s,c)},merge:(s,c)=>{l(w.merge,s,c)},replace:(s,c)=>{l(w.replace,s,c)},detach:s=>{for(let c=0;c<i.length;c++)if(i[c]===s)return i.splice(c,1),p.splice(c,1)[0];throw new Error("renderFunction was not found")}},t};export{w as a,Ee as b,W as c,$ as d,Z as e,k as f,we as g,Ne as h};
