import{c as N}from"./chunk-4RDCETCH.js";import{D as A,U as D,W as F,ga as E,p as _,z as b}from"./chunk-MARRSUOJ.js";import{a as R,b as Z}from"./chunk-LWVUOW7N.js";import{a as X,f as O}from"./chunk-J372WZPB.js";import{h as Q}from"./chunk-7N3ZKWML.js";import{i as C}from"./chunk-QDTU3MWT.js";import{h as B}from"./chunk-I4M2OT5W.js";import{a as k,n as M}from"./chunk-NTVLK3P2.js";import{g as J}from"./chunk-VOFKUGRY.js";import{ia as W}from"./chunk-IG66NQHW.js";import{a as y}from"./chunk-VTHXE323.js";function g(e,t,n){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0))}function G(e,t,n){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]!==void 0&&t[2]!==void 0?(e[2]*n-t[2]*n)**2:0)}var q=[];for(let e of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){let t=e[0];for(let n=1;n<e.length;n++)q[e[n]]=t}var T=[];function S(e){return e.vcsWkid&&q[e.vcsWkid]!==void 0?T[q[e.vcsWkid]]:e.latestVcsWkid&&q[e.latestVcsWkid]!==void 0?T[q[e.latestVcsWkid]]:1}function L(e,t,n){let r=t[0]-e[0],a=t[1]-e[1];if(n){let i=t[2]-t[2];return Math.sqrt(r*r+a*a+i*i)}return Math.sqrt(r*r+a*a)}function K(e,t,n){let r=t[0]-e[0],a=t[1]-e[1];if(n){let i=t[2]-t[2];return r*r+a*a+i*i}return r*r+a*a}function le(e,t){return e.x*t.x+e.y*t.y}function ce(e,t){return e.x*t.y-t.x*e.y}function U(e,t,n=0){for(;e<n;)e+=t;let r=n+t;for(;e>=r;)e-=t;return e}function Y(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function Ze(e,t){return U(Y(e,t),2*Math.PI)*(180/Math.PI)}function we(e,t){return U(Math.PI/2-Y(e,t),2*Math.PI)*(180/Math.PI)}function $(e,t,n){let r={x:e.x-t.x,y:e.y-t.y},a={x:n.x-t.x,y:n.y-t.y};return Math.atan2(ce(r,a),le(r,a))}function Ie(e,t,n){return J(U($(e,t,n),2*Math.PI))}function ze(e,t,n){return J(U(-1*$(e,t,n),2*Math.PI))}T[9002]=.3048,T[9003]=.3048006096012192,T[9095]=.3048007491;var h=[0,0];function Pe(e){for(let t=0;t<e.length;t++){let n=e[t];for(let a=0;a<n.length-1;a++){let i=n[a],f=n[a+1];for(let l=t+1;l<e.length;l++)for(let c=0;c<e[l].length-1;c++){let s=e[l][c],m=e[l][c+1];if(B(i,f,s,m,h)&&!(h[0]===i[0]&&h[1]===i[1]||h[0]===s[0]&&h[1]===s[1]||h[0]===f[0]&&h[1]===f[1]||h[0]===m[0]&&h[1]===m[1]))return!0}}let r=n.length;if(!(r<3))for(let a=0;a<=r-2;a++){let i=n[a],f=n[a+1];for(let l=a+2;l<=r-2;l++){let c=n[l],s=n[l+1];if(B(i,f,c,s,h)&&!(h[0]===i[0]&&h[1]===i[1]||h[0]===c[0]&&h[1]===c[1]||h[0]===f[0]&&h[1]===f[1]||h[0]===s[0]&&h[1]===s[1]))return!0}}}return!1}function fe(e,t,n){return Math.max(t,Math.min(n,e))}function ue(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function he(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function ee(e,t,n){let r=[n[0]-t[0],n[1]-t[1],n[2]-t[2]],a=fe(ue(r,[e[0]-t[0],e[1]-t[1],e[2]-t[2]])/he(r),0,1);return[t[0]+(n[0]-t[0])*a,t[1]+(n[1]-t[1])*a,t[2]+(n[2]-t[2])*a]}function te(e,t,n){let r=0,a=n[0]-t[0],i=n[1]-t[1],f=a*a+i*i;return f===0?r=.5:(r=((e[0]-t[0])*a+(e[1]-t[1])*i)/f,r<0?r=0:r>1&&(r=1)),r<=.5?[t[0]+(n[0]-t[0])*r,t[1]+(n[1]-t[1])*r]:[n[0]-(n[0]-t[0])*(1-r),n[1]-(n[1]-t[1])*(1-r)]}function ne(e,t,n){let r=t[0]-e[0],a=t[1]-e[1];return Math.sqrt(r*r+a*a)}function me(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function pe(e){let t=me(e);return[e[0]/t,e[1]/t,e[2]/t]}function re(e,t,n,r){let a=pe([t[0]-e[0],t[1]-e[1],t[2]*r-e[2]*r]);return[e[0]+a[0]*n,e[1]+a[1]*n,e[2]+a[2]*n]}function H(e,t,n,r){return e+(t-e)/n*r}function ae(e,t,n){let r=t[0]-e[0],a=t[1]-e[1],i=Math.sqrt(r*r+a*a);return r/=i,a/=i,r*=n,a*=n,[e[0]+r,e[1]+a]}function se(e,t){if(!e)return null;switch(e.type){case"extent":case"multipoint":case"mesh":case"point":return null}let n=e.type==="polygon"?e.rings:e.paths,r=1;if((e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(r=S(e.spatialReference)/W(e.spatialReference)),n.length===0||n[0].length===0||e.hasM===!1)return null;let a=-1,i=0,f=e.hasZ?g:ne,l=e.hasZ?3:2,c=2;for(let s of n){if(a++,s.length>0&&s[0][l]===t)return{partId:a,distanceAlong:i,coordinate:new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:s[0][0],y:s[0][1]},e.hasZ?{z:s[0][c]}:{}),e.hasM?{m:s[0][l]}:{})),segmentId:0};let m=-1;for(let o=1;o<s.length;o++){let P=f(s[o-1],s[o],r);m++;let u=s[o][l]-s[o-1][l],p=s[o][l];if(p===t)return{partId:a,distanceAlong:P+i,coordinate:new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:s[o][0],y:s[o][1]},e.hasZ?{z:s[o][c]}:{}),e.hasM?{m:s[o][l]}:{})),segmentId:m};if(p>t&&t>s[o-1][l]){let w=(t-s[o-1][l])/u*P,v=e.hasZ?re(s[o-1],s[o],w,r):ae(s[o-1],s[o],w);v=[...v,t];let I=new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:v[0],y:v[1]},e.hasZ?{z:v[c]}:{}),e.hasM?{m:v[l]}:{}));return{partId:a,distanceAlong:i+f(s[o-1],[I.x,I.y,...I.hasZ?[I.z]:[],...I.hasM?[I.m]:[]],r),coordinate:I,segmentId:m}}i+=P}}return null}function ie(e,t){if(!e)return null;switch(e.type){case"extent":case"multipoint":case"mesh":case"point":return null}let n=e.type==="polygon"?e.rings:e.paths;if(t<0)return null;let r=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(r=S(e.spatialReference)/W(e.spatialReference));let a=0,i=e.hasZ?3:2,f=2,l=e.hasZ?g:ne,c=-1;if(t===0)return n.length===0||n[0].length===0?null:{partId:0,coordinate:new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:n[0][0][0],y:n[0][0][1]},e.hasZ?{z:n[0][0][f]}:{}),e.hasM?{m:n[0][0][i]}:{})),segmentId:0};for(let s of n){c++;let m=-1;for(let o=1;o<s.length;o++){m++;let P=l(s[o-1],s[o],r),u=a+P;if(u===t)return{partId:c,coordinate:new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:s[o][0],y:s[o][1]},e.hasZ?{z:s[o][f]}:{}),e.hasM?{m:s[o][i]}:{})),segmentId:m};if(u>t){let p=e.hasZ?re(s[o-1],s[o],t-a,r):ae(s[o-1],s[o],t-a);return p=[...p,H(s[o-1][i],s[o][i],P,t-a)],{partId:c,coordinate:new M(y(y({hasZ:e.hasZ,hasM:e.hasM,spatialReference:e.spatialReference,x:p[0],y:p[1]},e.hasZ?{z:p[f]}:{}),e.hasM?{m:p[i]}:{})),segmentId:m}}a=u}}return null}function ge(e,t){if(!e||!t)return null;let n=1;(t.spatialReference.vcsWkid||t.spatialReference.latestVcsWkid)&&(n=S(t.spatialReference)/W(t.spatialReference));let r=null,a=0;return r=e,a=e.hasZ&&t.hasZ?g([t.x,t.y,t.z],[e.x,e.y,e.z],n):L([t.x,t.y],[e.x,e.y],!1),{coordinate:r,distance:a}}function de(e,t){if(!e||!t)return null;let n=1;(t.spatialReference.vcsWkid||t.spatialReference.latestVcsWkid)&&(n=S(t.spatialReference)/W(t.spatialReference));let r=null,a=0,i=Number.MAX_VALUE,f=-1,l=-1;for(let c of e.points||[]){l++;let s=e.hasZ&&t.hasZ?G([c[0],c[1],c[2]],[t.x,t.y,t.z],n):K([c[0],c[1]],[t.x,t.y],!1);s<i&&(i=s,f=l)}return f<0?null:(a=i,r=e.getPoint(f),{coordinate:r,distance:Math.sqrt(a)})}function ye(e,t){if(!e||!t)return null;let n=e.type==="polygon"?e.rings:e.paths,r=1;(t.spatialReference.vcsWkid||t.spatialReference.latestVcsWkid)&&(r=S(t.spatialReference)/W(t.spatialReference));let a=Number.MAX_VALUE,i=-1,f=-1,l=-1,c=e.hasZ&&t.hasZ,s=null,m=c?[t.x,t.y,t.z]:[t.x,t.y];for(let z of n){f++;for(let d=1;d<z.length;d++){let V=c?ee(m,z[d-1],z[d]):te(m,z[d-1],z[d]),x=c?G(V,m,r):K(V,m,!1);x<a&&(a=x,s=V,l=f,i=d-1)}}if(i<0)return null;let o=e.hasM&&e.hasZ?3:2,P=2,u=n[l][i],p=n[l][i+1],w=null,v=null,I=c?s[2]:null;e.hasM&&(v=H(u[o],p[o],c?g(u,p,r):L(u,p,!1),c?g(u,s,r):L(u,s,!1))),e.hasZ&&t.hasZ===!1&&(I=H(u[P],p[P],c?g(u,p,r):L(u,p,!1),c?g(u,s,r):L(u,s,!1))),w=new M(y(y({hasZ:c,hasM:e.hasM,spatialReference:t.spatialReference,x:s[0],y:s[1]},e.hasZ?{z:I}:{}),e.hasM?{m:v}:{}));let j=0;for(let z=0;z<=l;z++){let d=n[z],V=z===l?i:d.length-1;for(let x=1;x<=V;x++)j+=e.hasZ?g(d[x-1],d[x],r):L([d[x-1][0],d[x-1][1]],[d[x][0],d[x][1]],!1)}return j+=e.hasZ?g(u,[w.x,w.y,w.z],r):L(u,[w.x,w.y],!1),{partId:l,segmentId:i,coordinate:w,distance:Math.sqrt(a),distanceAlong:j}}function oe(e,t){if(!e||!t)return null;if(e.type==="extent"){let n=e;e=new Q({spatialReference:e.spatialReference,rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]})}switch(e.type){case"point":return ge(e,t)??null;case"multipoint":return de(e,t)??null;case"polygon":case"polyline":return ye(e,t)??null;default:return null}}function je(e,t,n){if(A(e,2,2,t,n),!(e[0]instanceof k&&e[1]instanceof k)){if(!(e[0]instanceof k&&e[1]===null)){if(!(e[1]instanceof k&&e[0]===null)){if(e[0]!==null||e[1]!==null)throw new Z(t,R.InvalidParameter,n)}}}}function Je(e){if(e.type!=="polygon"&&e.type!=="polyline"&&e.type!=="extent")return 0;let t=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(t=S(e.spatialReference)/W(e.spatialReference));let n=0;if(e.type==="polyline")for(let r of e.paths)for(let a=1;a<r.length;a++)n+=g(r[a],r[a-1],t);else if(e.type==="polygon")for(let r of e.rings){for(let a=1;a<r.length;a++)n+=g(r[a],r[a-1],t);(r[0][0]!==r[r.length-1][0]||r[0][1]!==r[r.length-1][1]||r[0][2]!==void 0&&r[0][2]!==r[r.length-1][2])&&(n+=g(r[0],r[r.length-1],t))}else e.type==="extent"&&(n+=2*g([e.xmin,e.ymin,0],[e.xmax,e.ymin,0],t),n+=2*g([e.xmin,e.ymin,0],[e.xmin,e.ymax,0],t),n*=2,n+=4*Math.abs(_(e.zmax,0)*t-_(e.zmin,0)*t));return n}var Be=(e,t,n)=>{if(n=D(n),A(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((O(n[0])||b(n[0]))&&(r=F(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof k))throw new Z(e,R.InvalidParameter,t);if(!(r instanceof C))throw new Z(e,R.InvalidParameter,t);if(!X(n[1]))throw new Z(e,R.InvalidParameter,t);let a=se(r,n[1]);return a?N.convertObjectToArcadeDictionary(a,E(e),!1,!0):null},Xe=(e,t,n)=>{if(n=D(n),A(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((O(n[0])||b(n[0]))&&(r=F(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof k))throw new Z(e,R.InvalidParameter,t);if(!(r instanceof C))throw new Z(e,R.InvalidParameter,t);let a=n[1];if(a===null)return null;if(!(a instanceof M))throw new Z(e,R.InvalidParameter,t);let i=oe(r,a);return i?N.convertObjectToArcadeDictionary(i,E(e),!1,!0):null},_e=(e,t,n)=>{if(n=D(n),A(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((O(n[0])||b(n[0]))&&(r=F(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof k))throw new Z(e,R.InvalidParameter,t);if(!(r instanceof C))throw new Z(e,R.InvalidParameter,t);if(!X(n[1]))throw new Z(e,R.InvalidParameter,t);let a=ie(r,n[1]);return a?N.convertObjectToArcadeDictionary(a,E(e),!1,!0):null};export{Ze as a,we as b,Ie as c,ze as d,Pe as e,je as f,Je as g,Be as h,Xe as i,_e as j};
