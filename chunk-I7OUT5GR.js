import{a as L,b as N,g as Q,h as W,i as X}from"./chunk-HWQBVARH.js";import{A as C,Ba as V,C as f,J as T,K as E,j as F,m as H,oa as v,ra as G,sa as w,ua as J,xa as K}from"./chunk-UNRRVLTB.js";import{a as q}from"./chunk-6DVIB4O4.js";import{a as B,b as R,u as j}from"./chunk-JLMESEWM.js";import{t as M}from"./chunk-47GHT6OF.js";var Y=J;function g(l,e){return{m_geometry:l,m_side:e}}function st(l,e,r,t,m,n){if(e.isEmpty()){let a=g(e,0);return void m.push(a)}if(r.isEmpty()){let a=g(e,0);return void m.push(a)}let s=[],o=new E;{let a=o.createGeometryUserIndex(),x=o.addGeometry(e),P=o.addGeometry(r),p=new V(n),d=0,c=null;if(o.hasCurves()){c=new Y;let h=o.getEnvelope2D(n);d=w(t.total());let _=G(t.total(),h);v(o,_,t.total(),12e3,c,null,n)}o.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(o,t),p.cut(l,a,x,P,s);for(let h of s){c!==null&&c.stitchCurves(o,h,d,!1);let _=g(o.getGeometry(h),K(o.getGeometryUserIndex(h,a)));m.push(_)}c!==null&&c.clearStitcher(o)}}function ot(l,e,r,t,m,n){if(e.isEmpty()){let a=g(e,0);return void m.push(a)}if(r.isEmpty()){let a=g(e,0);return void m.push(a)}let s=[],o=new E;{let a=o.createGeometryUserIndex(),x=o.addGeometry(e),P=o.addGeometry(r),p=new V(n),d=0,c=null;if(o.hasCurves()){c=new Y;let u=o.getEnvelope2D(n);d=w(t.total());let y=G(t.total(),u);v(o,y,t.total(),12e3,c,null,n)}o.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(o,t),p.cut(!1,a,x,P,s),c!==null&&c.stitchCurves(o,T,d,!0);let h=o.getGeometry(x),_=new f,k=new f,I=[];for(let u=0;u<s.length;u++){let y=null;{let i=new E,A=i.addGeometry(h),D=i.addGeometry(o.getGeometry(s[u]));if(i.hasCurves()){let U=i.getEnvelope2D(n);d=w(t.total());let et=G(t.total(),U);v(i,et,t.total(),12e3,c,null,n)}p.setEditShapeCrackAndCluster(i,t);let O=p.intersection(A,D);if(c!==null&&c.stitchCurves(i,T,d,!0),y=i.getGeometry(O),y.isEmpty())continue;let S=o.getGeometryUserIndex(s[u],a);S===2?_.add(y,!1):S===1?k.add(y,!1):I.push(y)}{let i=new E,A=i.addGeometry(h),D=i.addGeometry(o.getGeometry(s[u]));if(i.hasCurves()){let S=i.getEnvelope2D(n);d=w(t.total());let U=G(t.total(),S);v(i,U,t.total(),12e3,c,null,n)}p.setEditShapeCrackAndCluster(i,t);let O=p.difference(A,D);c!==null&&c.stitchCurves(i,T,d,!0),h=i.getGeometry(O)}}if(!h.isEmpty()&&s.length>0&&I.push(h),_.isEmpty()&&k.isEmpty())return;if(!_.isEmpty()){let u=g(_,1);m.push(u)}if(!k.isEmpty()){let u=g(k,2);m.push(u)}for(let u=0,y=I.length;u<y;++u){let i=g(I[u],3);m.push(i)}}}var b=class{getOperatorType(){return 10005}accelerateGeometry(e,r,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,r,t,m,n){return new z(e,r,t,m,n)}},z=class extends q{constructor(e,r,t,m,n){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=n,this.m_cuttee=r.clone(),this.m_cutter=new C({copy:t}),this.m_bConsiderTouch=e;let s=F(r,t);this.m_tolerance=H(m,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case R.enumPolyline:this.generatePolylineCuts();break;case R.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){let e=new C,r=new C,t=new C;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(r);let m=[];st(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let n=0;n<m.length;n++){let s=m[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?r.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}t.isEmpty()||e.isEmpty()&&r.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&r.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){let e=new f,r=new f,t=new f;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(r);let m=[];ot(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let n=0;n<m.length;n++){let s=m[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?r.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}B(t.isEmpty()||m.length===1),e.isEmpty()&&r.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}};var Z=new b;function $(l,e,r){let t=Z.execute(!0,l,e,r,null);return Array.from(t)}function tt(){return Z.supportsCurves()}function rt(l,e){let r=L(l);return $(N(l),Q(e),W(r)).map(t=>X(t,r)).filter(M)}var nt=tt(),gt=Object.freeze(Object.defineProperty({__proto__:null,execute:rt,supportsCurves:nt},Symbol.toStringTag,{value:"Module"}));export{rt as a,nt as b,gt as c};
