import{a as g,c as S}from"./chunk-AZS4Q4RE.js";import{F as h}from"./chunk-E57FTRWF.js";import{K as w,v as d}from"./chunk-U4J5SECU.js";import{x as p}from"./chunk-D2LVMNOU.js";import{t as u}from"./chunk-HHDFN2GK.js";import{a as b}from"./chunk-47GHT6OF.js";import{a as i,f as y}from"./chunk-VTHXE323.js";var c=new Map;function N(e,s){return y(this,null,function*(){try{return{data:(yield $(e,s)).data,baseUrl:w(e),styleUrl:e}}catch(r){return p(r),null}})}function R(e,s,r){let t=s.portal!=null?s.portal:S.getDefault(),n,a=`${t.url} - ${t.user?.username} - ${e}`,o=c.get(a);if(o)return o;let f=k(e,t,r).then(l=>(n=l,l.fetchData())).then(l=>({data:l,baseUrl:n.itemUrl??"",styleName:e}));return c.set(a,f),f}function k(e,s,r){return s.load(r).then(()=>{let t=new g({disableExtraQuery:!0,query:`owner:${U} AND type:${I} AND typekeywords:"${e}"`});return s.queryItems(t,r)}).then(({results:t})=>{let n=null,a=e.toLowerCase();if(t&&Array.isArray(t)){for(let o of t)if(o.typeKeywords?.some(l=>l.toLowerCase()===a)&&o.type===I&&o.owner===U){n=o;break}}if(!n)throw new u("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(r)})}function v(e,s,r){return e?.styleUrl!=null?N(e.styleUrl,r):e?.styleName!=null?R(e.styleName,s,r):Promise.reject(new u("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function F(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function L(e,s){for(let r of s)switch(r){case"cim":if(e.cimRef)return{format:r,url:encodeURI(e.cimRef)};break;case"web-gltf-basisu":{let t=m(e,"gltf_basisu");if(t)return{format:r,url:t};break}case"web-gltf":{let t=m(e,"gltf");if(t)return{format:r,url:t};break}case"web":{let t=m(e,"gltf");if(t)return{format:"web-gltf",url:t};if(e.webRef)return{format:r,url:encodeURI(e.webRef)};break}}}function m(e,s){if(!b("enable-feature:force-wosr"))return e.formatInfos?.find(r=>r.type===s)?.href}function $(e,s){let r=i({responseType:"json",query:{f:"json"}},s);return h(d(e),r)}var U="esri_en",I="Style",_="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{v as a,F as b,L as c,$ as d,_ as e};
