import{t as b}from"./chunk-HHDFN2GK.js";import"./chunk-47GHT6OF.js";import{a as c,b as p,f as d}from"./chunk-VTHXE323.js";function w(o,a){let t=a.responseType;t?t!=="array-buffer"&&t!=="blob"&&t!=="json"&&t!=="native"&&t!=="native-request-init"&&t!=="text"&&(t="text"):t="json",a.responseType=t;let f=a.signal;return delete a.signal,globalThis.invokeStaticMessage("request",{url:o,options:a},{signal:f}).then(e=>d(this,null,function*(){let n,s,l,u,r;if(e.data)if(e.data instanceof ArrayBuffer){if(!(t!=="json"&&t!=="text"&&t!=="blob"||(n=new Blob([e.data]),t!=="json"&&t!=="text"||(u=yield n.text(),t!=="json")))){try{s=JSON.parse(u||null)}catch(i){let h=p(c({},i),{url:o,requestOptions:a});throw new b("request:server",i.message,h)}if(s.error){let i=p(c({},s.error),{url:o,requestOptions:a});throw new b("request:server",s.error.message,i)}}}else t==="native"&&(e.data.signal=f,l=yield fetch(e.data.url,e.data),e.httpStatus=l.status);switch(t){case"blob":r=n;break;case"json":r=s;break;case"native":r=l;break;case"text":r=u;break;default:r=e.data}return{data:r,httpStatus:e.httpStatus,requestOptions:a,ssl:e.ssl,url:o}}))}export{w as execute};
