import{a as q,b as R,c as P,f as J,i as K,k as Q}from"./chunk-YYA5WIRF.js";import{g as Y,h as B}from"./chunk-IPGHBSHO.js";import{c as X}from"./chunk-XPXAET6Q.js";import{y as A}from"./chunk-JR22Z7I2.js";import{b as W}from"./chunk-YLZWDFCJ.js";import{d as U}from"./chunk-TLMADEUL.js";import{a as E}from"./chunk-J5MXC6AL.js";import{a as j}from"./chunk-MDSLION2.js";import{b as H}from"./chunk-HHDFN2GK.js";import{f as z}from"./chunk-VTHXE323.js";var F;function ae(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function N(e){return e?.type==="CIMVectorMarker"?e.markerGraphics?.[0]:void 0}function Z(e){return e?.symbol?.type==="CIMPolygonSymbol"?e.symbol.symbolLayers?.[0]:void 0}function le(e,n){e?.type==="CIMVectorMarker"&&n!=null&&(e.size=n)}function se(e,n){let r=N(e);r&&n!=null&&(r.geometry=ae(n))}function ce(e,n){let r=Z(N(e));r&&n!=null&&(r.color=n.toArray())}function ue(e,n,r){let i=Z(N(e));i&&n!=null&&r&&(i.colorLocked=n)}function _(e,n){let{outerRingSize:r,innerDotSize:i,type:t,color:o,colorLocked:a,primitiveOverrides:l}=n,u=e.data.symbol?.type==="CIMPolygonSymbol"?e.data.symbol.symbolLayers:null;if(u?.length===2)for(let c of u){let m=c.primitiveName===F.OuterRing;le(c,m?r:i),se(c,t),ce(c,o),ue(c,a,m)}return r!=null&&i!=null&&(e.data.primitiveOverrides=null),l!==void 0&&(e.data.primitiveOverrides=H(l)),e}(function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"})(F||(F={}));var ee=30,ne=12,T=24,re=[255,255,255],G=[200,200,200],w=[128,128,128],me=20,fe=5;function ye(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function pe(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function Se(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function be(e){return e.declaredClass==="esri.symbols.TextSymbol"}function ve(e,n){let r=e.length-1;return e.map((i,t)=>J(i,t,r,n))}function Ye(e,n,r,i,t,o,a){return z(this,null,function*(){let l=n.legendOptions,u=l?.customValues,c=a||(yield he(e,r)),m=n.stops,V=!!c,S=!!u,b=n.minSize!=null&&n.maxSize!=null,v=m&&m.length>1,d=!!n.target;if(!V||!S&&!(b||v&&!d))return;let f=B(c),y=!1,s=null,I=null;s=f&&!v?P([n.minDataValue,n.maxDataValue]):u??(yield we(n,c,i,t?.type));let M=e?.authoringInfo,$=M?.type==="univariate-color-size",k=$&&M?.univariateTheme==="above-and-below",C=!!Q(e);if(!s&&v&&(s=m.map(p=>p.value),y=m.some(p=>!!p.label),e.type==="flow"&&(s=P(s)),y&&(I=m.map(p=>p.label))),f&&s!=null&&s?.length>2&&!k&&(s=[s[0],s[s.length-1]]),!s)return null;$&&s?.length!==5&&(s=oe({minSize:s[0],maxSize:s[s.length-1]}));let L=f?ze(e,s):null,g=Y(c),h=y?null:ve(s,o);return(yield Promise.all(s.map((p,D)=>z(this,null,function*(){let O=f?L[D]:yield x(n,c,p,i,t?.type);return{value:p,symbol:!C||e.type!=="class-breaks"&&e.type!=="unique-value"?$e(k&&e.type==="class-breaks"?ge(e,D):c,O):de(e,O,n.maxSize,r)??c,label:y?I[D]:h[D],size:C?T:O,outlineSize:g}})))).reverse()})}function ze(e,n){let r=e?.authoringInfo,i=r?.type==="univariate-color-size",t=[ne,ee];if(i){let o=n[0],a=n[n.length-1],l=ne,u=ee;t=n.map(c=>l+(c-o)/(a-o)*(u-l))}return i&&r?.univariateTheme==="below"&&t.reverse(),t}function de(e,n,r,i){let t=e.type==="class-breaks",o=t?e.classBreakInfos?.[0]?.symbol?.clone():e.uniqueValueInfos?.[0]?.symbol?.clone();return o&&"type"in o&&o.type==="cim"?(_(o,{color:i??(t?null:new E(G)),innerDotSize:n*(T/r)||1,outerRingSize:T}),o):null}function ge(e,n){let r=e.classBreakInfos,i=r.length,t=i<2||!(n>=2)?r[0].symbol.clone():r[i-1].symbol.clone();return e.visualVariables?.some(a=>a.type==="color")&&(t.type.includes("3d")?te(t):ie(t)),t}function he(e,n){return z(this,null,function*(){if(e.type==="flow")return K(e,n);if(e.type==="pie-chart")return new W({color:null,outline:e.outline?.width?e.outline:new U});let r=null,i=null;if(e.type==="simple")r=e.symbol;else if(e.type==="class-breaks"){let t=e.classBreakInfos;r=t&&t[0]&&t[0].symbol,i=t.length>1}else if(e.type==="unique-value"){let t=e.uniqueValueInfos;r=t?.[0]?.symbol,i=t!=null&&t.length>1}return!r||xe(r)?null:(r=r.clone(),(n||i)&&(r.type.includes("3d")?te(r):ie(r)),r)})}function xe(e){return A(e)?e.symbolLayers?.some(n=>n?.type==="fill")??!1:e?.type.includes("fill")??!1}function te(e){e.type==="line-3d"?e.symbolLayers.forEach(n=>{n.material={color:w}}):e.symbolLayers.forEach(n=>{n.type!=="icon"||n.resource?.href?n.material={color:G}:(n.material={color:re},n.outline={color:w,size:1.5})})}function ie(e){let n=j();e.type==="cim"?X(e,new E(G)):e.type.includes("line")?e.color=w:(e.color=n?w:re,e.type==="simple-marker"&&(e.outline?e.outline?.color?.toHex()==="#ffffff"&&(e.outline.color=w):e.outline={color:w,width:1.5}))}function we(e,n,r,i){return z(this,null,function*(){let t=(yield import("./chunk-P2RJV47D.js")).getSizeRangeAtScale(e,r,i),o=t&&oe(t);if(!t||!o)return;let a=o.map(l=>Ie(l,e,t));a=P(a);for(let l=1;l<a.length-1;l++){let u=yield Me(e,n,a[l],a[l-1],r,i);u&&(a[l]=u[0],o[l]=u[1])}return a})}function oe(e){let n=e.minSize,r=e.maxSize,i=fe,t=(r-n)/(i-1),o=[];for(let a=0;a<i;a++)o.push(n+t*a);return o}function Ie(e,n,r){let i=r.minSize,t=r.maxSize,o=n.minDataValue,a=n.maxDataValue,l;return e<=i?l=o:e>=t?l=a:l=(e-i)/(t-i)*(a-o)+o,l}function Me(e,n,r,i,t,o){return z(this,null,function*(){let a=yield x(e,n,r,t,o),l=yield x(e,n,i,t,o),u=q(r),c=u.fractional,m=me,V=u.integer,S=null,b=null;r>0&&r<1&&(S=10**c,V=q(r*=S).integer);for(let v=V-1;v>=0;v--){let d=10**v,f=Math.floor(r/d)*d,y=Math.ceil(r/d)*d;S!=null&&(f/=S,y/=S);let s=(f+y)/2;[,s]=P([f,s,y],{indexes:[1]});let I=yield x(e,n,f,t,o),M=yield x(e,n,y,t,o),$=yield x(e,n,s,t,o),k=R(a,I,l,null),C=R(a,M,l,null),L=R(a,$,l,null),g=k.previous<=m,h=C.previous<=m;if(g&&h&&(k.previous<=C.previous?(g=!0,h=!1):(h=!0,g=!1)),g?b=[f,I]:h?b=[y,M]:L.previous<=m&&(b=[s,$]),b)break}return b})}function x(e,n,r,i,t){return z(this,null,function*(){let{getSize:o}=yield import("./chunk-P2RJV47D.js");return o(e,r,{scale:i,view:t,shape:n.type==="simple-marker"?n.style:null})})}function $e(e,n){let r=e.clone();if(A(r))B(r)||r.symbolLayers.forEach(i=>{i.type!=="fill"&&(i.size=n)});else if(ye(r))r.size=n;else if(pe(r)){let i=r.width,t=r.height;r.height=n,r.width=n*(i/t)}else Se(r)?r.width=n:be(r)&&r.font&&(r.font.size=n);return r}export{_ as a,ee as b,ne as c,Ye as d,de as e};
