import{b as w}from"./chunk-EKMHQEJY.js";import{e as E}from"./chunk-JKNCWG7E.js";import{J as x}from"./chunk-C7INQGWT.js";import{D as v,a as A,d as b,g as M,k as f,q as g,r as C,t as d,w as y,z as L}from"./chunk-D2LVMNOU.js";import{f as p}from"./chunk-VTHXE323.js";function H(r,s,n={}){return h(r,s,n,P)}function F(r,s,n={}){return h(r,s,n,k)}function h(r,s,n={},o){let e=null,i=n.once?(a,t)=>{o(a)&&(f(e),s(a,t))}:(a,t)=>{o(a)&&s(a,t)};if(e=x(r,i,n.sync,n.equals),n.initial){let a=r();i(a,a)}return e}function O(r,s,n,o={}){let e=null,i=null,a=null;function t(){e&&i&&(i.remove(),o.onListenerRemove?.(e),e=null,i=null)}function c(u){o.once&&o.once&&f(a),n(u)}let l=H(r,(u,m)=>{t(),g(u)&&(e=u,i=C(u,s,c),o.onListenerAdd?.(u))},{sync:o.sync,initial:!0});return a=A(()=>{l.remove(),t()}),a}function J(r,s){return T(r,k,s)}function T(r,s,n){if(y(n))return Promise.reject(d());let o=r();if(s?.(o))return Promise.resolve(o);let e=null;function i(){e=f(e)}return new Promise((a,t)=>{e=b([L(n,()=>{i(),t(d())}),h(r,c=>{i(),a(c)},{sync:!1,once:!0},s??P)])})}function P(r){return!0}function k(r){return!!r}function K(r,s,n={}){let o=!1,e=H(r,(i,a)=>{o||s(i,a)},n);return{remove(){e.remove()},pause(){o=!0},resume(){o=!1}}}function j(r,s){let n=new w,o=O(r,"after-splice",({added:e,start:i,deleteCount:a})=>{let t=n.splice(i,a);for(let c of t)c.remove();if(e?.length){let c=e.map(s);n.addMany(c,i)}},{sync:!0,onListenerRemove:()=>n.drain(e=>e.remove()),onListenerAdd:e=>n.addMany(e.items.map(s))});return n.addHandles(o),n}function N(r,s){let n=new w,o=j(r,t=>E(c=>p(this,null,function*(){let l=yield s(t,c);if(y(c))throw l.remove(),d();return l}))),e=()=>null,i=t=>p(this,null,function*(){let c=yield t.promise,l=o.indexOf(t);l<0||n.splice(l,1,c)});n.addMany(o.items.map(e));for(let t of o)v(i(t));let a=o.on("after-splice",({added:t,start:c,deleteCount:l})=>{let u=n.splice(c,l);for(let m of u)m?.remove();if(t?.length){n.addMany(t.map(e),c);for(let m of t)v(i(m))}});return n.addHandles([M(o),a]),n}var Q={sync:!0},S={initial:!0},V={sync:!0,initial:!0};export{H as a,F as b,O as c,J as d,K as e,N as f,Q as g,S as h,V as i};
