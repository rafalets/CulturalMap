import{a as b}from"./chunk-7X55A7Q6.js";import{a as A}from"./chunk-WAGBL553.js";import{a as O}from"./chunk-LB5YQINJ.js";import{L as S,d as p}from"./chunk-C7INQGWT.js";import{H as v}from"./chunk-WMHJC7XF.js";import{a as c}from"./chunk-QGVBCWUY.js";import{a as x}from"./chunk-47GHT6OF.js";var $;(function(o){o[o.Geographic=0]="Geographic",o[o.Arithmatic=1]="Arithmatic"})($||($={}));var k=3.14159265359/180,P=3.14159265359/128,M=180/3.141592654,F=1/8;var L=1,H=1.1,U=1,V=1/4,G=1/8;var _=24,E=8;var j=1e-5,N=.05;var B=1e-30;var W=4;var q=0,J=2,K=2,Q=3,X=0,Y=3,Z=16777216,tt=1.1,ot=16,et=128;var D;(function(o){o.Local="Local",o.Global="Global"})(D||(D={}));var s=class{generateSource(t){let a=[];for(let e=1;e<this.length;e++)a.push(`vec4 atom${e} = texture(${t.animationTexture}, (pointer + 0.5) / size);`),a.push("pointer.x += 1.0;");for(let e=0;e<this.ins;e++)a.push("top--;"),a.push(`vec4 in${this.ins-e-1} = stack[top];`);for(let e=0;e<this.outs;e++)a.push(`vec4 out${e};`);let{microcode:i}=this;for(let e of i)a.push(e);for(let e=0;e<this.outs;e++)a.push(`stack[top] = out${e};`),a.push("top++;"),a.push(`if (top >= ${T}) { top = ${T-1}; }`);return a}},n=128,u=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=1,this.ins=0,this.outs=0,this.microcode=["break;"]}encode(){return[[this.opcode,0,0,0]]}},f=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=1,this.ins=0,this.outs=1,this.microcode=["out0 = vec4(atom0.y, atom0.y, atom0.y, atom0.y);"]}encode(t){return[[this.opcode,t,0,0]]}},d=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=1,this.ins=0,this.outs=1,this.microcode=["out0 = vec4(atom0.yzw, 0.0);"]}encode(t){return[[this.opcode,t[0]||0,t[1]||0,t[2]||0]]}},g=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=2,this.ins=0,this.outs=1,this.microcode=["out0 = atom1;"]}encode(t){return[[this.opcode,0,0,0],t]}};function r(o){return[`float duration = clamp(${o.duration}, 0.05, 3600.0);`,`float startTimeOffset = ${o.startTimeOffset};`,`float repeatDelay = ${o.repeatDelay};`,`float timeOriginSelector = ${o.timeOriginSelector};`,`float repeatType = ${o.repeatType};`,`float easing = ${o.easing};`,`float playAnimation = ${o.playAnimation} * (1.0 - step(0.0, -${o.duration}));`,`float reverseAnimation = ${o.reverseAnimation};`,"float time = globalTime - (timeOriginSelector == 1.0 ? localTimeOrigin : 0.0);","time *= playAnimation;","time *= 1.0 - reverseAnimation * 2.0;","float period = duration + repeatDelay;","time += reverseAnimation == 1.0 ? (period - startTimeOffset - 0.001) : startTimeOffset + 0.001;","float omega = time / period;","float oi = floor(omega);","omega = repeatType == 1.0 || repeatType == 3.0 ? omega - oi : omega;","float of = omega * period;","of = (clamp(of, reverseAnimation * repeatDelay, period - (1.0 - reverseAnimation) * repeatDelay) - reverseAnimation * repeatDelay) / duration;","of = easing == 2.0 ? pow(of, 3.0) : of;","of = easing == 3.0 ? 1.0 - pow(1.0 - of, 3.0) : of;","of = easing == 4.0 ? of < 0.5 ? 4.0 * pow(of, 3.0) : 1.0 - pow(-2.0 * of + 2.0, 3.0) / 2.0 : of;","bool oscillate = repeatType == 3.0 && mod(oi, 2.0) == 1.0;",`${o.out} = oscillate ? 1.0 - of : of;`]}var C={Linear:1,EaseIn:2,EaseOut:3,EaseInOut:4},I={Loop:1,None:2,Oscillate:3},R={Local:1,Global:2};function l(o){let t=C[o.easing],a=I[o.repeatType],i=R[o.timeOriginSelector];return[[o.duration,o.startTimeOffset,o.repeatDelay,i],[a,t,o.playAnimation,o.reverseAnimation]]}var h=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=10,this.ins=1,this.outs=1,this.microcode=["vec2 fromTranslation = atom1.xy;","vec2 toTranslation = atom1.zw;","float fromRotation = atom2.x;","float toRotation = atom2.y;","float fromScale = atom2.z;","float toScale = atom2.w;","bool relativeTranslation = atom9.x == 1.0;","bool absoluteScale = atom9.y == 1.0;","vec2 translationMultiplier = relativeTranslation ? pixelDimensions : vec2(1.0, 1.0);","float scaleDivisor = absoluteScale ? pixelDimensions.y : 1.0;","float fTranslation;","{",...r({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",out:"fTranslation"}),"}","float fRotation;","{",...r({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fRotation"}),"}","float fScale;","{",...r({duration:"atom7.x",startTimeOffset:"atom7.y",repeatDelay:"atom7.z",timeOriginSelector:"atom7.w",repeatType:"atom8.x",easing:"atom8.y",playAnimation:"atom8.z",reverseAnimation:"atom8.w",out:"fScale"}),"}","vec2 aTranslation = mix(fromTranslation, toTranslation, fTranslation);","float aRotation = mix(fromRotation, toRotation, fRotation);","float aScale = mix(fromScale, toScale, fScale);","vec2 pTranslation = in0.xy;","float pRotation = in0.z;","float pScale = in0.w;","aTranslation *= translationMultiplier;","aScale /= scaleDivisor;","float rotation = pRotation + aRotation;","float scale = pScale * aScale;","float sin1 = sin(pRotation);","float cos1 = cos(pRotation);","float s1 = pScale;","float x1 = pTranslation.x;","float y1 = pTranslation.y;","float x2 = aTranslation.x;","float y2 = aTranslation.y;",`
    vec2 translation = vec2(
      cos1 * s1 * x2 - sin1 * s1 * y2 + x1,
      sin1 * s1 * x2 + cos1 * s1 * y2 + y1
    );
    `,"out0 = vec4(translation, rotation, scale);"]}encode(t){return[[this.opcode,0,0,0],[t.translation.from[0],t.translation.from[1],t.translation.to[0],t.translation.to[1]],[t.rotation.from,t.rotation.to,t.scale.from,t.scale.to],...l(t.translation.timing),...l(t.rotation.timing),...l(t.scale.timing),[t.relativeTranslation?1:0,t.absoluteScale?1:0,0,0]]}},y=class extends s{constructor(){super(...arguments),this.opcode=++n,this.length=7,this.ins=1,this.outs=1,this.microcode=["float fromOpacity = atom0.y;","float toOpacity = atom0.z;","vec4 fromColor = atom1;","vec4 toColor = atom2;","float fColor;","{",...r({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",out:"fColor"}),"}","float fOpacity;","{",...r({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fOpacity"}),"}","vec4 aColor = mix(fromColor, toColor, fColor);","aColor.a *= mix(fromOpacity, toOpacity, fOpacity);","vec4 pColor = in0;","out0 = aColor * pColor;"]}encode(t){return[[this.opcode,t.opacity.from,t.opacity.to,0],[t.color.from[0],t.color.from[1],t.color.from[2],t.color.from[3]],[t.color.to[0],t.color.to[1],t.color.to[2],t.color.to[3]],...l(t.color.timing),...l(t.opacity.timing)]}},w={scalar:new f,vector3:new d,vector4:new g,animatedTransform:new h,animatedColor:new y,ret:new u},z=40,T=4;function nt(o){let t=[];t.push(`float globalTime = ${o.globalTime};`),t.push(`float localTimeOrigin = ${o.localTimeOrigin};`),t.push(`vec2 pointer = ${o.animationPointer};`),t.push(`vec2 size = ${o.animationTextureSize};`),t.push("int top = 0;"),t.push(`vec4 stack[${T}];`),t.push(`for (int counter = 0; counter < ${z}; counter++) {`),t.push(`vec4 atom0 = texture(${o.animationTexture}, (pointer + 0.5) / size);`),t.push("pointer.x += 1.0;"),t.push(`vec2 pixelDimensions = ${o.pixelDimensions};`),t.push("if (false) {");for(let a in w){let i=w[a];t.push(`} else if (int(atom0.x) == ${i.opcode}) {`);for(let e of i.generateSource(o))t.push(e)}return t.push("} // End if-else."),t.push("} // End for."),t.push(`${o.out} = top > 0 ? stack[top - 1] : vec4(0.0);`),t.join(`
`)}var ct={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4,isStroke:5}};var pt={linear:0,rectangular:1,circular:2},ut={isAbsolute:0,isDiscrete:1};var dt={isAlongLine:0,isAbsoluteSize:1,isDiscrete:2};var m=class extends S{constructor(o){super(o),this.debugName="",this._updatingHandles=new b,this._idToUpdatingState=new A}get updating(){let o=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some(t=>t);if(x("esri-2d-log-updating")){let t=Array.from(this._idToUpdatingState.entries()).map(([a,i])=>`-> ${a}: ${i}`).join(`
`);console.log(`${this.debugName}: Updating: ${o}
-> Handles: ${this._updatingHandles.updating}
${t}`)}return o}addUpdateTracking(o,t){let a=O(()=>t.updating,i=>this._idToUpdatingState.set(o,i),{sync:!0});this.addHandles(a)}addPromise(o){return this._updatingHandles.addPromise(o)}};c([p({constructOnly:!0})],m.prototype,"debugName",void 0),c([p({readOnly:!0})],m.prototype,"updating",null),m=c([v("esri.views.2d.layers.support.UpdateTracking2D")],m);var Ct=o=>o&8388607;function It(o,t){return((t?8388608:0)|o)>>>0}export{ct as a,$ as b,k as c,P as d,L as e,H as f,U as g,_ as h,E as i,j,N as k,B as l,W as m,q as n,J as o,K as p,Q as q,X as r,Y as s,Z as t,tt as u,ot as v,et as w,pt as x,ut as y,Ct as z,It as A,dt as B,D as C,w as D,nt as E,m as F};
