import{a as T}from"./chunk-WBPLJNRU.js";import{c as St,e as et,f as rt,g as B,h as jt,i as zt,j as Mt}from"./chunk-E2J2V7JN.js";import{d as ut}from"./chunk-EXXSZWI5.js";import{a as m,c as xt}from"./chunk-2FO7ARYZ.js";import{a as Rt,b as p,c as vt,d as K,g as P,k as Y,m as Gt,n as $,o as Nt,p as At,s as V,y as tt}from"./chunk-QXXXCEV5.js";import{c as bt,d as H}from"./chunk-74LTYPBC.js";import{c as ht}from"./chunk-QPGCDGIN.js";import{f as Q}from"./chunk-LNVVFNTC.js";import{c as wt}from"./chunk-RSDQHAJX.js";import{a as C}from"./chunk-OGS2SUK5.js";import{c as Z,g as J,h as U,r as X}from"./chunk-IB2IUO7T.js";import{j as _}from"./chunk-I4M2OT5W.js";import{a as O,n as A}from"./chunk-NTVLK3P2.js";import{a as gt}from"./chunk-WMQNRNIU.js";import{a as mt}from"./chunk-HD52PWPC.js";import{a as ft}from"./chunk-EIPVFA6F.js";import{b as L,f as lt}from"./chunk-VOFKUGRY.js";import{F as D,ia as dt,p as W,r as yt}from"./chunk-IG66NQHW.js";import{b as pt}from"./chunk-EKMHQEJY.js";import{a as M}from"./chunk-ISSJ3A6Y.js";import{f as F}from"./chunk-7EG726PT.js";import{d as y}from"./chunk-C7INQGWT.js";import{H as z,f as h}from"./chunk-WMHJC7XF.js";import{a as u}from"./chunk-QGVBCWUY.js";import{f as I}from"./chunk-VTHXE323.js";var S=class extends C{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],S.prototype,"row",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],S.prototype,"column",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],S.prototype,"rows",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],S.prototype,"columns",void 0),S=u([z("esri.CameraLayout")],S);var ot=S;var w=class extends C.ClonableMixin(F){constructor(...t){super(...t),this.position=new A([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new ot}normalizeCtorArgs(t,e,r,o){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){let n={position:t};return e!=null&&(n.heading=e),r!=null&&(n.tilt=r),o!=null&&(n.fov=o),n}return t}writePosition(t,e,r,o){let n=t.clone();n.x=h(t.x||0),n.y=h(t.y||0),n.z=t.hasZ?h(t.z||0):t.z,e[r]=n.write({},o)}readPosition(t,e){let r=new A;return r.read(t,e),r.x=h(r.x||0),r.y=h(r.y||0),r.z=r.hasZ?h(r.z||0):r.z,r}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};u([y({type:A,json:{write:{isRequired:!0}}})],w.prototype,"position",void 0),u([ft("position")],w.prototype,"writePosition",null),u([mt("position")],w.prototype,"readPosition",null),u([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),M(t=>ut.normalize(h(t)))],w.prototype,"heading",void 0),u([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),M(t=>L(h(t),-180,180))],w.prototype,"tilt",void 0),u([y({type:Number,nonNullable:!0,json:{default:55,write:!0}}),M(t=>L(h(t,55),1,170))],w.prototype,"fov",void 0),u([y({type:ot,nonNullable:!0,json:{read:!1,write:!1}})],w.prototype,"layout",void 0),w=u([z("esri.Camera")],w);var Pt=w;var at,v=at=class extends F{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new at({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};u([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:nt}}}}})],v.prototype,"rotation",void 0),u([M("rotation")],v.prototype,"castRotation",null),u([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:nt}}}}})],v.prototype,"scale",void 0),u([y({types:ht,json:{read:Q,write:!0,origins:{"web-scene":{read:Q,write:{overridePolicy:nt}}}}})],v.prototype,"targetGeometry",void 0),u([y({type:Pt,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],v.prototype,"camera",void 0),v=at=u([z("esri.Viewpoint")],v);var E=v;function nt(){return{enabled:!this.camera}}var kt=96,qt=39.37,Dt=180/Math.PI;function Ct(t){return t.wkid?t:t.spatialReference||gt.WGS84}function it(t,e){return e.type?p(t,e.x,e.y):Rt(t,e)}function Ft(t){return dt(t)}function Vt(t,e,r=0){let o=t.width,n=t.height;if(r!==0){let s=lt(r),l=Math.abs(Math.cos(s)),c=Math.abs(Math.sin(s));o=t.width*l+t.height*c,n=t.width*c+t.height*l}let a=Math.max(1,e[0]),i=Math.max(1,e[1]);return Math.max(o/a,n/i)*Ut(t.spatialReference)}function k(t,e,r,o){return I(this,null,function*(){let n,a;if(!t||Array.isArray(t)&&!t.length)return null;if(pt.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){let s=t.every(g=>"attributes"in g),l=t.some(g=>!g.geometry),c=t;if(s&&l&&e&&e.allLayerViews){let g=new Map;for(let f of t){let d=f.layer,j=g.get(d)||[],R=f.attributes[d.objectIdField];R!=null&&j.push(R),g.set(d,j)}let x=[];g.forEach((f,d)=>{let j=e.allLayerViews?.find(R=>R.layer.id===d.id);if(j&&"queryFeatures"in j){let R=d.createQuery();R.objectIds=f,R.returnGeometry=!0,x.push(j.queryFeatures(R))}});let N=yield Promise.all(x),b=[];for(let f of N)if(f&&f.features&&f.features.length)for(let d of f.features)d.geometry!=null&&b.push(d.geometry);c=b}for(let g of c)o=yield k(g,e,r,o);return o}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new A(t);else if(t instanceof O)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){let s=t.layer,l=e.allLayerViews?.find(c=>c.layer.id===s.id);if(l&&"queryFeatures"in l){let c=s.createQuery();c.objectIds=[t.attributes[s.objectIdField]],c.returnGeometry=!0,n=(yield l.queryFeatures(c))?.features?.[0]?.geometry}}}if(n==null)return null;switch(n.type){case"point":a=new _({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":a=bt(n);break;default:a=n.extent}if(!a)return null;Z()||X(a.spatialReference,r)||(yield J());let i=U(a,r);if(!i)return null;if(o){let s=i.center,l=s.clone();l.x=H(s.x,o.center.x,r),l.x!==s.x&&i.centerAt(l),o=o.union(i)}else o=i;return o})}function Ot(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){let e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,r=0;for(let o of t){let n=o.layer;n?.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,r=n.maxScale>r?n.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function Tt(t,e){let r=Ct(t);return W(r,e)||r.imageCoordinateSystem||e.imageCoordinateSystem?t:U(t,e)}function tr(t,e){return I(this,null,function*(){if(!t||!e)return new E({targetGeometry:new A,scale:0,rotation:0});let r=e.spatialReference,{constraints:o,padding:n,viewpoint:a,size:i}=e,s=[n?i[0]-n.left-n.right:i[0],n?i[1]-n.top-n.bottom:i[1]],l=null;t instanceof E?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof _?c=t:t instanceof O?c=yield k(t,e,r):t&&(c=(yield k(t.center,e,r))||(yield k(t.target,e,r))||(yield k(t,e,r))),!c&&a?.targetGeometry?c=a.targetGeometry:!c&&e.extent&&(c=e.extent),r||(r=Ct(e.spatialReference||e.extent||c)),Z()||W(c.spatialReference,r)||X(c.spatialReference,r)||(yield J());let g=Tt(c,r),x="center"in g?g.center:g;e.pickClosestTarget!==!1&&x.type==="point"&&a.targetGeometry?.type==="point"&&(x.x=H(x.x,a.targetGeometry.x,x.spatialReference));let N=0;l?N=l.rotation:t.hasOwnProperty("rotation")?N=t.rotation:a&&(N=a.rotation);let b=0;b=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&o&&o.effectiveLODs?o.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?a.scale:Vt(Tt(c.extent,r),s,N);let f=Ot(t.target??t);f&&(f.min&&f.min<b?b=f.min:f.max&&f.max>b&&(b=f.max));let d=new E({targetGeometry:x,scale:b,rotation:N});return o&&(d=o.fit(d),o.constrainByGeometry(d),o.rotationEnabled||(d.rotation=a.rotation)),d})}function G(t,e){let r=t.targetGeometry,o=e.targetGeometry;return r.x=o.x,r.y=o.y,r.spatialReference=o.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function _t(t,e,r){return r?p(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):P(t,e,.5)}var er=function(){let t=m();return function(e,r,o){let n=r.targetGeometry;it(t,n);let a=.5*q(r);return e.xmin=t[0]-a*o[0],e.ymin=t[1]-a*o[1],e.xmax=t[0]+a*o[0],e.ymax=t[1]+a*o[1],e.spatialReference=n.spatialReference,e}}();function rr(t,e,r,o,n){return Kt(t,e,r.center),t.scale=Vt(r,o),n?.constraints?.constrain(t),t}function Qt(t,e,r,o){return It(t,e,r,o),St(t,t)}var Bt=function(){let t=m();return function(e,r,o){return tt(e,Xt(e,r),_t(t,r,o))}}(),Zt=function(){let t=T(),e=m();return function(r,o,n,a){let i=q(o),s=st(o);return p(e,i,i),zt(t,e),et(t,t,s),B(t,t,Bt(e,n,a)),B(t,t,[0,a.top-a.bottom]),p(r,t[4],t[5])}}();function q(t){return t.scale*Jt(t.targetGeometry?.spatialReference)}function Jt(t){return D(t)?1/(Ft(t)*qt*kt):1}function st(t){return wt(t.rotation)||0}function Ut(t){return D(t)?Ft(t)*qt*kt:1}function Xt(t,e){return P(t,e,.5)}var Et=function(){let t=m(),e=m(),r=m();return function(o,n,a,i,s,l){return Gt(t,n),P(e,a,.5*l),p(r,1/i*l,-1/i*l),Mt(o,e),s&&et(o,o,s),rt(o,o,r),B(o,o,t),o}}(),It=function(){let t=m();return function(e,r,o,n){let a=q(r),i=st(r);return it(t,r.targetGeometry),Et(e,t,o,a,i,n)}}(),or=function(){let t=m();return function(e,r,o,n){let a=q(r);return it(t,r.targetGeometry),Et(e,t,o,a,0,n)}}();function Ht(t){let e=yt(t);return e?e.valid[1]-e.valid[0]:0}function nr(t,e){return Math.round(Ht(t)/e)}var ar=function(){let t=m(),e=m(),r=[0,0,0];return function(o,n,a){K(t,o,n),$(t,t),K(e,o,a),$(e,e),At(r,t,e);let i=Math.acos(Nt(t,e)/(Y(t)*Y(e)))*Dt;return r[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),ir=function(){let t=m();return function(e,r,o,n){let a=e.targetGeometry;return G(e,r),Zt(t,r,o,n),a.x+=t[0],a.y+=t[1],e}}(),Kt=function(t,e,r){G(t,e);let o=t.targetGeometry;return o.x=r.x,o.y=r.y,o.spatialReference=r.spatialReference,t},sr=function(){let t=m();return function(e,r,o,n,a){a||(a="center"),tt(t,o,n),P(t,t,.5);let i=t[0],s=t[1];switch(a){case"center":p(t,0,0);break;case"left":p(t,-i,0);break;case"top":p(t,0,s);break;case"right":p(t,i,0);break;case"bottom":p(t,0,-s);break;case"top-left":p(t,-i,s);break;case"bottom-left":p(t,-i,-s);break;case"top-right":p(t,i,s);break;case"bottom-right":p(t,i,-s)}return ct(e,r,t),e}}();function cr(t,e,r){return G(t,e),t.rotation+=r,t}function lr(t,e,r){return G(t,e),t.rotation=r,t}var Yt=function(){let t=m();return function(e,r,o,n,a){return G(e,r),isNaN(o)||o===0||(Lt(t,n,r,a),e.scale=r.scale*o,Wt(t,t,e,a),ct(e,e,p(t,t[0]-n[0],n[1]-t[1]))),e}}();function ur(t,e,r){return G(t,e),t.scale=r,t}var $t=function(){let t=m();return function(e,r,o,n,a,i){return G(e,r),isNaN(o)||o===0||(Lt(t,a,r,i),e.scale=r.scale*o,e.rotation+=n,Wt(t,t,e,i),ct(e,e,p(t,t[0]-a[0],a[1]-t[1]))),e}}(),mr=function(){let t=m(),e=m();return function(r,o,n,a,i,s,l){return Bt(e,s,l),vt(t,i,e),a?$t(r,o,n,a,t,s):Yt(r,o,n,t,s)}}(),Lt=function(){let t=T();return function(e,r,o,n){return V(e,r,Qt(t,o,n,1))}}(),Wt=function(){let t=T();return function(e,r,o,n){return V(e,r,It(t,o,n,1))}}(),ct=function(){let t=m(),e=T();return function(r,o,n){G(r,o);let a=q(o),i=r.targetGeometry;return jt(e,st(o)),rt(e,e,xt(a,a)),V(t,n,e),i.x+=t[0],i.y+=t[1],r}}();export{E as a,Vt as b,tr as c,G as d,_t as e,er as f,rr as g,Bt as h,q as i,Jt as j,Et as k,It as l,or as m,Ht as n,nr as o,ar as p,ir as q,Kt as r,sr as s,cr as t,lr as u,ur as v,$t as w,mr as x,ct as y};
