var A=9999999e31,P=2e-7,T={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function M(t){return T[t]??[-34028234663852886e22,34028234663852886e22]}function V(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function E(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function v(t,e,s,i){let[a,u]=M(s),n=E(s);return n&&(a-=1e-5,u+=1e-5),n?s.startsWith("u")?I(t,e,i,[a,u]):L(t,e,i,[a,u]):S(t,e,i,[a,u])}function U(t,e){for(let s=0;s<e.length;s++)e[s]&&isNaN(t[s])&&(e[s]=0,t[s]=0)}function I(t,e,s,i){let[a,u]=i;for(let n=0;n<e.length;n++)if(e[n]){let o=t[n];o<a||o>u?e[n]=0:s[n]=o+.5|0}}function L(t,e,s,i){let[a,u]=i;for(let n=0;n<e.length;n++)if(e[n]){let o=t[n];o<a||o>u?e[n]=0:s[n]=o+(o>0?.5:-.5)|0}}function S(t,e,s,i){let[a,u]=i;for(let n=0;n<e.length;n++)if(e[n]){let o=t[n];o<a||o>u?e[n]=0:s[n]=o}}function w(t,e,s){if(t.depthCount&&t.depthCount>1)return;let{pixels:i,statistics:a,pixelType:u}=t,n=i[0].length,o=t.bandMasks??[],p=t.mask??new Uint8Array(n).fill(255),k=u==="f32"||u==="f64",d=M(u),b=!1;for(let l=0;l<i.length;l++){let f=typeof e=="number"?e:e[l];if(f==null)continue;let m=a?.[l]?.minValue??d[0],N=a?.[l]?.maxValue??d[1];if(m>f+Number.EPSILON||N<f-Number.EPSILON)continue;let h=o[l]||p.slice(),r=i[l],x=s?.customFloatTolerance;if(k&&x!==0){let c=x;c||(c=Math.abs(f)>=A?P*Math.abs(f):u==="f32"?2**-23:Number.EPSILON);for(let g=0;g<r.length;g++)h[g]&&Math.abs(r[g]-f)<c&&(r[g]=0,h[g]=0,p[g]=0,b=!0)}else for(let c=0;c<r.length;c++)h[c]&&r[c]===f&&(r[c]=0,h[c]=0,p[c]=0,b=!0);o[l]=h}if(b){let l=t.bandMasks||t.pixels.length>1?o:null;s?.matchAllNoData?t.mask=l&&l.length>1?y(l):p:(t.bandMasks=l,t.mask=p)}function y(l){if(l.length<2)return l[0];let f=l[0].length,m=new Uint8Array(f).fill(0);for(let N=0;N<l.length;N++){let h=l[N];for(let r=0;r<f;r++)h[r]&&(m[r]=255)}return m}b&&"updateStatistics"in t&&t.updateStatistics()}export{M as a,V as b,E as c,v as d,U as e,w as f};
